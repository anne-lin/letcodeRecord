/*!
 * Knockout JavaScript library v3.4.0
 * (c) Steven Sanderson - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */

/**
 * @license RequireJS text 2.0.14 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

function STANZA_ERROR(n,e,t){if(window==this)return new STANZA_ERROR(n,e,t);this.code=n,this.type=e,this.cond=t}function hex_sha1(n){return rstr2hex(rstr_sha1(str2rstr_utf8(n)))}function b64_sha1(n){return rstr2b64(rstr_sha1(str2rstr_utf8(n)))}function any_sha1(n,e){return rstr2any(rstr_sha1(str2rstr_utf8(n)),e)}function hex_hmac_sha1(n,e){return rstr2hex(rstr_hmac_sha1(str2rstr_utf8(n),str2rstr_utf8(e)))}function b64_hmac_sha1(n,e){return rstr2b64(rstr_hmac_sha1(str2rstr_utf8(n),str2rstr_utf8(e)))}function any_hmac_sha1(n,e,t){return rstr2any(rstr_hmac_sha1(str2rstr_utf8(n),str2rstr_utf8(e)),t)}function sha1_vm_test(){return"a9993e364706816aba3e25717850c26c9cd0d89d"==hex_sha1("abc").toLowerCase()}function rstr_sha1(n){return binb2rstr(binb_sha1(rstr2binb(n),8*n.length))}function rstr_hmac_sha1(n,e){var t=rstr2binb(n);t.length>16&&(t=binb_sha1(t,8*n.length));for(var i=Array(16),o=Array(16),a=0;a<16;a++)i[a]=909522486^t[a],o[a]=1549556828^t[a];var r=binb_sha1(i.concat(rstr2binb(e)),512+8*e.length);return binb2rstr(binb_sha1(o.concat(r),672))}function rstr2binb(n){for(var e=Array(n.length>>2),t=0;t<e.length;t++)e[t]=0;for(var t=0;t<8*n.length;t+=8)e[t>>5]|=(255&n.charCodeAt(t/8))<<24-t%32;return e}function binb2rstr(n){for(var e="",t=0;t<32*n.length;t+=8)e+=String.fromCharCode(n[t>>5]>>>24-t%32&255);return e}function binb_sha1(n,e){n[e>>5]|=128<<24-e%32,n[15+(e+64>>9<<4)]=e;for(var t=Array(80),i=1732584193,o=-271733879,a=-1732584194,r=271733878,s=-1009589776,c=0;c<n.length;c+=16){for(var u=i,d=o,p=a,l=r,g=s,h=0;h<80;h++){t[h]=h<16?n[c+h]:bit_rol(t[h-3]^t[h-8]^t[h-14]^t[h-16],1);var m=safe_add(safe_add(bit_rol(i,5),sha1_ft(h,o,a,r)),safe_add(safe_add(s,t[h]),sha1_kt(h)));s=r,r=a,a=bit_rol(o,30),o=i,i=m}i=safe_add(i,u),o=safe_add(o,d),a=safe_add(a,p),r=safe_add(r,l),s=safe_add(s,g)}return Array(i,o,a,r,s)}function sha1_ft(n,e,t,i){return n<20?e&t|~e&i:n<40?e^t^i:n<60?e&t|e&i|t&i:e^t^i}function sha1_kt(n){return n<20?1518500249:n<40?1859775393:n<60?-1894007588:-899497514}function hex_md5(n){return rstr2hex(rstr_md5(str2rstr_utf8(n)))}function b64_md5(n){return rstr2b64(rstr_md5(str2rstr_utf8(n)))}function any_md5(n,e){return rstr2any(rstr_md5(str2rstr_utf8(n)),e)}function hex_hmac_md5(n,e){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(e)))}function b64_hmac_md5(n,e){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(e)))}function any_hmac_md5(n,e,t){return rstr2any(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(e)),t)}function md5_vm_test(){return"900150983cd24fb0d6963f7d28e17f72"==hex_md5("abc").toLowerCase()}function rstr_md5(n){return binl2rstr(binl_md5(rstr2binl(n),8*n.length))}function rstr_hmac_md5(n,e){var t=rstr2binl(n);t.length>16&&(t=binl_md5(t,8*n.length));for(var i=Array(16),o=Array(16),a=0;a<16;a++)i[a]=909522486^t[a],o[a]=1549556828^t[a];var r=binl_md5(i.concat(rstr2binl(e)),512+8*e.length);return binl2rstr(binl_md5(o.concat(r),640))}function rstr2hex(n){for(var e,t=hexcase?"0123456789ABCDEF":"0123456789abcdef",i="",o=0;o<n.length;o++)e=n.charCodeAt(o),i+=t.charAt(e>>>4&15)+t.charAt(15&e);return i}function rstr2b64(n){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t="",i=n.length,o=0;o<i;o+=3)for(var a=n.charCodeAt(o)<<16|(o+1<i?n.charCodeAt(o+1)<<8:0)|(o+2<i?n.charCodeAt(o+2):0),r=0;r<4;r++)8*o+6*r>8*n.length?t+=b64pad:t+=e.charAt(a>>>6*(3-r)&63);return t}function rstr2any(n,e){var t,i,o,a,r,s=e.length,c=Array(Math.ceil(n.length/2));for(t=0;t<c.length;t++)c[t]=n.charCodeAt(2*t)<<8|n.charCodeAt(2*t+1);var u=Math.ceil(8*n.length/(Math.log(e.length)/Math.log(2))),d=Array(u);for(i=0;i<u;i++){for(r=Array(),a=0,t=0;t<c.length;t++)a=(a<<16)+c[t],o=Math.floor(a/s),a-=o*s,(r.length>0||o>0)&&(r[r.length]=o);d[i]=a,c=r}var p="";for(t=d.length-1;t>=0;t--)p+=e.charAt(d[t]);return p}function str2rstr_utf8(n){for(var e,t,i="",o=-1;++o<n.length;)e=n.charCodeAt(o),t=o+1<n.length?n.charCodeAt(o+1):0,55296<=e&&e<=56319&&56320<=t&&t<=57343&&(e=65536+((1023&e)<<10)+(1023&t),o++),e<=127?i+=String.fromCharCode(e):e<=2047?i+=String.fromCharCode(192|e>>>6&31,128|63&e):e<=65535?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):e<=2097151&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function str2rstr_utf16le(n){for(var e="",t=0;t<n.length;t++)e+=String.fromCharCode(255&n.charCodeAt(t),n.charCodeAt(t)>>>8&255);return e}function str2rstr_utf16be(n){for(var e="",t=0;t<n.length;t++)e+=String.fromCharCode(n.charCodeAt(t)>>>8&255,255&n.charCodeAt(t));return e}function rstr2binl(n){for(var e=Array(n.length>>2),t=0;t<e.length;t++)e[t]=0;for(var t=0;t<8*n.length;t+=8)e[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return e}function binl2rstr(n){for(var e="",t=0;t<32*n.length;t+=8)e+=String.fromCharCode(n[t>>5]>>>t%32&255);return e}function binl_md5(n,e){n[e>>5]|=128<<e%32,n[14+(e+64>>>9<<4)]=e;for(var t=1732584193,i=-271733879,o=-1732584194,a=271733878,r=0;r<n.length;r+=16){var s=t,c=i,u=o,d=a;t=md5_ff(t,i,o,a,n[r+0],7,-680876936),a=md5_ff(a,t,i,o,n[r+1],12,-389564586),o=md5_ff(o,a,t,i,n[r+2],17,606105819),i=md5_ff(i,o,a,t,n[r+3],22,-1044525330),t=md5_ff(t,i,o,a,n[r+4],7,-176418897),a=md5_ff(a,t,i,o,n[r+5],12,1200080426),o=md5_ff(o,a,t,i,n[r+6],17,-1473231341),i=md5_ff(i,o,a,t,n[r+7],22,-45705983),t=md5_ff(t,i,o,a,n[r+8],7,1770035416),a=md5_ff(a,t,i,o,n[r+9],12,-1958414417),o=md5_ff(o,a,t,i,n[r+10],17,-42063),i=md5_ff(i,o,a,t,n[r+11],22,-1990404162),t=md5_ff(t,i,o,a,n[r+12],7,1804603682),a=md5_ff(a,t,i,o,n[r+13],12,-40341101),o=md5_ff(o,a,t,i,n[r+14],17,-1502002290),i=md5_ff(i,o,a,t,n[r+15],22,1236535329),t=md5_gg(t,i,o,a,n[r+1],5,-165796510),a=md5_gg(a,t,i,o,n[r+6],9,-1069501632),o=md5_gg(o,a,t,i,n[r+11],14,643717713),i=md5_gg(i,o,a,t,n[r+0],20,-373897302),t=md5_gg(t,i,o,a,n[r+5],5,-701558691),a=md5_gg(a,t,i,o,n[r+10],9,38016083),o=md5_gg(o,a,t,i,n[r+15],14,-660478335),i=md5_gg(i,o,a,t,n[r+4],20,-405537848),t=md5_gg(t,i,o,a,n[r+9],5,568446438),a=md5_gg(a,t,i,o,n[r+14],9,-1019803690),o=md5_gg(o,a,t,i,n[r+3],14,-187363961),i=md5_gg(i,o,a,t,n[r+8],20,1163531501),t=md5_gg(t,i,o,a,n[r+13],5,-1444681467),a=md5_gg(a,t,i,o,n[r+2],9,-51403784),o=md5_gg(o,a,t,i,n[r+7],14,1735328473),i=md5_gg(i,o,a,t,n[r+12],20,-1926607734),t=md5_hh(t,i,o,a,n[r+5],4,-378558),a=md5_hh(a,t,i,o,n[r+8],11,-2022574463),o=md5_hh(o,a,t,i,n[r+11],16,1839030562),i=md5_hh(i,o,a,t,n[r+14],23,-35309556),t=md5_hh(t,i,o,a,n[r+1],4,-1530992060),a=md5_hh(a,t,i,o,n[r+4],11,1272893353),o=md5_hh(o,a,t,i,n[r+7],16,-155497632),i=md5_hh(i,o,a,t,n[r+10],23,-1094730640),t=md5_hh(t,i,o,a,n[r+13],4,681279174),a=md5_hh(a,t,i,o,n[r+0],11,-358537222),o=md5_hh(o,a,t,i,n[r+3],16,-722521979),i=md5_hh(i,o,a,t,n[r+6],23,76029189),t=md5_hh(t,i,o,a,n[r+9],4,-640364487),a=md5_hh(a,t,i,o,n[r+12],11,-421815835),o=md5_hh(o,a,t,i,n[r+15],16,530742520),i=md5_hh(i,o,a,t,n[r+2],23,-995338651),t=md5_ii(t,i,o,a,n[r+0],6,-198630844),a=md5_ii(a,t,i,o,n[r+7],10,1126891415),o=md5_ii(o,a,t,i,n[r+14],15,-1416354905),i=md5_ii(i,o,a,t,n[r+5],21,-57434055),t=md5_ii(t,i,o,a,n[r+12],6,1700485571),a=md5_ii(a,t,i,o,n[r+3],10,-1894986606),o=md5_ii(o,a,t,i,n[r+10],15,-1051523),i=md5_ii(i,o,a,t,n[r+1],21,-2054922799),t=md5_ii(t,i,o,a,n[r+8],6,1873313359),a=md5_ii(a,t,i,o,n[r+15],10,-30611744),o=md5_ii(o,a,t,i,n[r+6],15,-1560198380),i=md5_ii(i,o,a,t,n[r+13],21,1309151649),t=md5_ii(t,i,o,a,n[r+4],6,-145523070),a=md5_ii(a,t,i,o,n[r+11],10,-1120210379),o=md5_ii(o,a,t,i,n[r+2],15,718787259),i=md5_ii(i,o,a,t,n[r+9],21,-343485551),t=safe_add(t,s),i=safe_add(i,c),o=safe_add(o,u),a=safe_add(a,d)}return Array(t,i,o,a)}function md5_cmn(n,e,t,i,o,a){return safe_add(bit_rol(safe_add(safe_add(e,n),safe_add(i,a)),o),t)}function md5_ff(n,e,t,i,o,a,r){return md5_cmn(e&t|~e&i,n,e,o,a,r)}function md5_gg(n,e,t,i,o,a,r){return md5_cmn(e&i|t&~i,n,e,o,a,r)}function md5_hh(n,e,t,i,o,a,r){return md5_cmn(e^t^i,n,e,o,a,r)}function md5_ii(n,e,t,i,o,a,r){return md5_cmn(t^(e|~i),n,e,o,a,r)}function safe_add(n,e){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}function bit_rol(n,e){return n<<e|n>>>32-e}function utf8t2d(n){n=n.replace(/\r\n/g,"\n");var e=new Array;if(String.fromCharCode(237).charCodeAt(0)<0)for(var t=0;t<n.length;t++){var i=n.charCodeAt(t);i>0?e[e.length]=i:(e[e.length]=256+i>>6|192,e[e.length]=256+i&63|128)}else for(var t=0;t<n.length;t++){var i=n.charCodeAt(t);i<128?e[e.length]=i:i>127&&i<2048?(e[e.length]=i>>6|192,e[e.length]=63&i|128):(e[e.length]=i>>12|224,e[e.length]=i>>6&63|128,e[e.length]=63&i|128)}return e}function utf8d2t(n){for(var e=new Array,t=0;t<n.length;)n[t]<128?(e[e.length]=String.fromCharCode(n[t]),t++):n[t]>191&&n[t]<224?(e[e.length]=String.fromCharCode((31&n[t])<<6|63&n[t+1]),t+=2):(e[e.length]=String.fromCharCode((15&n[t])<<12|(63&n[t+1])<<6|63&n[t+2]),t+=3);return e.join("")}function b64arrays(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";b64=new Array,f64=new Array;for(var e=0;e<n.length;e++)b64[e]=n.charAt(e),f64[n.charAt(e)]=e}function b64d2t(n){var e=new Array,t=0,i=n.length;for(i%3==1&&(n[n.length]=0,n[n.length]=0),i%3==2&&(n[n.length]=0);t<n.length;)e[e.length]=b64[n[t]>>2],e[e.length]=b64[(3&n[t])<<4|n[t+1]>>4],e[e.length]=b64[(15&n[t+1])<<2|n[t+2]>>6],e[e.length]=b64[63&n[t+2]],t+=3;return i%3==1&&(e[e.length-1]=e[e.length-2]="="),i%3==2&&(e[e.length-1]="="),e.join("")}function b64t2d(n){var e=new Array,t=0;for(n=n.replace(/\n|\r/g,""),n=n.replace(/=/g,"");t<n.length;)e[e.length]=f64[n.charAt(t)]<<2|f64[n.charAt(t+1)]>>4,e[e.length]=(15&f64[n.charAt(t+1)])<<4|f64[n.charAt(t+2)]>>2,e[e.length]=(3&f64[n.charAt(t+2)])<<6|f64[n.charAt(t+3)],t+=4;return n.length%4==2&&(e=e.slice(0,e.length-2)),n.length%4==3&&(e=e.slice(0,e.length-1)),e}function XmlHttp(){}function XmlDocument(){}function JSJaCConnection(n){n&&n.httpbase&&(this._httpbase=n.httpbase),n&&n.oDbg&&n.oDbg.log?this.oDbg=n.oDbg:this.oDbg={log:function(){}},n&&n.timerval?this.setPollInterval(n.timerval):this.setPollInterval(JSJAC_TIMERVAL),n&&n.cookie_prefix?this._cookie_prefix=n.cookie_prefix:this._cookie_prefix="",this._connected=!1,this._events=[],this._keys=null,this._ID=0,this._inQ=[],this._pQueue=[],this._regIDs=[],this._req=[],this._status="intialized",this._errcnt=0,this._inactivity=JSJAC_INACTIVITY,this._sendRawCallbacks=[]}function JSJaCConsoleLogger(n){this.level=n||4,this.start=function(){},this.log=function(n,e){if(!((e=e||0)>this.level)&&"undefined"!=typeof console)try{switch(e){case 0:console.warn(n);break;case 1:console.error(n);break;case 2:console.info(n);break;case 4:console.debug(n);break;default:console.log(n)}}catch(e){try{console.log(n)}catch(n){}}},this.setLevel=function(n){return this.level=n,this},this.getLevel=function(){return this.level}}function JSJaCCookieException(n){this.message=n,this.name="CookieException"}function JSJaCCookie(n,e,t,i,o){if(window==this)return new JSJaCCookie(n,e,t,i,o);this.name=n,this.value=e,this.secs=t,this.domain=i,this.path=o,this.write=function(){var n;if(this.secs){var e=new Date;e.setTime(e.getTime()+1e3*this.secs),n="; expires="+e.toGMTString()}else n="";var t=this.domain?"; domain="+this.domain:"",i=this.path?"; path="+this.path:"; path=/";document.cookie=this.getName()+"="+JSJaCCookie._escape(this.getValue())+n+t+i},this.erase=function(){new JSJaCCookie(this.getName(),"",-1).write()},this.getName=function(){return this.name},this.setName=function(n){return this.name=n,this},this.getValue=function(){return this.value},this.setValue=function(n){return this.value=n,this},this.setDomain=function(n){return this.domain=n,this},this.setPath=function(n){return this.path=n,this}}function JSJaCDebugger(){}function JSJaCError(n,e,t){var i=XmlDocument.create("error","jsjac");return i.documentElement.setAttribute("code",n),i.documentElement.setAttribute("type",e),t&&i.documentElement.appendChild(i.createElement(t)).setAttribute("xmlns",NS_STANZAS),i.documentElement}function JSJaCHttpBindingConnection(n){this.base=JSJaCConnection,this.base(n),this._hold=JSJACHBC_MAX_HOLD,this._inactivity=0,this._last_requests={},this._last_rid=0,this._min_polling=0,this._pause=0,this._wait=n.wait||JSJACHBC_MAX_WAIT}function JSJaCHttpPollingConnection(n){this.base=JSJaCConnection,this.base(n),JSJACPACKET_USE_XMLNS=!1}function JSJaCJIDInvalidException(n){this.message=n,this.name="JSJaCJIDInvalidException"}function JSJaCJID(n){this._node="",this._domain="",this._resource="","string"==typeof n?(-1!=n.indexOf("@")&&(this.setNode(n.substring(0,n.indexOf("@"))),n=n.substring(n.indexOf("@")+1)),-1!=n.indexOf("/")&&(this.setResource(n.substring(n.indexOf("/")+1)),n=n.substring(0,n.indexOf("/"))),this.setDomain(n)):(this.setNode(n.node),this.setDomain(n.domain),this.setResource(n.resource))}function JSJaCJSON(){}function JSJaCKeys(n,e){var t=Math.random();if(this._k=[],this._k[0]=t.toString(),e?this.oDbg=e:(this.oDbg={},this.oDbg.log=function(){}),n)for(var i=1;i<JSJAC_NKEYS;i++)this._k[i]=n(this._k[i-1]),e.log(i+": "+this._k[i],4);this._indexAt=JSJAC_NKEYS-1,this.getKey=function(){return this._k[this._indexAt--]},this.lastKey=function(){return 0===this._indexAt},this.size=function(){return this._k.length},this._getSuspendVars=function(){return"_k,_indexAt".split(",")}}function JSJaCPacket(n){this.name=n,this.doc=void 0!==JSJACPACKET_USE_XMLNS&&JSJACPACKET_USE_XMLNS?XmlDocument.create(n,NS_CLIENT):XmlDocument.create(n,"")}function JSJaCPresence(){this.base=JSJaCPacket,this.base("presence")}function JSJaCIQ(){this.base=JSJaCPacket,this.base("iq")}function JSJaCMessage(){this.base=JSJaCPacket,this.base("message")}function JSJaCWebSocketConnection(n){this.base=JSJaCConnection,this.base(n),this._ws=null,this.registerHandler("onerror",JSJaC.bind(this._cleanupWebSocket,this))}define("jquery",[],function(){return window.jQuery}),function(){!function(n){var e=this||(0,eval)("this"),t=e.document,i=e.navigator,o=e.jQuery,a=e.JSON;!function(n){"function"==typeof define&&define.amd?define("knockout",["exports","require"],n):n("object"==typeof exports&&"object"==typeof module?module.exports||exports:e.ko={})}(function(r,s){function c(n,e){return(null===n||typeof n in f)&&n===e}function u(e,t){var i;return function(){i||(i=m.a.setTimeout(function(){i=n,e()},t))}}function d(n,e){var t;return function(){clearTimeout(t),t=m.a.setTimeout(n,e)}}function p(n,e){e&&e!==b?"beforeChange"===e?this.Kb(n):this.Ha(n,e):this.Lb(n)}function l(n,e){null!==e&&e.k&&e.k()}function g(n,e){var t=this.Hc,i=t[y];i.R||(this.lb&&this.Ma[e]?(t.Pb(e,n,this.Ma[e]),this.Ma[e]=null,--this.lb):i.r[e]||t.Pb(e,n,i.s?{ia:n}:t.uc(n)))}function h(n,e,t,i){m.d[n]={init:function(n,o,a,r,s){var c,u;return m.m(function(){var a=m.a.c(o()),r=!t!=!a,d=!u;(d||e||r!==c)&&(d&&m.va.Aa()&&(u=m.a.ua(m.f.childNodes(n),!0)),r?(d||m.f.da(n,m.a.ua(u)),m.eb(i?i(s,a):s,n)):m.f.xa(n),c=r)},null,{i:n}),{controlsDescendantBindings:!0}}},m.h.ta[n]=!1,m.f.Z[n]=!0}var m=void 0!==r?r:{};m.b=function(n,e){for(var t=n.split("."),i=m,o=0;o<t.length-1;o++)i=i[t[o]];i[t[t.length-1]]=e},m.G=function(n,e,t){n[e]=t},m.version="3.4.0",m.b("version",m.version),m.options={deferUpdates:!1,useOnlyNativeEvents:!1},m.a=function(){function r(n,e){for(var t in n)n.hasOwnProperty(t)&&e(t,n[t])}function s(n,e){if(e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function c(n,e){return n.__proto__=e,n}function u(n,e,t,i){var o=n[e].match(b)||[];m.a.q(t.match(b),function(n){m.a.pa(o,n,i)}),n[e]=o.join(" ")}var d={__proto__:[]}instanceof Array,p="function"==typeof Symbol,l={},g={};l[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],l.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),r(l,function(n,e){if(e.length)for(var t=0,i=e.length;t<i;t++)g[e[t]]=n});var h={propertychange:!0},f=t&&function(){for(var e=3,i=t.createElement("div"),o=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e",o[0];);return 4<e?e:n}(),b=/\S+/g;return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(n,e){for(var t=0,i=n.length;t<i;t++)e(n[t],t)},o:function(n,e){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(n,e);for(var t=0,i=n.length;t<i;t++)if(n[t]===e)return t;return-1},Sb:function(n,e,t){for(var i=0,o=n.length;i<o;i++)if(e.call(t,n[i],i))return n[i];return null},La:function(n,e){var t=m.a.o(n,e);0<t?n.splice(t,1):0===t&&n.shift()},Tb:function(n){n=n||[];for(var e=[],t=0,i=n.length;t<i;t++)0>m.a.o(e,n[t])&&e.push(n[t]);return e},fb:function(n,e){n=n||[];for(var t=[],i=0,o=n.length;i<o;i++)t.push(e(n[i],i));return t},Ka:function(n,e){n=n||[];for(var t=[],i=0,o=n.length;i<o;i++)e(n[i],i)&&t.push(n[i]);return t},ra:function(n,e){if(e instanceof Array)n.push.apply(n,e);else for(var t=0,i=e.length;t<i;t++)n.push(e[t]);return n},pa:function(n,e,t){var i=m.a.o(m.a.zb(n),e);0>i?t&&n.push(e):t||n.splice(i,1)},ka:d,extend:s,Xa:c,Ya:d?c:s,D:r,Ca:function(n,e){if(!n)return n;var t,i={};for(t in n)n.hasOwnProperty(t)&&(i[t]=e(n[t],t,n));return i},ob:function(n){for(;n.firstChild;)m.removeNode(n.firstChild)},jc:function(n){n=m.a.V(n);for(var e=(n[0]&&n[0].ownerDocument||t).createElement("div"),i=0,o=n.length;i<o;i++)e.appendChild(m.$(n[i]));return e},ua:function(n,e){for(var t=0,i=n.length,o=[];t<i;t++){var a=n[t].cloneNode(!0);o.push(e?m.$(a):a)}return o},da:function(n,e){if(m.a.ob(n),e)for(var t=0,i=e.length;t<i;t++)n.appendChild(e[t])},qc:function(n,e){var t=n.nodeType?[n]:n;if(0<t.length){for(var i=t[0],o=i.parentNode,a=0,r=e.length;a<r;a++)o.insertBefore(e[a],i);for(a=0,r=t.length;a<r;a++)m.removeNode(t[a])}},za:function(n,e){if(n.length){for(e=8===e.nodeType&&e.parentNode||e;n.length&&n[0].parentNode!==e;)n.splice(0,1);for(;1<n.length&&n[n.length-1].parentNode!==e;)n.length--;if(1<n.length){var t=n[0],i=n[n.length-1];for(n.length=0;t!==i;)n.push(t),t=t.nextSibling;n.push(i)}}return n},sc:function(n,e){7>f?n.setAttribute("selected",e):n.selected=e},$a:function(e){return null===e||e===n?"":e.trim?e.trim():e.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(n,e){return n=n||"",!(e.length>n.length)&&n.substring(0,e.length)===e},Mc:function(n,e){if(n===e)return!0;if(11===n.nodeType)return!1;if(e.contains)return e.contains(3===n.nodeType?n.parentNode:n);if(e.compareDocumentPosition)return 16==(16&e.compareDocumentPosition(n));for(;n&&n!=e;)n=n.parentNode;return!!n},nb:function(n){return m.a.Mc(n,n.ownerDocument.documentElement)},Qb:function(n){return!!m.a.Sb(n,m.a.nb)},A:function(n){return n&&n.tagName&&n.tagName.toLowerCase()},Wb:function(n){return m.onError?function(){try{return n.apply(this,arguments)}catch(n){throw m.onError&&m.onError(n),n}}:n},setTimeout:function(n,e){return setTimeout(m.a.Wb(n),e)},$b:function(n){setTimeout(function(){throw m.onError&&m.onError(n),n},0)},p:function(n,e,t){var i=m.a.Wb(t);if(t=f&&h[e],m.options.useOnlyNativeEvents||t||!o)if(t||"function"!=typeof n.addEventListener){if(void 0===n.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var a=function(e){i.call(n,e)},r="on"+e;n.attachEvent(r,a),m.a.F.oa(n,function(){n.detachEvent(r,a)})}else n.addEventListener(e,i,!1);else o(n).bind(e,i)},Da:function(n,i){if(!n||!n.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var a;if("input"===m.a.A(n)&&n.type&&"click"==i.toLowerCase()?(a=n.type,a="checkbox"==a||"radio"==a):a=!1,m.options.useOnlyNativeEvents||!o||a)if("function"==typeof t.createEvent){if("function"!=typeof n.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");a=t.createEvent(g[i]||"HTMLEvents"),a.initEvent(i,!0,!0,e,0,0,0,0,0,!1,!1,!1,!1,0,n),n.dispatchEvent(a)}else if(a&&n.click)n.click();else{if(void 0===n.fireEvent)throw Error("Browser doesn't support triggering events");n.fireEvent("on"+i)}else o(n).trigger(i)},c:function(n){return m.H(n)?n():n},zb:function(n){return m.H(n)?n.t():n},bb:function(n,e,t){var i;e&&("object"==typeof n.classList?(i=n.classList[t?"add":"remove"],m.a.q(e.match(b),function(e){i.call(n.classList,e)})):"string"==typeof n.className.baseVal?u(n.className,"baseVal",e,t):u(n,"className",e,t))},Za:function(e,t){var i=m.a.c(t);null!==i&&i!==n||(i="");var o=m.f.firstChild(e);!o||3!=o.nodeType||m.f.nextSibling(o)?m.f.da(e,[e.ownerDocument.createTextNode(i)]):o.data=i,m.a.Rc(e)},rc:function(n,e){if(n.name=e,7>=f)try{n.mergeAttributes(t.createElement("<input name='"+n.name+"'/>"),!1)}catch(n){}},Rc:function(n){9<=f&&(n=1==n.nodeType?n:n.parentNode,n.style&&(n.style.zoom=n.style.zoom))},Nc:function(n){if(f){var e=n.style.width;n.style.width=0,n.style.width=e}},hd:function(n,e){n=m.a.c(n),e=m.a.c(e);for(var t=[],i=n;i<=e;i++)t.push(i);return t},V:function(n){for(var e=[],t=0,i=n.length;t<i;t++)e.push(n[t]);return e},Yb:function(n){return p?Symbol(n):n},rd:6===f,sd:7===f,C:f,ec:function(n,e){for(var t=m.a.V(n.getElementsByTagName("input")).concat(m.a.V(n.getElementsByTagName("textarea"))),i="string"==typeof e?function(n){return n.name===e}:function(n){return e.test(n.name)},o=[],a=t.length-1;0<=a;a--)i(t[a])&&o.push(t[a]);return o},ed:function(n){return"string"==typeof n&&(n=m.a.$a(n))?a&&a.parse?a.parse(n):new Function("return "+n)():null},Eb:function(n,e,t){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(m.a.c(n),e,t)},fd:function(n,e,i){i=i||{};var o=i.params||{},a=i.includeFields||this.cc,s=n;if("object"==typeof n&&"form"===m.a.A(n))for(var s=n.action,c=a.length-1;0<=c;c--)for(var u=m.a.ec(n,a[c]),d=u.length-1;0<=d;d--)o[u[d].name]=u[d].value;e=m.a.c(e);var p=t.createElement("form");p.style.display="none",p.action=s,p.method="post";for(var l in e)n=t.createElement("input"),n.type="hidden",n.name=l,n.value=m.a.Eb(m.a.c(e[l])),p.appendChild(n);r(o,function(n,e){var i=t.createElement("input");i.type="hidden",i.name=n,i.value=e,p.appendChild(i)}),t.body.appendChild(p),i.submitter?i.submitter(p):p.submit(),setTimeout(function(){p.parentNode.removeChild(p)},0)}}}(),m.b("utils",m.a),m.b("utils.arrayForEach",m.a.q),m.b("utils.arrayFirst",m.a.Sb),m.b("utils.arrayFilter",m.a.Ka),m.b("utils.arrayGetDistinctValues",m.a.Tb),m.b("utils.arrayIndexOf",m.a.o),m.b("utils.arrayMap",m.a.fb),m.b("utils.arrayPushAll",m.a.ra),m.b("utils.arrayRemoveItem",m.a.La),m.b("utils.extend",m.a.extend),m.b("utils.fieldsIncludedWithJsonPost",m.a.cc),m.b("utils.getFormFields",m.a.ec),m.b("utils.peekObservable",m.a.zb),m.b("utils.postJson",m.a.fd),m.b("utils.parseJson",m.a.ed),m.b("utils.registerEventHandler",m.a.p),m.b("utils.stringifyJson",m.a.Eb),m.b("utils.range",m.a.hd),m.b("utils.toggleDomNodeCssClass",m.a.bb),m.b("utils.triggerEvent",m.a.Da),m.b("utils.unwrapObservable",m.a.c),m.b("utils.objectForEach",m.a.D),m.b("utils.addOrRemoveItem",m.a.pa),m.b("utils.setTextContent",m.a.Za),m.b("unwrap",m.a.c),Function.prototype.bind||(Function.prototype.bind=function(n){var e=this;if(1===arguments.length)return function(){return e.apply(n,arguments)};var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice(0);return i.push.apply(i,arguments),e.apply(n,i)}}),m.a.e=new function(){function e(e,a){var r=e[i];if(!r||"null"===r||!o[r]){if(!a)return n;r=e[i]="ko"+t++,o[r]={}}return o[r]}var t=0,i="__ko__"+(new Date).getTime(),o={};return{get:function(t,i){var o=e(t,!1);return o===n?n:o[i]},set:function(t,i,o){o===n&&e(t,!1)===n||(e(t,!0)[i]=o)},clear:function(n){var e=n[i];return!!e&&(delete o[e],n[i]=null,!0)},I:function(){return t+++i}}},m.b("utils.domData",m.a.e),m.b("utils.domData.clear",m.a.e.clear),m.a.F=new function(){function e(e,t){var o=m.a.e.get(e,i);return o===n&&t&&(o=[],m.a.e.set(e,i,o)),o}function t(n){var i=e(n,!1);if(i)for(var i=i.slice(0),o=0;o<i.length;o++)i[o](n);if(m.a.e.clear(n),m.a.F.cleanExternalData(n),r[n.nodeType])for(i=n.firstChild;n=i;)i=n.nextSibling,8===n.nodeType&&t(n)}var i=m.a.e.I(),a={1:!0,8:!0,9:!0},r={1:!0,9:!0};return{oa:function(n,t){if("function"!=typeof t)throw Error("Callback must be a function");e(n,!0).push(t)},pc:function(t,o){var a=e(t,!1);a&&(m.a.La(a,o),0==a.length&&m.a.e.set(t,i,n))},$:function(n){if(a[n.nodeType]&&(t(n),r[n.nodeType])){var e=[];m.a.ra(e,n.getElementsByTagName("*"));for(var i=0,o=e.length;i<o;i++)t(e[i])}return n},removeNode:function(n){m.$(n),n.parentNode&&n.parentNode.removeChild(n)},cleanExternalData:function(n){o&&"function"==typeof o.cleanData&&o.cleanData([n])}}},m.$=m.a.F.$,m.removeNode=m.a.F.removeNode,m.b("cleanNode",m.$),m.b("removeNode",m.removeNode),m.b("utils.domNodeDisposal",m.a.F),m.b("utils.domNodeDisposal.addDisposeCallback",m.a.F.oa),m.b("utils.domNodeDisposal.removeDisposeCallback",m.a.F.pc),function(){var i=[0,"",""],a=[1,"<table>","</table>"],r=[3,"<table><tbody><tr>","</tr></tbody></table>"],s=[1,"<select multiple='multiple'>","</select>"],c={thead:a,tbody:a,tfoot:a,tr:[2,"<table><tbody>","</tbody></table>"],td:r,th:r,option:s,optgroup:s},u=8>=m.a.C;m.a.ma=function(n,a){var r;if(o){if(o.parseHTML)r=o.parseHTML(n,a)||[];else if((r=o.clean([n],a))&&r[0]){for(var s=r[0];s.parentNode&&11!==s.parentNode.nodeType;)s=s.parentNode;s.parentNode&&s.parentNode.removeChild(s)}}else{(r=a)||(r=t);var d,s=r.parentWindow||r.defaultView||e,p=m.a.$a(n).toLowerCase(),l=r.createElement("div");for(d=(p=p.match(/^<([a-z]+)[ >]/))&&c[p[1]]||i,p=d[0],d="ignored<div>"+d[1]+n+d[2]+"</div>","function"==typeof s.innerShiv?l.appendChild(s.innerShiv(d)):(u&&r.appendChild(l),l.innerHTML=d,u&&l.parentNode.removeChild(l));p--;)l=l.lastChild;r=m.a.V(l.lastChild.childNodes)}return r},m.a.Cb=function(e,t){if(m.a.ob(e),null!==(t=m.a.c(t))&&t!==n)if("string"!=typeof t&&(t=t.toString()),o)o(e).html(t);else for(var i=m.a.ma(t,e.ownerDocument),a=0;a<i.length;a++)e.appendChild(i[a])}}(),m.b("utils.parseHtmlFragment",m.a.ma),m.b("utils.setHtml",m.a.Cb),m.M=function(){function e(n,t){if(n)if(8==n.nodeType){var i=m.M.lc(n.nodeValue);null!=i&&t.push({Lc:n,cd:i})}else if(1==n.nodeType)for(var i=0,o=n.childNodes,a=o.length;i<a;i++)e(o[i],t)}var t={};return{wb:function(n){if("function"!=typeof n)throw Error("You can only pass a function to ko.memoization.memoize()");var e=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[e]=n,"\x3c!--[ko_memo:"+e+"]--\x3e"},xc:function(e,i){var o=t[e];if(o===n)throw Error("Couldn't find any memo with ID "+e+". Perhaps it's already been unmemoized.");try{return o.apply(null,i||[]),!0}finally{delete t[e]}},yc:function(n,t){var i=[];e(n,i);for(var o=0,a=i.length;o<a;o++){var r=i[o].Lc,s=[r];t&&m.a.ra(s,t),m.M.xc(i[o].cd,s),r.nodeValue="",r.parentNode&&r.parentNode.removeChild(r)}},lc:function(n){return(n=n.match(/^\[ko_memo\:(.*?)\]$/))?n[1]:null}}}(),m.b("memoization",m.M),m.b("memoization.memoize",m.M.wb),m.b("memoization.unmemoize",m.M.xc),m.b("memoization.parseMemoText",m.M.lc),m.b("memoization.unmemoizeDomNodeAndDescendants",m.M.yc),m.Y=function(){function n(){if(a)for(var n,e=a,t=0;s<a;)if(n=o[s++]){if(s>e){if(5e3<=++t){s=a,m.a.$b(Error("'Too much recursion' after processing "+t+" task groups."));break}e=a}try{n()}catch(n){m.a.$b(n)}}}function i(){n(),s=a=o.length=0}var o=[],a=0,r=1,s=0;return{scheduler:e.MutationObserver?function(n){var e=t.createElement("div");return new MutationObserver(n).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}}(i):t&&"onreadystatechange"in t.createElement("script")?function(n){var e=t.createElement("script");e.onreadystatechange=function(){e.onreadystatechange=null,t.documentElement.removeChild(e),e=null,n()},t.documentElement.appendChild(e)}:function(n){setTimeout(n,0)},Wa:function(n){return a||m.Y.scheduler(i),o[a++]=n,r++},cancel:function(n){(n-=r-a)>=s&&n<a&&(o[n]=null)},resetForTesting:function(){var n=a-s;return s=a=o.length=0,n},md:n}}(),m.b("tasks",m.Y),m.b("tasks.schedule",m.Y.Wa),m.b("tasks.runEarly",m.Y.md),m.ya={throttle:function(n,e){n.throttleEvaluation=e;var t=null;return m.B({read:n,write:function(i){clearTimeout(t),t=m.a.setTimeout(function(){n(i)},e)}})},rateLimit:function(n,e){var t,i,o;"number"==typeof e?t=e:(t=e.timeout,i=e.method),n.cb=!1,o="notifyWhenChangesStop"==i?d:u,n.Ta(function(n){return o(n,t)})},deferred:function(e,t){if(!0!==t)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");e.cb||(e.cb=!0,e.Ta(function(t){var i;return function(){m.Y.cancel(i),i=m.Y.Wa(t),e.notifySubscribers(n,"dirty")}}))},notify:function(n,e){n.equalityComparer="always"==e?null:c}};var f={undefined:1,boolean:1,number:1,string:1};m.b("extenders",m.ya),m.vc=function(n,e,t){this.ia=n,this.gb=e,this.Kc=t,this.R=!1,m.G(this,"dispose",this.k)},m.vc.prototype.k=function(){this.R=!0,this.Kc()},m.J=function(){m.a.Ya(this,x),x.rb(this)};var b="change",x={rb:function(n){n.K={},n.Nb=1},X:function(n,e,t){var i=this;t=t||b;var o=new m.vc(i,e?n.bind(e):n,function(){m.a.La(i.K[t],o),i.Ia&&i.Ia(t)});return i.sa&&i.sa(t),i.K[t]||(i.K[t]=[]),i.K[t].push(o),o},notifySubscribers:function(n,e){if(e=e||b,e===b&&this.zc(),this.Pa(e))try{m.l.Ub();for(var t,i=this.K[e].slice(0),o=0;t=i[o];++o)t.R||t.gb(n)}finally{m.l.end()}},Na:function(){return this.Nb},Uc:function(n){return this.Na()!==n},zc:function(){++this.Nb},Ta:function(n){var e,t,i,o=this,a=m.H(o);o.Ha||(o.Ha=o.notifySubscribers,o.notifySubscribers=p);var r=n(function(){o.Mb=!1,a&&i===o&&(i=o()),e=!1,o.tb(t,i)&&o.Ha(t=i)});o.Lb=function(n){o.Mb=e=!0,i=n,r()},o.Kb=function(n){e||(t=n,o.Ha(n,"beforeChange"))}},Pa:function(n){return this.K[n]&&this.K[n].length},Sc:function(n){if(n)return this.K[n]&&this.K[n].length||0;var e=0;return m.a.D(this.K,function(n,t){"dirty"!==n&&(e+=t.length)}),e},tb:function(n,e){return!this.equalityComparer||!this.equalityComparer(n,e)},extend:function(n){var e=this;return n&&m.a.D(n,function(n,t){var i=m.ya[n];"function"==typeof i&&(e=i(e,t)||e)}),e}};m.G(x,"subscribe",x.X),m.G(x,"extend",x.extend),m.G(x,"getSubscriptionsCount",x.Sc),m.a.ka&&m.a.Xa(x,Function.prototype),m.J.fn=x,m.hc=function(n){return null!=n&&"function"==typeof n.X&&"function"==typeof n.notifySubscribers},m.b("subscribable",m.J),m.b("isSubscribable",m.hc),m.va=m.l=function(){function n(n){i.push(t),t=n}function e(){t=i.pop()}var t,i=[],o=0;return{Ub:n,end:e,oc:function(n){if(t){if(!m.hc(n))throw Error("Only subscribable things can act as dependencies");t.gb.call(t.Gc,n,n.Cc||(n.Cc=++o))}},w:function(t,i,o){try{return n(),t.apply(i,o||[])}finally{e()}},Aa:function(){if(t)return t.m.Aa()},Sa:function(){if(t)return t.Sa}}}(),m.b("computedContext",m.va),m.b("computedContext.getDependenciesCount",m.va.Aa),m.b("computedContext.isInitial",m.va.Sa),m.b("ignoreDependencies",m.qd=m.l.w);var v=m.a.Yb("_latestValue");m.N=function(n){function e(){return 0<arguments.length?(e.tb(e[v],arguments[0])&&(e.ga(),e[v]=arguments[0],e.fa()),this):(m.l.oc(e),e[v])}return e[v]=n,m.a.ka||m.a.extend(e,m.J.fn),m.J.fn.rb(e),m.a.Ya(e,w),m.options.deferUpdates&&m.ya.deferred(e,!0),e};var w={equalityComparer:c,t:function(){return this[v]},fa:function(){this.notifySubscribers(this[v])},ga:function(){this.notifySubscribers(this[v],"beforeChange")}};m.a.ka&&m.a.Xa(w,m.J.fn);var k=m.N.gd="__ko_proto__";w[k]=m.N,m.Oa=function(e,t){return null!==e&&e!==n&&e[k]!==n&&(e[k]===t||m.Oa(e[k],t))},m.H=function(n){return m.Oa(n,m.N)},m.Ba=function(n){return!!("function"==typeof n&&n[k]===m.N||"function"==typeof n&&n[k]===m.B&&n.Vc)},m.b("observable",m.N),m.b("isObservable",m.H),m.b("isWriteableObservable",m.Ba),m.b("isWritableObservable",m.Ba),m.b("observable.fn",w),m.G(w,"peek",w.t),m.G(w,"valueHasMutated",w.fa),m.G(w,"valueWillMutate",w.ga),m.la=function(n){if("object"!=typeof(n=n||[])||!("length"in n))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return n=m.N(n),m.a.Ya(n,m.la.fn),n.extend({trackArrayChanges:!0})},m.la.fn={remove:function(n){
for(var e=this.t(),t=[],i="function"!=typeof n||m.H(n)?function(e){return e===n}:n,o=0;o<e.length;o++){var a=e[o];i(a)&&(0===t.length&&this.ga(),t.push(a),e.splice(o,1),o--)}return t.length&&this.fa(),t},removeAll:function(e){if(e===n){var t=this.t(),i=t.slice(0);return this.ga(),t.splice(0,t.length),this.fa(),i}return e?this.remove(function(n){return 0<=m.a.o(e,n)}):[]},destroy:function(n){var e=this.t(),t="function"!=typeof n||m.H(n)?function(e){return e===n}:n;this.ga();for(var i=e.length-1;0<=i;i--)t(e[i])&&(e[i]._destroy=!0);this.fa()},destroyAll:function(e){return e===n?this.destroy(function(){return!0}):e?this.destroy(function(n){return 0<=m.a.o(e,n)}):[]},indexOf:function(n){var e=this();return m.a.o(e,n)},replace:function(n,e){var t=this.indexOf(n);0<=t&&(this.ga(),this.t()[t]=e,this.fa())}},m.a.ka&&m.a.Xa(m.la.fn,m.N.fn),m.a.q("pop push reverse shift sort splice unshift".split(" "),function(n){m.la.fn[n]=function(){var e=this.t();this.ga(),this.Vb(e,n,arguments);var t=e[n].apply(e,arguments);return this.fa(),t===e?this:t}}),m.a.q(["slice"],function(n){m.la.fn[n]=function(){var e=this();return e[n].apply(e,arguments)}}),m.b("observableArray",m.la),m.ya.trackArrayChanges=function(n,e){function t(){if(!o){o=!0;var e=n.notifySubscribers;n.notifySubscribers=function(n,t){return t&&t!==b||++r,e.apply(this,arguments)};var t=[].concat(n.t()||[]);a=null,i=n.X(function(e){if(e=[].concat(e||[]),n.Pa("arrayChange")){var i;(!a||1<r)&&(a=m.a.ib(t,e,n.hb)),i=a}t=e,a=null,r=0,i&&i.length&&n.notifySubscribers(i,"arrayChange")})}}if(n.hb={},e&&"object"==typeof e&&m.a.extend(n.hb,e),n.hb.sparse=!0,!n.Vb){var i,o=!1,a=null,r=0,s=n.sa,c=n.Ia;n.sa=function(e){s&&s.call(n,e),"arrayChange"===e&&t()},n.Ia=function(e){c&&c.call(n,e),"arrayChange"!==e||n.Pa("arrayChange")||(i.k(),o=!1)},n.Vb=function(n,e,t){function i(n,e,t){return s[s.length]={status:n,value:e,index:t}}if(o&&!r){var s=[],c=n.length,u=t.length,d=0;switch(e){case"push":d=c;case"unshift":for(e=0;e<u;e++)i("added",t[e],d+e);break;case"pop":d=c-1;case"shift":c&&i("deleted",n[d],d);break;case"splice":e=Math.min(Math.max(0,0>t[0]?c+t[0]:t[0]),c);for(var c=1===u?c:Math.min(e+(t[1]||0),c),u=e+u-2,d=Math.max(c,u),p=[],l=[],g=2;e<d;++e,++g)e<c&&l.push(i("deleted",n[e],e)),e<u&&p.push(i("added",t[g],e));m.a.dc(l,p);break;default:return}a=s}}}};var y=m.a.Yb("_state");m.m=m.B=function(e,t,i){function o(){if(0<arguments.length){if("function"!=typeof a)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return a.apply(r.pb,arguments),this}return m.l.oc(o),(r.S||r.s&&o.Qa())&&o.aa(),r.T}if("object"==typeof e?i=e:(i=i||{},e&&(i.read=e)),"function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed");var a=i.write,r={T:n,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:i.read,pb:t||i.owner,i:i.disposeWhenNodeIsRemoved||i.i||null,wa:i.disposeWhen||i.wa,mb:null,r:{},L:0,bc:null};return o[y]=r,o.Vc="function"==typeof a,m.a.ka||m.a.extend(o,m.J.fn),m.J.fn.rb(o),m.a.Ya(o,E),i.pure?(r.Va=!0,r.s=!0,m.a.extend(o,S)):i.deferEvaluation&&m.a.extend(o,_),m.options.deferUpdates&&m.ya.deferred(o,!0),r.i&&(r.Fb=!0,r.i.nodeType||(r.i=null)),r.s||i.deferEvaluation||o.aa(),r.i&&o.ba()&&m.a.F.oa(r.i,r.mb=function(){o.k()}),o};var E={equalityComparer:c,Aa:function(){return this[y].L},Pb:function(n,e,t){if(this[y].Va&&e===this)throw Error("A 'pure' computed must not be called recursively");this[y].r[n]=t,t.Ga=this[y].L++,t.na=e.Na()},Qa:function(){var n,e,t=this[y].r;for(n in t)if(t.hasOwnProperty(n)&&(e=t[n],e.ia.Uc(e.na)))return!0},bd:function(){this.Fa&&!this[y].Ra&&this.Fa()},ba:function(){return this[y].S||0<this[y].L},ld:function(){this.Mb||this.ac()},uc:function(n){if(n.cb&&!this[y].i){var e=n.X(this.bd,this,"dirty"),t=n.X(this.ld,this);return{ia:n,k:function(){e.k(),t.k()}}}return n.X(this.ac,this)},ac:function(){var n=this,e=n.throttleEvaluation;e&&0<=e?(clearTimeout(this[y].bc),this[y].bc=m.a.setTimeout(function(){n.aa(!0)},e)):n.Fa?n.Fa():n.aa(!0)},aa:function(n){var e=this[y],t=e.wa;if(!e.Ra&&!e.R){if(e.i&&!m.a.nb(e.i)||t&&t()){if(!e.Fb)return void this.k()}else e.Fb=!1;e.Ra=!0;try{this.Qc(n)}finally{e.Ra=!1}e.L||this.k()}},Qc:function(e){var t=this[y],i=t.Va?n:!t.L,o={Hc:this,Ma:t.r,lb:t.L};m.l.Ub({Gc:o,gb:g,m:this,Sa:i}),t.r={},t.L=0,o=this.Pc(t,o),this.tb(t.T,o)&&(t.s||this.notifySubscribers(t.T,"beforeChange"),t.T=o,t.s?this.zc():e&&this.notifySubscribers(t.T)),i&&this.notifySubscribers(t.T,"awake")},Pc:function(n,e){try{var t=n.jd;return n.pb?t.call(n.pb):t()}finally{m.l.end(),e.lb&&!n.s&&m.a.D(e.Ma,l),n.S=!1}},t:function(){var n=this[y];return(n.S&&!n.L||n.s&&this.Qa())&&this.aa(),n.T},Ta:function(n){m.J.fn.Ta.call(this,n),this.Fa=function(){this.Kb(this[y].T),this[y].S=!0,this.Lb(this)}},k:function(){var n=this[y];!n.s&&n.r&&m.a.D(n.r,function(n,e){e.k&&e.k()}),n.i&&n.mb&&m.a.F.pc(n.i,n.mb),n.r=null,n.L=0,n.R=!0,n.S=!1,n.s=!1,n.i=null}},S={sa:function(n){var e=this,t=e[y];if(!t.R&&t.s&&"change"==n){if(t.s=!1,t.S||e.Qa())t.r=null,t.L=0,t.S=!0,e.aa();else{var i=[];m.a.D(t.r,function(n,e){i[e.Ga]=n}),m.a.q(i,function(n,i){var o=t.r[n],a=e.uc(o.ia);a.Ga=i,a.na=o.na,t.r[n]=a})}t.R||e.notifySubscribers(t.T,"awake")}},Ia:function(e){var t=this[y];t.R||"change"!=e||this.Pa("change")||(m.a.D(t.r,function(n,e){e.k&&(t.r[n]={ia:e.ia,Ga:e.Ga,na:e.na},e.k())}),t.s=!0,this.notifySubscribers(n,"asleep"))},Na:function(){var n=this[y];return n.s&&(n.S||this.Qa())&&this.aa(),m.J.fn.Na.call(this)}},_={sa:function(n){"change"!=n&&"beforeChange"!=n||this.t()}};m.a.ka&&m.a.Xa(E,m.J.fn);var C=m.N.gd;m.m[C]=m.N,E[C]=m.m,m.Xc=function(n){return m.Oa(n,m.m)},m.Yc=function(n){return m.Oa(n,m.m)&&n[y]&&n[y].Va},m.b("computed",m.m),m.b("dependentObservable",m.m),m.b("isComputed",m.Xc),m.b("isPureComputed",m.Yc),m.b("computed.fn",E),m.G(E,"peek",E.t),m.G(E,"dispose",E.k),m.G(E,"isActive",E.ba),m.G(E,"getDependenciesCount",E.Aa),m.nc=function(n,e){return"function"==typeof n?m.m(n,e,{pure:!0}):(n=m.a.extend({},n),n.pure=!0,m.m(n,e))},m.b("pureComputed",m.nc),function(){function e(o,a,r){if(r=r||new i,"object"!=typeof(o=a(o))||null===o||o===n||o instanceof RegExp||o instanceof Date||o instanceof String||o instanceof Number||o instanceof Boolean)return o;var s=o instanceof Array?[]:{};return r.save(o,s),t(o,function(t){var i=a(o[t]);switch(typeof i){case"boolean":case"number":case"string":case"function":s[t]=i;break;case"object":case"undefined":var c=r.get(i);s[t]=c!==n?c:e(i,a,r)}}),s}function t(n,e){if(n instanceof Array){for(var t=0;t<n.length;t++)e(t);"function"==typeof n.toJSON&&e("toJSON")}else for(t in n)e(t)}function i(){this.keys=[],this.Ib=[]}m.wc=function(n){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return e(n,function(n){for(var e=0;m.H(n)&&10>e;e++)n=n();return n})},m.toJSON=function(n,e,t){return n=m.wc(n),m.a.Eb(n,e,t)},i.prototype={save:function(n,e){var t=m.a.o(this.keys,n);0<=t?this.Ib[t]=e:(this.keys.push(n),this.Ib.push(e))},get:function(e){return e=m.a.o(this.keys,e),0<=e?this.Ib[e]:n}}}(),m.b("toJS",m.wc),m.b("toJSON",m.toJSON),function(){m.j={u:function(e){switch(m.a.A(e)){case"option":return!0===e.__ko__hasDomDataOptionValue__?m.a.e.get(e,m.d.options.xb):7>=m.a.C?e.getAttributeNode("value")&&e.getAttributeNode("value").specified?e.value:e.text:e.value;case"select":return 0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex]):n;default:return e.value}},ha:function(e,t,i){switch(m.a.A(e)){case"option":switch(typeof t){case"string":m.a.e.set(e,m.d.options.xb,n),"__ko__hasDomDataOptionValue__"in e&&delete e.__ko__hasDomDataOptionValue__,e.value=t;break;default:m.a.e.set(e,m.d.options.xb,t),e.__ko__hasDomDataOptionValue__=!0,e.value="number"==typeof t?t:""}break;case"select":""!==t&&null!==t||(t=n);for(var o,a=-1,r=0,s=e.options.length;r<s;++r)if((o=m.j.u(e.options[r]))==t||""==o&&t===n){a=r;break}(i||0<=a||t===n&&1<e.size)&&(e.selectedIndex=a);break;default:null!==t&&t!==n||(t=""),e.value=t}}}}(),m.b("selectExtensions",m.j),m.b("selectExtensions.readValue",m.j.u),m.b("selectExtensions.writeValue",m.j.ha),m.h=function(){function n(n){n=m.a.$a(n),123===n.charCodeAt(0)&&(n=n.slice(1,-1));var e,t=[],r=n.match(i),s=[],c=0;if(r){r.push(",");for(var u,d=0;u=r[d];++d){var p=u.charCodeAt(0);if(44===p){if(0>=c){t.push(e&&s.length?{key:e,value:s.join("")}:{unknown:e||s.join("")}),e=c=0,s=[];continue}}else if(58===p){if(!c&&!e&&1===s.length){e=s.pop();continue}}else 47===p&&d&&1<u.length?(p=r[d-1].match(o))&&!a[p[0]]&&(n=n.substr(n.indexOf(u)+1),r=n.match(i),r.push(","),d=-1,u="/"):40===p||123===p||91===p?++c:41===p||125===p||93===p?--c:e||s.length||34!==p&&39!==p||(u=u.slice(1,-1));s.push(u)}}return t}var e=["true","false","null","undefined"],t=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),o=/[\])"'A-Za-z0-9_$]+$/,a={in:1,return:1,typeof:1},r={};return{ta:[],ea:r,yb:n,Ua:function(i,o){function a(n,i){var o;if(!d){var p=m.getBindingHandler(n);if(p&&p.preprocess&&!(i=p.preprocess(i,n,a)))return;(p=r[n])&&(o=i,0<=m.a.o(e,o)?o=!1:(p=o.match(t),o=null!==p&&(p[1]?"Object("+p[1]+")"+p[2]:o)),p=o),p&&c.push("'"+n+"':function(_z){"+o+"=_z}")}u&&(i="function(){return "+i+" }"),s.push("'"+n+"':"+i)}o=o||{};var s=[],c=[],u=o.valueAccessors,d=o.bindingParams,p="string"==typeof i?n(i):i;return m.a.q(p,function(n){a(n.key||n.unknown,n.value)}),c.length&&a("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},ad:function(n,e){for(var t=0;t<n.length;t++)if(n[t].key==e)return!0;return!1},Ea:function(n,e,t,i,o){n&&m.H(n)?!m.Ba(n)||o&&n.t()===i||n(i):(n=e.get("_ko_property_writers"))&&n[t]&&n[t](i)}}}(),m.b("expressionRewriting",m.h),m.b("expressionRewriting.bindingRewriteValidators",m.h.ta),m.b("expressionRewriting.parseObjectLiteral",m.h.yb),m.b("expressionRewriting.preProcessBindings",m.h.Ua),m.b("expressionRewriting._twoWayBindings",m.h.ea),m.b("jsonExpressionRewriting",m.h),m.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",m.h.Ua),function(){function n(n){return 8==n.nodeType&&r.test(a?n.text:n.nodeValue)}function e(n){return 8==n.nodeType&&s.test(a?n.text:n.nodeValue)}function i(t,i){for(var o=t,a=1,r=[];o=o.nextSibling;){if(e(o)&&0===--a)return r;r.push(o),n(o)&&a++}if(!i)throw Error("Cannot find closing comment tag to match: "+t.nodeValue);return null}function o(n,e){var t=i(n,e);return t?0<t.length?t[t.length-1].nextSibling:n.nextSibling:null}var a=t&&"\x3c!--test--\x3e"===t.createComment("test").text,r=a?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=a?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0};m.f={Z:{},childNodes:function(e){return n(e)?i(e):e.childNodes},xa:function(e){if(n(e)){e=m.f.childNodes(e);for(var t=0,i=e.length;t<i;t++)m.removeNode(e[t])}else m.a.ob(e)},da:function(e,t){if(n(e)){m.f.xa(e);for(var i=e.nextSibling,o=0,a=t.length;o<a;o++)i.parentNode.insertBefore(t[o],i)}else m.a.da(e,t)},mc:function(e,t){n(e)?e.parentNode.insertBefore(t,e.nextSibling):e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)},gc:function(e,t,i){i?n(e)?e.parentNode.insertBefore(t,i.nextSibling):i.nextSibling?e.insertBefore(t,i.nextSibling):e.appendChild(t):m.f.mc(e,t)},firstChild:function(t){return n(t)?!t.nextSibling||e(t.nextSibling)?null:t.nextSibling:t.firstChild},nextSibling:function(t){return n(t)&&(t=o(t)),t.nextSibling&&e(t.nextSibling)?null:t.nextSibling},Tc:n,pd:function(n){return(n=(a?n.text:n.nodeValue).match(r))?n[1]:null},kc:function(t){if(c[m.a.A(t)]){var i=t.firstChild;if(i)do{if(1===i.nodeType){var a;a=i.firstChild;var r=null;if(a)do{if(r)r.push(a);else if(n(a)){var s=o(a,!0);s?a=s:r=[a]}else e(a)&&(r=[a])}while(a=a.nextSibling);if(a=r)for(r=i.nextSibling,s=0;s<a.length;s++)r?t.insertBefore(a[s],r):t.appendChild(a[s])}}while(i=i.nextSibling)}}}}(),m.b("virtualElements",m.f),m.b("virtualElements.allowedBindings",m.f.Z),m.b("virtualElements.emptyNode",m.f.xa),m.b("virtualElements.insertAfter",m.f.gc),m.b("virtualElements.prepend",m.f.mc),m.b("virtualElements.setDomNodeChildren",m.f.da),function(){m.Q=function(){this.Fc={}},m.a.extend(m.Q.prototype,{nodeHasBindings:function(n){switch(n.nodeType){case 1:return null!=n.getAttribute("data-bind")||m.g.getComponentNameForNode(n);case 8:return m.f.Tc(n);default:return!1}},getBindings:function(n,e){var t=this.getBindingsString(n,e),t=t?this.parseBindingsString(t,e,n):null;return m.g.Ob(t,n,e,!1)},getBindingAccessors:function(n,e){var t=this.getBindingsString(n,e),t=t?this.parseBindingsString(t,e,n,{valueAccessors:!0}):null;return m.g.Ob(t,n,e,!0)},getBindingsString:function(n){switch(n.nodeType){case 1:return n.getAttribute("data-bind");case 8:return m.f.pd(n);default:return null}},parseBindingsString:function(n,e,t,i){try{var o,a=this.Fc,r=n+(i&&i.valueAccessors||"");if(!(o=a[r])){var s,c="with($context){with($data||{}){return{"+m.h.Ua(n,i)+"}}}";s=new Function("$context","$element",c),o=a[r]=s}return o(e,t)}catch(e){throw e.message="Unable to parse bindings.\nBindings value: "+n+"\nMessage: "+e.message,e}}}),m.Q.instance=new m.Q}(),m.b("bindingProvider",m.Q),function(){function t(n){return function(){return n}}function i(n){return n()}function a(n){return m.a.Ca(m.l.w(n),function(e,t){return function(){return n()[t]}})}function r(n,e,i){return"function"==typeof n?a(n.bind(null,e,i)):m.a.Ca(n,t)}function s(n,e){return a(this.getBindings.bind(this,n,e))}function c(n,e,t){var i,o=m.f.firstChild(e),a=m.Q.instance,r=a.preprocessNode;if(r){for(;i=o;)o=m.f.nextSibling(i),r.call(a,i);o=m.f.firstChild(e)}for(;i=o;)o=m.f.nextSibling(i),u(n,i,t)}function u(n,e,t){var i=!0,o=1===e.nodeType;o&&m.f.kc(e),(o&&t||m.Q.instance.nodeHasBindings(e))&&(i=p(e,null,n,t).shouldBindDescendants),i&&!g[m.a.A(e)]&&c(n,e,!o)}function d(n){var e=[],t={},i=[];return m.a.D(n,function o(a){if(!t[a]){var r=m.getBindingHandler(a);r&&(r.after&&(i.push(a),m.a.q(r.after,function(e){if(n[e]){if(-1!==m.a.o(i,e))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "));o(e)}}),i.length--),e.push({key:a,fc:r})),t[a]=!0}}),e}function p(e,t,o,a){var r=m.a.e.get(e,h);if(!t){if(r)throw Error("You cannot apply bindings multiple times to the same element.");m.a.e.set(e,h,!0)}!r&&a&&m.tc(e,o);var c;if(t&&"function"!=typeof t)c=t;else{var u=m.Q.instance,p=u.getBindingAccessors||s,l=m.B(function(){return(c=t?t(o,e):p.call(u,e,o))&&o.P&&o.P(),c},null,{i:e});c&&l.ba()||(l=null)}var g;if(c){var f=l?function(n){return function(){return i(l()[n])}}:function(n){return c[n]},b=function(){return m.a.Ca(l?l():c,i)};b.get=function(n){return c[n]&&i(f(n))},b.has=function(n){return n in c},a=d(c),m.a.q(a,function(t){var i=t.fc.init,a=t.fc.update,r=t.key;if(8===e.nodeType&&!m.f.Z[r])throw Error("The binding '"+r+"' cannot be used with virtual elements");try{"function"==typeof i&&m.l.w(function(){var t=i(e,f(r),b,o.$data,o);if(t&&t.controlsDescendantBindings){if(g!==n)throw Error("Multiple bindings ("+g+" and "+r+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");g=r}}),"function"==typeof a&&m.B(function(){a(e,f(r),b,o.$data,o)},null,{i:e})}catch(n){throw n.message='Unable to process binding "'+r+": "+c[r]+'"\nMessage: '+n.message,n}})}return{shouldBindDescendants:g===n}}function l(n){return n&&n instanceof m.U?n:new m.U(n)}m.d={};var g={script:!0,textarea:!0,template:!0};m.getBindingHandler=function(n){return m.d[n]},m.U=function(e,t,i,o){var a,r=this,s="function"==typeof e&&!m.H(e),c=m.B(function(){var n=s?e():e,a=m.a.c(n);return t?(t.P&&t.P(),m.a.extend(r,t),c&&(r.P=c)):(r.$parents=[],r.$root=a,r.ko=m),r.$rawData=n,r.$data=a,i&&(r[i]=a),o&&o(r,t,a),r.$data},null,{wa:function(){return a&&!m.a.Qb(a)},i:!0});c.ba()&&(r.P=c,c.equalityComparer=null,a=[],c.Ac=function(e){a.push(e),m.a.F.oa(e,function(e){m.a.La(a,e),a.length||(c.k(),r.P=c=n)})})},m.U.prototype.createChildContext=function(n,e,t){return new m.U(n,this,e,function(n,e){n.$parentContext=e,n.$parent=e.$data,n.$parents=(e.$parents||[]).slice(0),n.$parents.unshift(n.$parent),t&&t(n)})},m.U.prototype.extend=function(n){return new m.U(this.P||this.$data,this,null,function(e,t){e.$rawData=t.$rawData,m.a.extend(e,"function"==typeof n?n():n)})};var h=m.a.e.I(),f=m.a.e.I();m.tc=function(n,e){if(2!=arguments.length)return m.a.e.get(n,f);m.a.e.set(n,f,e),e.P&&e.P.Ac(n)},m.Ja=function(n,e,t){return 1===n.nodeType&&m.f.kc(n),p(n,e,l(t),!0)},m.Dc=function(n,e,t){return t=l(t),m.Ja(n,r(e,t,n),t)},m.eb=function(n,e){1!==e.nodeType&&8!==e.nodeType||c(l(n),e,!0)},m.Rb=function(n,t){if(!o&&e.jQuery&&(o=e.jQuery),t&&1!==t.nodeType&&8!==t.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");t=t||e.document.body,u(l(n),t,!0)},m.kb=function(e){switch(e.nodeType){case 1:case 8:var t=m.tc(e);if(t)return t;if(e.parentNode)return m.kb(e.parentNode)}return n},m.Jc=function(e){return(e=m.kb(e))?e.$data:n},m.b("bindingHandlers",m.d),m.b("applyBindings",m.Rb),m.b("applyBindingsToDescendants",m.eb),m.b("applyBindingAccessorsToNode",m.Ja),m.b("applyBindingsToNode",m.Dc),m.b("contextFor",m.kb),m.b("dataFor",m.Jc)}(),function(n){function e(e,i){var r,s=o.hasOwnProperty(e)?o[e]:n;s?s.X(i):(s=o[e]=new m.J,s.X(i),t(e,function(n,t){var i=!(!t||!t.synchronous);a[e]={definition:n,Zc:i},delete o[e],r||i?s.notifySubscribers(n):m.Y.Wa(function(){s.notifySubscribers(n)})}),r=!0)}function t(n,e){i("getConfig",[n],function(t){t?i("loadComponent",[n,t],function(n){e(n,t)}):e(null,null)})}function i(e,t,o,a){a||(a=m.g.loaders.slice(0));var r=a.shift();if(r){var s=r[e];if(s){var c=!1;if(s.apply(r,t.concat(function(n){c?o(null):null!==n?o(n):i(e,t,o,a)}))!==n&&(c=!0,!r.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(e,t,o,a)}else o(null)}var o={},a={};m.g={get:function(t,i){var o=a.hasOwnProperty(t)?a[t]:n;o?o.Zc?m.l.w(function(){i(o.definition)}):m.Y.Wa(function(){i(o.definition)}):e(t,i)},Xb:function(n){delete a[n]},Jb:i},m.g.loaders=[],m.b("components",m.g),m.b("components.get",m.g.get),m.b("components.clearCachedDefinition",m.g.Xb)}(),function(){function n(n,e,t,i){function o(){0==--s&&i(a)}var a={},s=2,c=t.template;t=t.viewModel,c?r(e,c,function(e){m.g.Jb("loadTemplate",[n,e],function(n){a.template=n,o()})}):o(),t?r(e,t,function(e){m.g.Jb("loadViewModel",[n,e],function(n){a[d]=n,o()})}):o()}function i(n,e,t){if("function"==typeof e)t(function(n){return new e(n)});else if("function"==typeof e[d])t(e[d]);else if("instance"in e){var o=e.instance;t(function(){return o})}else"viewModel"in e?i(n,e.viewModel,t):n("Unknown viewModel value: "+e)}function o(n){switch(m.a.A(n)){case"script":return m.a.ma(n.text);case"textarea":return m.a.ma(n.value);case"template":if(a(n.content))return m.a.ua(n.content.childNodes)}return m.a.ua(n.childNodes)}function a(n){return e.DocumentFragment?n instanceof DocumentFragment:n&&11===n.nodeType}function r(n,t,i){"string"==typeof t.require?s||e.require?(s||e.require)([t.require],i):n("Uses require, but no AMD loader is present"):i(t)}function c(n){return function(e){throw Error("Component '"+n+"': "+e)}}var u={};m.g.register=function(n,e){if(!e)throw Error("Invalid configuration for "+n);if(m.g.ub(n))throw Error("Component "+n+" is already registered");u[n]=e},m.g.ub=function(n){return u.hasOwnProperty(n)},m.g.od=function(n){delete u[n],m.g.Xb(n)},m.g.Zb={getConfig:function(n,e){e(u.hasOwnProperty(n)?u[n]:null)},loadComponent:function(e,t,i){var o=c(e);r(o,t,function(t){n(e,o,t,i)})},loadTemplate:function(n,i,r){if(n=c(n),"string"==typeof i)r(m.a.ma(i));else if(i instanceof Array)r(i);else if(a(i))r(m.a.V(i.childNodes));else if(i.element)if(i=i.element,e.HTMLElement?i instanceof HTMLElement:i&&i.tagName&&1===i.nodeType)r(o(i));else if("string"==typeof i){var s=t.getElementById(i);s?r(o(s)):n("Cannot find element with ID "+i)}else n("Unknown element type: "+i);else n("Unknown template value: "+i)},loadViewModel:function(n,e,t){i(c(n),e,t)}};var d="createViewModel";m.b("components.register",m.g.register),m.b("components.isRegistered",m.g.ub),m.b("components.unregister",m.g.od),m.b("components.defaultLoader",m.g.Zb),m.g.loaders.push(m.g.Zb),m.g.Bc=u}(),function(){function n(n,t){var i=n.getAttribute("params");if(i){var i=e.parseBindingsString(i,t,n,{valueAccessors:!0,bindingParams:!0}),i=m.a.Ca(i,function(e){return m.m(e,null,{i:n})}),o=m.a.Ca(i,function(e){var t=e.t();return e.ba()?m.m({read:function(){return m.a.c(e())},write:m.Ba(t)&&function(n){e()(n)},i:n}):t});return o.hasOwnProperty("$raw")||(o.$raw=i),o}return{$raw:{}}}m.g.getComponentNameForNode=function(n){var e=m.a.A(n);if(m.g.ub(e)&&(-1!=e.indexOf("-")||"[object HTMLUnknownElement]"==""+n||8>=m.a.C&&n.tagName===e))return e},m.g.Ob=function(e,t,i,o){if(1===t.nodeType){var a=m.g.getComponentNameForNode(t);if(a){if(e=e||{},e.component)throw Error('Cannot use the "component" binding on a custom element matching a component');var r={name:a,params:n(t,i)};e.component=o?function(){return r}:r}}return e};var e=new m.Q;9>m.a.C&&(m.g.register=function(n){return function(e){return t.createElement(e),n.apply(this,arguments)}}(m.g.register),t.createDocumentFragment=function(n){return function(){var e,t=n(),i=m.g.Bc;for(e in i)i.hasOwnProperty(e)&&t.createElement(e);return t}}(t.createDocumentFragment))}(),function(n){function e(n,e,t){if(!(e=e.template))throw Error("Component '"+n+"' has no template");n=m.a.ua(e),m.f.da(t,n)}function t(n,e,t,i){var o=n.createViewModel;return o?o.call(n,i,{element:e,templateNodes:t}):i}var i=0;m.d.component={init:function(n,o,a,r,s){function c(){var n=u&&u.dispose;"function"==typeof n&&n.call(u),d=u=null}var u,d,p=m.a.V(m.f.childNodes(n));return m.a.F.oa(n,c),m.m(function(){var a,r,l=m.a.c(o());if("string"==typeof l?a=l:(a=m.a.c(l.name),r=m.a.c(l.params)),!a)throw Error("No component name specified");var g=d=++i;m.g.get(a,function(i){if(d===g){if(c(),!i)throw Error("Unknown component '"+a+"'");e(a,i,n);var o=t(i,n,p,r);i=s.createChildContext(o,void 0,function(n){n.$component=o,n.$componentTemplateNodes=p}),u=o,m.eb(i,n)}})},null,{i:n}),{controlsDescendantBindings:!0}}},m.f.Z.component=!0}();var A={class:"className",for:"htmlFor"};m.d.attr={update:function(e,t){var i=m.a.c(t())||{};m.a.D(i,function(t,i){i=m.a.c(i);var o=!1===i||null===i||i===n;o&&e.removeAttribute(t),8>=m.a.C&&t in A?(t=A[t],o?e.removeAttribute(t):e[t]=i):o||e.setAttribute(t,i.toString()),"name"===t&&m.a.rc(e,o?"":i.toString())})}},function(){m.d.checked={after:["value","attr"],init:function(e,t,i){function o(){var n=e.checked,o=g?r():n;if(!m.va.Sa()&&(!c||n)){var a=m.l.w(t);if(d){var s=p?a.t():a;l!==o?(n&&(m.a.pa(s,o,!0),m.a.pa(s,l,!1)),l=o):m.a.pa(s,o,n),p&&m.Ba(a)&&a(s)}else m.h.Ea(a,i,"checked",o,!0)}}function a(){var n=m.a.c(t());e.checked=d?0<=m.a.o(n,r()):s?n:r()===n}var r=m.nc(function(){return i.has("checkedValue")?m.a.c(i.get("checkedValue")):i.has("value")?m.a.c(i.get("value")):e.value}),s="checkbox"==e.type,c="radio"==e.type;if(s||c){var u=t(),d=s&&m.a.c(u)instanceof Array,p=!(d&&u.push&&u.splice),l=d?r():n,g=c||d;c&&!e.name&&m.d.uniqueName.init(e,function(){return!0}),m.m(o,null,{i:e}),m.a.p(e,"click",o),m.m(a,null,{i:e}),u=n}}},m.h.ea.checked=!0,m.d.checkedValue={update:function(n,e){n.value=m.a.c(e())}}}(),m.d.css={update:function(n,e){var t=m.a.c(e());null!==t&&"object"==typeof t?m.a.D(t,function(e,t){t=m.a.c(t),m.a.bb(n,e,t)}):(t=m.a.$a(String(t||"")),m.a.bb(n,n.__ko__cssValue,!1),n.__ko__cssValue=t,m.a.bb(n,t,!0))}},m.d.enable={update:function(n,e){var t=m.a.c(e());t&&n.disabled?n.removeAttribute("disabled"):t||n.disabled||(n.disabled=!0)}},m.d.disable={update:function(n,e){m.d.enable.update(n,function(){return!m.a.c(e())})}},m.d.event={init:function(n,e,t,i,o){var a=e()||{};m.a.D(a,function(a){"string"==typeof a&&m.a.p(n,a,function(n){var r,s=e()[a];if(s){try{var c=m.a.V(arguments);i=o.$data,c.unshift(i),r=s.apply(i,c)}finally{!0!==r&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}!1===t.get(a+"Bubble")&&(n.cancelBubble=!0,n.stopPropagation&&n.stopPropagation())}})})}},m.d.foreach={ic:function(n){return function(){var e=n(),t=m.a.zb(e);return t&&"number"!=typeof t.length?(m.a.c(e),{foreach:t.data,as:t.as,includeDestroyed:t.includeDestroyed,afterAdd:t.afterAdd,beforeRemove:t.beforeRemove,afterRender:t.afterRender,beforeMove:t.beforeMove,afterMove:t.afterMove,templateEngine:m.W.sb}):{foreach:e,templateEngine:m.W.sb}}},init:function(n,e){return m.d.template.init(n,m.d.foreach.ic(e))},update:function(n,e,t,i,o){return m.d.template.update(n,m.d.foreach.ic(e),t,i,o)}},m.h.ta.foreach=!1,m.f.Z.foreach=!0,m.d.hasfocus={init:function(n,e,t){function i(i){n.__ko_hasfocusUpdating=!0;var o=n.ownerDocument;if("activeElement"in o){var a;try{a=o.activeElement}catch(n){a=o.body}i=a===n}o=e(),m.h.Ea(o,t,"hasfocus",i,!0),n.__ko_hasfocusLastValue=i,n.__ko_hasfocusUpdating=!1}var o=i.bind(null,!0),a=i.bind(null,!1);m.a.p(n,"focus",o),m.a.p(n,"focusin",o),m.a.p(n,"blur",a),m.a.p(n,"focusout",a)},update:function(n,e){var t=!!m.a.c(e());n.__ko_hasfocusUpdating||n.__ko_hasfocusLastValue===t||(t?n.focus():n.blur(),!t&&n.__ko_hasfocusLastValue&&n.ownerDocument.body.focus(),m.l.w(m.a.Da,null,[n,t?"focusin":"focusout"]))}},m.h.ea.hasfocus=!0,m.d.hasFocus=m.d.hasfocus,m.h.ea.hasFocus=!0,m.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(n,e){m.a.Cb(n,e())}},h("if"),h("ifnot",!1,!0),h("with",!0,!1,function(n,e){return n.createChildContext(e)});var j={};m.d.options={init:function(n){if("select"!==m.a.A(n))throw Error("options binding applies only to SELECT elements");for(;0<n.length;)n.remove(0);return{controlsDescendantBindings:!0}},update:function(e,t,i){function o(){return m.a.Ka(e.options,function(n){return n.selected})}function a(n,e,t){var i=typeof e;return"function"==i?e(n):"string"==i?n[e]:t}function r(n,t){if(h&&d)m.j.ha(e,m.a.c(i.get("value")),!0);else if(g.length){var o=0<=m.a.o(g,m.j.u(t[0]));m.a.sc(t[0],o),h&&!o&&m.l.w(m.a.Da,null,[e,"change"])}}var s=e.multiple,c=0!=e.length&&s?e.scrollTop:null,u=m.a.c(t()),d=i.get("valueAllowUnset")&&i.has("value"),p=i.get("optionsIncludeDestroyed");t={};var l,g=[];d||(s?g=m.a.fb(o(),m.j.u):0<=e.selectedIndex&&g.push(m.j.u(e.options[e.selectedIndex]))),u&&(void 0===u.length&&(u=[u]),l=m.a.Ka(u,function(e){return p||e===n||null===e||!m.a.c(e._destroy)}),i.has("optionsCaption")&&null!==(u=m.a.c(i.get("optionsCaption")))&&u!==n&&l.unshift(j));var h=!1;t.beforeRemove=function(n){e.removeChild(n)},u=r,i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(u=function(e,t){r(0,t),m.l.w(i.get("optionsAfterRender"),null,[t[0],e!==j?e:n])}),m.a.Bb(e,l,function(t,o,r){return r.length&&(g=!d&&r[0].selected?[m.j.u(r[0])]:[],h=!0),o=e.ownerDocument.createElement("option"),t===j?(m.a.Za(o,i.get("optionsCaption")),m.j.ha(o,n)):(r=a(t,i.get("optionsValue"),t),m.j.ha(o,m.a.c(r)),t=a(t,i.get("optionsText"),r),m.a.Za(o,t)),[o]},t,u),m.l.w(function(){d?m.j.ha(e,m.a.c(i.get("value")),!0):(s?g.length&&o().length<g.length:g.length&&0<=e.selectedIndex?m.j.u(e.options[e.selectedIndex])!==g[0]:g.length||0<=e.selectedIndex)&&m.a.Da(e,"change")}),m.a.Nc(e),c&&20<Math.abs(c-e.scrollTop)&&(e.scrollTop=c)}},m.d.options.xb=m.a.e.I(),m.d.selectedOptions={after:["options","foreach"],init:function(n,e,t){m.a.p(n,"change",function(){var i=e(),o=[];m.a.q(n.getElementsByTagName("option"),function(n){n.selected&&o.push(m.j.u(n))}),m.h.Ea(i,t,"selectedOptions",o)})},update:function(n,e){if("select"!=m.a.A(n))throw Error("values binding applies only to SELECT elements");var t=m.a.c(e()),i=n.scrollTop;t&&"number"==typeof t.length&&m.a.q(n.getElementsByTagName("option"),function(n){var e=0<=m.a.o(t,m.j.u(n));n.selected!=e&&m.a.sc(n,e)}),n.scrollTop=i}},m.h.ea.selectedOptions=!0,m.d.style={update:function(e,t){var i=m.a.c(t()||{});m.a.D(i,function(t,i){i=m.a.c(i),null!==i&&i!==n&&!1!==i||(i=""),e.style[t]=i})}},m.d.submit={init:function(n,e,t,i,o){if("function"!=typeof e())throw Error("The value for a submit binding must be a function");m.a.p(n,"submit",function(t){var i,a=e();try{i=a.call(o.$data,n)}finally{!0!==i&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}})}},m.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(n,e){m.a.Za(n,e())}},m.f.Z.text=!0,function(){if(e&&e.navigator)var t=function(n){if(n)return parseFloat(n[1])},i=e.opera&&e.opera.version&&parseInt(e.opera.version()),o=e.navigator.userAgent,a=t(o.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),r=t(o.match(/Firefox\/([^ ]*)/));if(10>m.a.C)var s=m.a.e.I(),c=m.a.e.I(),u=function(n){var e=this.activeElement;(e=e&&m.a.e.get(e,c))&&e(n)},d=function(n,e){var t=n.ownerDocument;m.a.e.get(t,s)||(m.a.e.set(t,s,!0),m.a.p(t,"selectionchange",u)),m.a.e.set(n,c,e)};m.d.textInput={init:function(e,t,o){function s(n,t){m.a.p(e,n,t)}function c(){var i=m.a.c(t());null!==i&&i!==n||(i=""),g!==n&&i===g?m.a.setTimeout(c,4):e.value!==i&&(h=i,e.value=i)}function u(){l||(g=e.value,l=m.a.setTimeout(p,4))}function p(){clearTimeout(l),g=l=n;var i=e.value;h!==i&&(h=i,m.h.Ea(t(),o,"textInput",i))}var l,g,h=e.value,f=9==m.a.C?u:p;10>m.a.C?(s("propertychange",function(n){"value"===n.propertyName&&f(n)}),8==m.a.C&&(s("keyup",p),s("keydown",p)),8<=m.a.C&&(d(e,f),s("dragend",u))):(s("input",p),5>a&&"textarea"===m.a.A(e)?(s("keydown",u),s("paste",u),s("cut",u)):11>i?s("keydown",u):4>r&&(s("DOMAutoComplete",p),s("dragdrop",p),s("drop",p))),s("change",p),m.m(c,null,{i:e})}},m.h.ea.textInput=!0,m.d.textinput={preprocess:function(n,e,t){t("textInput",n)}}}(),m.d.uniqueName={init:function(n,e){if(e()){var t="ko_unique_"+ ++m.d.uniqueName.Ic;m.a.rc(n,t)}}},m.d.uniqueName.Ic=0,m.d.value={after:["options","foreach"],init:function(n,e,t){if("input"!=n.tagName.toLowerCase()||"checkbox"!=n.type&&"radio"!=n.type){var i=["change"],o=t.get("valueUpdate"),a=!1,r=null;o&&("string"==typeof o&&(o=[o]),m.a.ra(i,o),i=m.a.Tb(i));var s=function(){r=null,a=!1;var i=e(),o=m.j.u(n);m.h.Ea(i,t,"value",o)};!m.a.C||"input"!=n.tagName.toLowerCase()||"text"!=n.type||"off"==n.autocomplete||n.form&&"off"==n.form.autocomplete||-1!=m.a.o(i,"propertychange")||(m.a.p(n,"propertychange",function(){a=!0}),m.a.p(n,"focus",function(){a=!1}),m.a.p(n,"blur",function(){a&&s()})),m.a.q(i,function(e){var t=s;m.a.nd(e,"after")&&(t=function(){r=m.j.u(n),m.a.setTimeout(s,0)},e=e.substring(5)),m.a.p(n,e,t)});var c=function(){var i=m.a.c(e()),o=m.j.u(n);if(null!==r&&i===r)m.a.setTimeout(c,0);else if(i!==o)if("select"===m.a.A(n)){var a=t.get("valueAllowUnset"),o=function(){m.j.ha(n,i,a)};o(),a||i===m.j.u(n)?m.a.setTimeout(o,0):m.l.w(m.a.Da,null,[n,"change"])}else m.j.ha(n,i)};m.m(c,null,{i:n})}else m.Ja(n,{checkedValue:e})},update:function(){}},m.h.ea.value=!0,m.d.visible={update:function(n,e){var t=m.a.c(e()),i="none"!=n.style.display;t&&!i?n.style.display="":!t&&i&&(n.style.display="none")}},function(n){m.d[n]={init:function(e,t,i,o,a){return m.d.event.init.call(this,e,function(){var e={};return e[n]=t(),e},i,o,a)}}}("click"),m.O=function(){},m.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},m.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},m.O.prototype.makeTemplateSource=function(n,e){if("string"==typeof n){e=e||t;var i=e.getElementById(n);if(!i)throw Error("Cannot find template with ID "+n);return new m.v.n(i)}if(1==n.nodeType||8==n.nodeType)return new m.v.qa(n);throw Error("Unknown template type: "+n)},m.O.prototype.renderTemplate=function(n,e,t,i){return n=this.makeTemplateSource(n,i),this.renderTemplateSource(n,e,t,i)},m.O.prototype.isTemplateRewritten=function(n,e){return!1===this.allowTemplateRewriting||this.makeTemplateSource(n,e).data("isRewritten")},
m.O.prototype.rewriteTemplate=function(n,e,t){n=this.makeTemplateSource(n,t),e=e(n.text()),n.text(e),n.data("isRewritten",!0)},m.b("templateEngine",m.O),m.Gb=function(){function n(n,e,t,i){n=m.h.yb(n);for(var o=m.h.ta,a=0;a<n.length;a++){var r=n[a].key;if(o.hasOwnProperty(r)){var s=o[r];if("function"==typeof s){if(r=s(n[a].value))throw Error(r)}else if(!s)throw Error("This template engine does not support the '"+r+"' binding within its templates")}}return t="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+m.h.Ua(n,{valueAccessors:!0})+" } })()},'"+t.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(t)+e}var e=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,t=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{Oc:function(n,e,t){e.isTemplateRewritten(n,t)||e.rewriteTemplate(n,function(n){return m.Gb.dd(n,e)},t)},dd:function(i,o){return i.replace(e,function(e,t,i,a,r){return n(r,t,i,o)}).replace(t,function(e,t){return n(t,"\x3c!-- ko --\x3e","#comment",o)})},Ec:function(n,e){return m.M.wb(function(t,i){var o=t.nextSibling;o&&o.nodeName.toLowerCase()===e&&m.Ja(o,n,i)})}}}(),m.b("__tr_ambtns",m.Gb.Ec),function(){m.v={},m.v.n=function(n){if(this.n=n){var e=m.a.A(n);this.ab="script"===e?1:"textarea"===e?2:"template"==e&&n.content&&11===n.content.nodeType?3:4}},m.v.n.prototype.text=function(){var n=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.n[n];var e=arguments[0];"innerHTML"===n?m.a.Cb(this.n,e):this.n[n]=e};var e=m.a.e.I()+"_";m.v.n.prototype.data=function(n){if(1===arguments.length)return m.a.e.get(this.n,e+n);m.a.e.set(this.n,e+n,arguments[1])};var t=m.a.e.I();m.v.n.prototype.nodes=function(){var e=this.n;if(0==arguments.length)return(m.a.e.get(e,t)||{}).jb||(3===this.ab?e.content:4===this.ab?e:n);m.a.e.set(e,t,{jb:arguments[0]})},m.v.qa=function(n){this.n=n},m.v.qa.prototype=new m.v.n,m.v.qa.prototype.text=function(){if(0==arguments.length){var e=m.a.e.get(this.n,t)||{};return e.Hb===n&&e.jb&&(e.Hb=e.jb.innerHTML),e.Hb}m.a.e.set(this.n,t,{Hb:arguments[0]})},m.b("templateSources",m.v),m.b("templateSources.domElement",m.v.n),m.b("templateSources.anonymousTemplate",m.v.qa)}(),function(){function e(n,e,t){var i;for(e=m.f.nextSibling(e);n&&(i=n)!==e;)n=m.f.nextSibling(i),t(i,n)}function t(n,t){if(n.length){var i=n[0],o=n[n.length-1],a=i.parentNode,r=m.Q.instance,s=r.preprocessNode;if(s){if(e(i,o,function(n,e){var t=n.previousSibling,a=s.call(r,n);a&&(n===i&&(i=a[0]||e),n===o&&(o=a[a.length-1]||t))}),n.length=0,!i)return;i===o?n.push(i):(n.push(i,o),m.a.za(n,a))}e(i,o,function(n){1!==n.nodeType&&8!==n.nodeType||m.Rb(t,n)}),e(i,o,function(n){1!==n.nodeType&&8!==n.nodeType||m.M.yc(n,[t])}),m.a.za(n,a)}}function i(n){return n.nodeType?n:0<n.length?n[0]:null}function o(n,e,o,a,s){s=s||{};var c=(n&&i(n)||o||{}).ownerDocument,u=s.templateEngine||r;if(m.Gb.Oc(o,u,c),o=u.renderTemplate(o,a,s,c),"number"!=typeof o.length||0<o.length&&"number"!=typeof o[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,e){case"replaceChildren":m.f.da(n,o),c=!0;break;case"replaceNode":m.a.qc(n,o),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+e)}return c&&(t(o,a),s.afterRender&&m.l.w(s.afterRender,null,[o,a.$data])),o}function a(n,e,t){return m.H(n)?n():"function"==typeof n?n(e,t):n}var r;m.Db=function(e){if(e!=n&&!(e instanceof m.O))throw Error("templateEngine must inherit from ko.templateEngine");r=e},m.Ab=function(e,t,s,c,u){if(s=s||{},(s.templateEngine||r)==n)throw Error("Set a template engine before calling renderTemplate");if(u=u||"replaceChildren",c){var d=i(c);return m.B(function(){var n=t&&t instanceof m.U?t:new m.U(m.a.c(t)),r=a(e,n.$data,n),n=o(c,u,r,n,s);"replaceNode"==u&&(c=n,d=i(c))},null,{wa:function(){return!d||!m.a.nb(d)},i:d&&"replaceNode"==u?d.parentNode:d})}return m.M.wb(function(n){m.Ab(e,t,s,n,"replaceNode")})},m.kd=function(e,i,r,s,c){function u(n,e){t(e,p),r.afterRender&&r.afterRender(e,n),p=null}function d(n,t){return p=c.createChildContext(n,r.as,function(n){n.$index=t}),o(null,"ignoreTargetNode",a(e,n,p),p,r)}var p;return m.B(function(){var e=m.a.c(i)||[];void 0===e.length&&(e=[e]),e=m.a.Ka(e,function(e){return r.includeDestroyed||e===n||null===e||!m.a.c(e._destroy)}),m.l.w(m.a.Bb,null,[s,e,d,r,u])},null,{i:s})};var s=m.a.e.I();m.d.template={init:function(n,e){var t=m.a.c(e());if("string"==typeof t||t.name)m.f.xa(n);else{if("nodes"in t){if(t=t.nodes||[],m.H(t))throw Error('The "nodes" option must be a plain, non-observable array.')}else t=m.f.childNodes(n);t=m.a.jc(t),new m.v.qa(n).nodes(t)}return{controlsDescendantBindings:!0}},update:function(e,t,i,o,a){var r,c=t();t=m.a.c(c),i=!0,o=null,"string"==typeof t?t={}:(c=t.name,"if"in t&&(i=m.a.c(t.if)),i&&"ifnot"in t&&(i=!m.a.c(t.ifnot)),r=m.a.c(t.data)),"foreach"in t?o=m.kd(c||e,i&&t.foreach||[],t,e,a):i?(a="data"in t?a.createChildContext(r,t.as):a,o=m.Ab(c||e,a,t,e)):m.f.xa(e),a=o,(r=m.a.e.get(e,s))&&"function"==typeof r.k&&r.k(),m.a.e.set(e,s,a&&a.ba()?a:n)}},m.h.ta.template=function(n){return n=m.h.yb(n),1==n.length&&n[0].unknown||m.h.ad(n,"name")?null:"This template engine does not support anonymous templates nested within its templates"},m.f.Z.template=!0}(),m.b("setTemplateEngine",m.Db),m.b("renderTemplate",m.Ab),m.a.dc=function(n,e,t){if(n.length&&e.length){var i,o,a,r,s;for(i=o=0;(!t||i<t)&&(r=n[o]);++o){for(a=0;s=e[a];++a)if(r.value===s.value){r.moved=s.multiChannelNew,s.moved=r.multiChannelNew,e.splice(a,1),i=a=0;break}i+=a}}},m.a.ib=function(){function n(n,e,t,i,o){var a,r,s,c,u,d=Math.min,p=Math.max,l=[],g=n.length,h=e.length,f=h-g||1,b=g+h+1;for(a=0;a<=g;a++)for(c=s,l.push(s=[]),u=d(h,a+f),r=p(0,a-1);r<=u;r++)s[r]=r?a?n[a-1]===e[r-1]?c[r-1]:d(c[r]||b,s[r-1]||b)+1:r+1:a+1;for(d=[],p=[],f=[],a=g,r=h;a||r;)h=l[a][r]-1,r&&h===l[a][r-1]?p.push(d[d.length]={status:t,value:e[--r],index:r}):a&&h===l[a-1][r]?f.push(d[d.length]={status:i,value:n[--a],index:a}):(--r,--a,o.sparse||d.push({status:"retained",value:e[r]}));return m.a.dc(f,p,!o.dontLimitMoves&&10*g),d.reverse()}return function(e,t,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},e=e||[],t=t||[],e.length<t.length?n(e,t,"added","deleted",i):n(t,e,"deleted","added",i)}}(),m.b("utils.compareArrays",m.a.ib),function(){function e(e,t,i,o,a){var r=[],s=m.B(function(){var n=t(i,a,m.a.za(r,e))||[];0<r.length&&(m.a.qc(r,n),o&&m.l.w(o,null,[i,n,a])),r.length=0,m.a.ra(r,n)},null,{i:e,wa:function(){return!m.a.Qb(r)}});return{ca:r,B:s.ba()?s:n}}var t=m.a.e.I(),i=m.a.e.I();m.a.Bb=function(o,a,r,s,c){function u(n,e){k=l[e],x!==e&&(S[n]=k),k.qb(x++),m.a.za(k.ca,o),f.push(k),w.push(k)}function d(n,e){if(n)for(var t=0,i=e.length;t<i;t++)e[t]&&m.a.q(e[t].ca,function(i){n(i,t,e[t].ja)})}a=a||[],s=s||{};var p=m.a.e.get(o,t)===n,l=m.a.e.get(o,t)||[],g=m.a.fb(l,function(n){return n.ja}),h=m.a.ib(g,a,s.dontLimitMoves),f=[],b=0,x=0,v=[],w=[];a=[];for(var k,y,E,S=[],g=[],_=0;y=h[_];_++)switch(E=y.moved,y.status){case"deleted":E===n&&(k=l[b],k.B&&(k.B.k(),k.B=n),m.a.za(k.ca,o).length&&(s.beforeRemove&&(f.push(k),w.push(k),k.ja===i?k=null:a[_]=k),k&&v.push.apply(v,k.ca))),b++;break;case"retained":u(_,b++);break;case"added":E!==n?u(_,E):(k={ja:y.value,qb:m.N(x++)},f.push(k),w.push(k),p||(g[_]=k))}m.a.e.set(o,t,f),d(s.beforeMove,S),m.a.q(v,s.beforeRemove?m.$:m.removeNode);for(var C,_=0,p=m.f.firstChild(o);k=w[_];_++){for(k.ca||m.a.extend(k,e(o,r,k.ja,c,k.qb)),b=0;h=k.ca[b];p=h.nextSibling,C=h,b++)h!==p&&m.f.gc(o,h,C);!k.Wc&&c&&(c(k.ja,k.ca,k.qb),k.Wc=!0)}for(d(s.beforeRemove,a),_=0;_<a.length;++_)a[_]&&(a[_].ja=i);d(s.afterMove,S),d(s.afterAdd,g)}}(),m.b("utils.setDomNodeChildrenFromArrayMapping",m.a.Bb),m.W=function(){this.allowTemplateRewriting=!1},m.W.prototype=new m.O,m.W.prototype.renderTemplateSource=function(n,e,t,i){return(e=(9>m.a.C?0:n.nodes)?n.nodes():null)?m.a.V(e.cloneNode(!0).childNodes):(n=n.text(),m.a.ma(n,i))},m.W.sb=new m.W,m.Db(m.W.sb),m.b("nativeTemplateEngine",m.W),function(){m.vb=function(){var n=this.$c=function(){if(!o||!o.tmpl)return 0;try{if(0<=o.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(n){}return 1}();this.renderTemplateSource=function(e,i,a,r){if(r=r||t,a=a||{},2>n)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=e.data("precompiled");return s||(s=e.text()||"",s=o.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),e.data("precompiled",s)),e=[i.$data],i=o.extend({koBindingContext:i},a.templateOptions),i=o.tmpl(s,e,i),i.appendTo(r.createElement("div")),o.fragments={},i},this.createJavaScriptEvaluatorBlock=function(n){return"{{ko_code ((function() { return "+n+" })()) }}"},this.addTemplate=function(n,e){t.write("<script type='text/html' id='"+n+"'>"+e+"<\/script>")},0<n&&(o.tmpl.tag.ko_code={open:"__.push($1 || '');"},o.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},m.vb.prototype=new m.O;var n=new m.vb;0<n.$c&&m.Db(n),m.b("jqueryTmplTemplateEngine",m.vb)}()})}()}(),define("util",["jquery"],function(n){function e(){this.ajax=function(e,t,i,o,a,r){n.ajax({url:r?"../../src/json":e,traditional:!0,type:t,dataType:i,data:o,global:!1,success:a,error:function(n,e,t){console.log("Ajax request error,errorType: "+e+",error: "+t),console.log(n)}})}}return e.prototype.get=function(n,e,t,i){this.ajax(n,"GET","json",e,t,i)},e.prototype.post=function(n,e,t){this.ajax(n,"POST","json",e,t)},e.prototype.put=function(n,e,t){this.ajax(n,"PUT","json",e,t)},e.prototype.delete=function(n,e,t){this.ajax(n,"DELETE","json",e,t)},e.prototype.jsonp=function(n,e,t){console.log(e),this.ajax(n,"GET","jsonp",e,t)},e.prototype.constructor=e,{ajaxHelper:new e,EventUtil:{addHandler:function(n,e,t){},getEvent:function(n){return n||window.event},getTarget:function(n){return n.target||n.srcElement},preventDefault:function(n){n.preventDefault?n.preventDefault():n.returnValue=!1},removeHandler:function(){},stopPropagation:function(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}},FormatDate:function(n){return n.getFullYear()+"-"+(n.getMonth()+1<10?"0"+(n.getMonth()+1):n.getMonth()+1)+"-"+n.getDate()+" "+(n.getHours()<10?"0"+n.getHours():n.getHours())+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes())+":"+(n.getSeconds()<10?"0"+n.getSeconds():n.getSeconds())},ScrollToBottom:function(){n(".scrollToBottom").length&&n(".scrollToBottom").scrollTop(n(".scrollToBottom")[0].scrollHeight)},Log:function(n,e){window.console&&window.console[n]&&(window.console[n]("[webAgent-IM]",(new Date).toLocaleString()+e),WebAgent.canWriteLog&&WebAgent.ButelAjax&&WebAgent.ButelAjax.ajaxFunc("WriteLogToLocal","writeLogToLocal","&loglevel="+n+"&logmsg=[webAgent-IM]"+e))}}}),define("normalize",[],function(){function n(n,i,o){if(n.match(s)||n.match(r))return n;n=a(n);var c=o.match(r),u=i.match(r);return!u||c&&c[1]==u[1]&&c[2]==u[2]?t(e(n,i),o):e(n,i)}function e(n,e){if("./"==n.substr(0,2)&&(n=n.substr(2)),n.match(s)||n.match(r))return n;var t=e.split("/"),i=n.split("/");for(t.pop();curPart=i.shift();)".."==curPart?t.pop():t.push(curPart);return t.join("/")}function t(n,e){var t=e.split("/");for(t.pop(),e=t.join("/")+"/",i=0;e.substr(i,1)==n.substr(i,1);)i++;for(;"/"!=e.substr(i,1);)i--;e=e.substr(i+1),n=n.substr(i+1),t=e.split("/");var o=n.split("/");for(out="";t.shift();)out+="../";for(;curPart=o.shift();)out+=curPart+"/";return out.substr(0,out.length-1)}var o=/([^:])\/+/g,a=function(n){return n.replace(o,"$1/")},r=/[^\:\/]*:\/\/([^\/])*/,s=/^(\/|data:)/,c=function(e,t,i){t=a(t),i=a(i);for(var o,r,e,s=/@import\s*("([^"]*)"|'([^']*)')|url\s*\((?!#)\s*(\s*"([^"]*)"|'([^']*)'|[^\)]*\s*)\s*\)/gi;o=s.exec(e);){r=o[3]||o[2]||o[5]||o[6]||o[4];var c;c=n(r,t,i);var u=o[5]||o[6]?1:0;e=e.substr(0,s.lastIndex-r.length-u-1)+c+e.substr(s.lastIndex-u-1),s.lastIndex=s.lastIndex+(c.length-r.length)}return e};return c.convertURIBase=n,c.absoluteURI=e,c.relativeURI=t,c}),define("css",[],function(){if("undefined"==typeof window)return{load:function(n,e,t){t()}};var n=document.getElementsByTagName("head")[0],e=window.navigator.userAgent.match(/Trident\/([^ ;]*)|AppleWebKit\/([^ ;]*)|Opera\/([^ ;]*)|rv\:([^ ;]*)(.*?)Gecko\/([^ ;]*)|MSIE\s([^ ;]*)|AndroidWebKit\/([^ ;]*)/)||0,t=!1,i=!0;e[1]||e[7]?t=parseInt(e[1])<6||parseInt(e[7])<=9:e[2]||e[8]?i=!1:e[4]&&(t=parseInt(e[4])<18);var o={};o.pluginBuilder="./css-builder";var a,r,s,c=function(){a=document.createElement("style"),n.appendChild(a),r=a.styleSheet||a.sheet},u=0,d=[],p=function(n){u++,32==u&&(c(),u=0),r.addImport(n),a.onload=function(){l()}},l=function(){s();var n=d.shift();return n?(s=n[1],void p(n[0])):void(s=null)},g=function(n,e){if(r&&r.addImport||c(),r&&r.addImport)s?d.push([n,e]):(p(n),s=e);else{a.textContent='@import "'+n+'";';var t=setInterval(function(){try{a.sheet.cssRules,clearInterval(t),e()}catch(n){}},10)}},h=function(e,t){var o=document.createElement("link");if(o.type="text/css",o.rel="stylesheet",i)o.onload=function(){o.onload=function(){},setTimeout(t,7)};else var a=setInterval(function(){for(var n=0;n<document.styleSheets.length;n++){if(document.styleSheets[n].href==o.href)return clearInterval(a),t()}},10);o.href=e,n.appendChild(o)};return o.normalize=function(n,e){return".css"==n.substr(n.length-4,4)&&(n=n.substr(0,n.length-4)),e(n)},o.load=function(n,e,i){(t?g:h)(e.toUrl(n+".css"),i)},o}),define("css!weixinEmojiC",[],function(){});var WeixinEmoji=function(){for(var n=[9728,9729,9748,9924,9889,127744,127745,127746,127747,127748,127749,127750,127751,127752,10052,9925,127753,127754,127755,127756,127759,127761,127764,127763,127769,127765,127771,127775,127776,128336,128337,128338,128339,128340,128341,128342,128343,128344,128345,128346,128347,8986,8987,9200,9203,9800,9801,9802,9803,9804,9805,9806,9807,9808,9809,9810,9811,9934,127808,127799,127793,127809,127800,127801,127810,127811,127802,127803,127796,127797,127806,127805,127812,127792,127804,127807,127826,127820,127822,127818,127827,127817,127813,127814,127816,127821,127815,127825,127823,128064,128066,128067,128068,128069,128132,128133,128134,128135,128136,128100,128102,128103,128104,128105,128106,128107,128110,128111,128112,128113,128114,128115,128116,128117,128118,128119,128120,128121,128122,128123,128124,128125,128126,128127,128128,128129,128130,128131,128012,128013,128014,128020,128023,128043,128024,128040,128018,128017,128025,128026,128027,128028,128029,128030,128032,128033,128034,128036,128037,128038,128035,128039,128041,128031,128044,128045,128047,128049,128051,128052,128053,128054,128055,128059,128057,128058,128046,128048,128056,128062,128050,128060,128061,128544,128553,128562,128542,128565,128560,128530,128525,128548,128540,128541,128523,128536,128538,128567,128563,128515,128517,128518,128513,128514,128522,9786,128516,128546,128557,128552,128547,128545,128524,128534,128532,128561,128554,128527,128531,128549,128555,128521,128570,128568,128569,128573,128571,128575,128574,128572,128576,128581,128582,128583,128584,128586,128585,128587,128588,128589,128590,128591,127968,127969,127970,127971,127973,127974,127975,127976,127977,127978,127979,9962,9970,127980,127983,127984,127981,9875,127982,128507,128508,128509,128510,128511,128094,128095,128096,128097,128098,128099,128083,128085,128086,128081,128084,128082,128087,128088,128089,128090,128091,128092,128093,128176,128177,128185,128178,128179,128180,128181,128184,133655818739,133656867306,133657915896,133658964471,133660013031,133662110201,133663158773,133664207351,133671547386,133674693112,128293,128294,128295,128296,128297,128298,128299,128302,128303,128304,128305,128137,128138,127344,127345,127374,127358,127872,127873,127874,127876,127877,127884,127878,127880,127881,127885,127886,127891,127890,127887,127879,127888,127875,127882,127883,127889,128223,9742,128222,128241,128242,128221,128224,9993,128232,128233,128234,128235,128238,128240,128226,128227,128225,128228,128229,128230,128231,128288,128289,128290,128291,128292,10002,128186,128187,9999,128206,128188,128189,128190,128191,128192,9986,128205,128195,128196,128197,128193,128194,128211,128214,128212,128213,128215,128216,128217,128218,128219,128220,128203,128198,128202,128200,128201,128199,128204,128210,128207,128208,128209,127933,9918,9971,127934,9917,127935,127936,127937,127938,127939,127940,127942,127944,127946,128643,128647,9410,128644,128645,128663,128665,128652,128655,128674,9992,9973,128649,128640,128676,128661,128666,128658,128657,128659,9981,127359,128677,128679,128680,9832,9978,127904,127905,127906,127907,127908,127909,127910,127911,127912,127913,127914,127915,127916,127917,127918,126980,127919,127920,127921,127922,127923,127924,127183,127925,127926,127927,127928,127929,127930,127931,127932,12349,128247,128249,128250,128251,128252,128139,128140,128141,128142,128143,128144,128145,128146,128286,169,174,8482,8505,2302179,3219683,3285219,3350755,3416291,3481827,3547363,3612899,3678435,3743971,3154147,128287,128246,128243,128244,127828,127833,127856,127836,127838,127859,127846,127839,127841,127832,127834,127837,127835,127842,127843,127857,127858,127847,127830,127845,127840,127829,127831,127848,127849,127850,127851,127852,127853,127854,127855,127844,127860,9749,127864,127866,127861,127862,127863,127867,127865,8599,8600,8598,8601,10548,10549,8596,8597,11014,11015,10145,11013,9654,9664,9193,9194,9195,9196,128314,128315,128316,128317,11093,10060,10062,10071,8265,8252,10067,10068,10069,12336,10160,10175,10084,128147,128148,128149,128150,128151,128152,128153,128154,128155,128156,128157,128158,128159,9829,9824,9830,9827,128684,128685,9855,128681,9888,9940,9851,128690,128694,128697,128698,128704,128699,128701,128702,128700,128682,128683,10004,127377,127378,127379,127380,127381,127382,127383,127384,127385,127386,127489,127490,127538,127539,127540,127541,127542,127514,127543,127544,127545,127535,127546,12953,12951,127568,127569,10133,10134,10006,10135,128160,128161,128162,128163,128164,128165,128166,128167,128168,128169,128170,128171,128172,10024,10036,10035,9898,9899,128308,128309,128306,128307,11088,11036,11035,9643,9642,9725,9726,9723,9724,128310,128311,128312,128313,10055,128174,128175,8617,8618,128259,128266,128267,128268,128269,128270,128274,128275,128271,128272,128273,128276,9745,128280,128278,128279,128281,128282,128283,128284,128285,8195,8194,8197,9989,9994,9995,9996,128074,128077,9757,128070,128071,128072,128073,128075,128079,128076,128078,128080],e={},t=n.length-1;t>=0;t--)e[n[t]]=!0;var i=function(n,e){return(n<<10)+e-56613888};return{replace:function(n){for(var t=n.length,o=-1,a=0,r="",s=[];++o<t;)r=n.charAt(o),a=n.charCodeAt(o),a>=55296&&a<=56319&&(r+=n.charAt(++o),a=i(a,n.charCodeAt(o))),e[a]?s.push('<i class="weixinEmoji weixinEmoji-'+a.toString(16)+'"></i>'):s.push(r);return s.join("")}}}();define("weixinEmojiJ",function(){});var WeixinEmojiExtend=function(){var n={"/::)":"0","/::~":"1","/::B":"2","/::|":"3","/:8-)":"4","/::<":"5","/::&lt;":"5","/::$":"6","/::X":"7","/::Z":"8","/::'(":"9","/::-|":"10","/::@":"11","/::P":"12","/::D":"13","/::O":"14","/::(":"15","/::+":"16","/:--b":"17","/::Q":"18","/::T":"19","/:,@P":"20","/:,@-D":"21","/::d":"22","/:,@o":"23","/::g":"24","/:|-)":"25","/::!":"26","/::L":"27","/::>":"28","/::&gt;":"28","/::,@":"29","/:,@f":"30","/::-S":"31","/:?":"32","/:,@x":"33","/:,@@":"34","/::8":"35","/:,@!":"36","/:!!!":"37","/:xx":"38","/:bye":"39","/:wipe":"40","/:dig":"41","/:handclap":"42","/:&-(":"43","/:&amp;-(":"43","/:B-)":"44","/:<@":"45","/:&lt;@":"45","/:@>":"46","/:@&gt;":"46","/::-O":"47","/:>-|":"48","/:&gt;-|":"48","/:P-(":"49","/::'|":"50","/:X-)":"51","/::*":"52","/:@x":"53","/:8*":"54","/:pd":"55","/:<W>":"56","/:&lt;W&gt;":"56","/:beer":"57","/:basketb":"58","/:oo":"59","/:coffee":"60","/:eat":"61","/:pig":"62","/:rose":"63","/:fade":"64","/:showlove":"65","/:heart":"66","/:break":"67","/:cake":"68","/:li":"69","/:bome":"70","/:kn":"71","/:footb":"72","/:ladybug":"73","/:shit":"74","/:moon":"75","/:sun":"76","/:gift":"77","/:hug":"78","/:strong":"79","/:weak":"80","/:share":"81","/:v":"82","/:@)":"83","/:jj":"84","/:@@":"85","/:bad":"86","/:lvu":"87","/:no":"88","/:ok":"89","/:love":"90","/:<L>":"91","/:&lt;L&gt;":"91","/:jump":"92","/:shake":"93","/:<O>":"94","/:&lt;O&gt;":"94","/:circle":"95","/:kotow":"96","/:turn":"97","/:skip":"98","/:oY":"99","/:#-0":"100","/:hiphot":"101","/:kiss":"102","/:<&":"103","/:&lt;&amp;":"103","/:&>":"104","/:&amp;&gt;":"104"},e={0:"/::)",1:"/::~",2:"/::B",3:"/::|",5:"/::<",6:"/::$",7:"/::X",8:"/::Z",11:"/::@",12:"/::P",13:"/::D",14:"/::O",15:"/::(",16:"/::+",22:"/::d",18:"/::Q",19:"/::T",24:"/::g",35:"/::8",26:"/::!",27:"/::L",38:"/:xx",28:"/::>",4:"/:8-)",9:"/::'(",10:"/::-|",20:"/:,@P",17:"/:--b",23:"/:,@o",25:"/:|-)",29:"/::,@",30:"/:,@f",31:"/::-S",33:"/:,@x",34:"/:,@@",47:"/::-O",48:"/:>-|",49:"/:P-(",50:"/::'|",51:"/:X-)",36:"/:,@!",37:"/:!!!",39:"/:bye",45:"/:<@",46:"/:@>",52:"/::*",53:"/:@x",54:"/:8*",55:"/:pd",32:"/:?",21:"/:,@-D",40:"/:wipe",41:"/:dig",42:"/:handclap",43:"/:&-(",44:"/:B-)",56:"/:<W>",59:"/:oo",69:"/:li",83:"/:@)",84:"/:jj",85:"/:@@",71:"/:kn",88:"/:no",89:"/:ok",99:"/:oY",61:"/:eat",62:"/:pig",76:"/:sun",91:"/:<L>",94:"/:<O>",78:"/:hug",86:"/:bad",87:"/:lvu",68:"/:cake",74:"/:shit",75:"/:moon",70:"/:bome",63:"/:rose",77:"/:gift",80:"/:weak",64:"/:fade",57:"/:beer",97:"/:turn",98:"/:skip",90:"/:love",92:"/:jump",66:"/:heart",67:"/:break",81:"/:share",72:"/:footb",96:"/:kotow",93:"/:shake",60:"/:coffee",79:"/:strong",95:"/:circle",58:"/:basketb",73:"/:ladybug",65:"/:showlove",82:"/:v",100:"/:#-0",101:"/:hiphot",102:"/:kiss",103:"/:<&",104:"/:&>"};return emotionUrl=WebAgent.config.weixinEmojiPath,emotionStringA='<img src="'+emotionUrl,emotionStringB='.gif" width="24" height="24">',{replace:function(e){for(var t in n)for(;-1!=e.indexOf(t);)e=e.replace(t,emotionStringA+n[t]+emotionStringB);return e},getInverseStr:function(n){return e[n]}}}();define("weixinEmojiExtend",function(){}),define("Message",["knockout","util","css!weixinEmojiC","weixinEmojiJ","weixinEmojiExtend"],function(n,e){return function(t,i,o,a,r,s){s=null===s||void 0===s?"null":s;var c={SEND:"send",RECV:"recv",TIP:"tip"};"text"==o&&(t=t&&t.replace(/\n/g,"<br/>")),this.text=t,this.direction=i||c.RECV,this.type=o,this.messageId=s,this.isShowWithdrawBtn=this.direction==c.SEND&&this.messageId,a instanceof Date?this.time=function(){return e.FormatDate(a)}:this.time=n.observable(a),this.name=r}}),define("RegisterEvent",[],function(){function n(n,e){void 0===o[n]&&(o[n]=[]),"function"==typeof e&&o[n].push(e)}function e(n,e){if(o[n]){if(!e)return void(o[n]=[]);for(var t=0;t<o[n].length;t++)if(o[n][t].name&&o[n][t].name===e.name){o[n].splice(t,1);break}}}function t(n,e){if(o[n])for(var t=0;t<o[n].length;t++)o[n][t](e)}var i={updateOrAddUser:"updateOrAddUser",kchartCreate:"kchartCreate",getButelState:"getButelState",busyCallback:"busyCallback",readyCallback:"readyCallback",loginCallback:"loginCallback",loginFailCallback:"loginFailCallback",logOutCallback:"logOutCallback",selectUser:"selectUser",sessionQuit:"sessionQuit",newCustomInter:"newCustomInter",timeOutTip:"timeOutTip",unReadMsgNum:"unReadMsgNum",openfireDisconnect:"openfireDisconnect",butelAjaxError:"butelAjaxError",callIn:"callIn",autoMatchCallback:"autoMatchCallback",openIntellCallback:"openIntellCallback"},o={};return{registerEvent:n,removeEvent:e,updateOrAddUser:function(n){t(i.updateOrAddUser,n)},kchartCreate:function(n){t(i.kchartCreate,n)},getButelState:function(n){t(i.getButelState,n)},busyCallback:function(n){t(i.busyCallback,n)},readyCallback:function(n){t(i.readyCallback,n)},loginCallback:function(n){t(i.loginCallback,n)},loginFailCallback:function(n){t(i.loginFailCallback,n)},logOutCallback:function(n){t(i.logOutCallback,n)},selectUser:function(n){t(i.selectUser,n)},sessionQuit:function(n){t(i.sessionQuit,n)},newCustomInter:function(n){t(i.newCustomInter,n)},timeOutTip:function(n){t(i.timeOutTip,n)},unReadMsgNum:function(n){t(i.unReadMsgNum,n)},openfireDisconnect:function(){t(i.openfireDisconnect)},butelAjaxError:function(n){t(i.butelAjaxError,n)},autoMatchCallback:function(n){t(i.autoMatchCallback,n)},openIntellCallback:function(n){t(i.openIntellCallback,n)},callIn:function(n){t(i.callIn,n)}}}),define("User",["knockout","require","Message","util","RegisterEvent"],function(n,e,t,i,o){return function(e,a,r,s,c){r=null===r||void 0===r?"webim":r,s=null===s||void 0===s?"":s,c=null===c||void 0===c?"custom-chat":s;var u,d,p=this,l=null;this.sessionId=s,this.chatBoxType=n.observable(c),this.chatBoxNum=2,this.hasSendEvalRequest=n.observable(!0),this.isSendEvalRequestBtnShow=n.computed(function(){return"custom-chat"==p.chatBoxType()&&p.hasSendEvalRequest()}),this.isTransferAgentBtnShow=n.computed(function(){return"custom-chat"==p.chatBoxType()}),this.isAddAgentBtnShow=n.computed(function(){return"custom-group"!==p.chatBoxType()}),this.serviceVideo=n.observable(!1),this.serviceAduio=n.observable(!1),this.isNewUser=n.observable(!0),this.memberNum="",this.beInvited="",this.members=n.observableArray([]),this.membersAgentIdList=[],this.name=e,this.ent=a,this.channel=r,this.nickName=n.observable(""),this.resource="",this.inputText=n.observable(),this.msgNumber=n.observable(0),this.messages=n.observableArray(),this.webrtcNum=n.observable(""),this.chatType=n.observable("chat"),this.visitorInfo=n.observable({workOrderName:n.observable(p.name&&p.name.substring(0,10)),workOrderEmail:n.observable(),workOrderPhone:n.observable()}),this.visitInfo=n.observable({sessionAntecedents:n.observable(),geoLocation:n.observable(),ipAddress:n.observable(),browserType:n.observable(),operatingSystem:n.observable()}),this.workOrder=n.observableArray(),this.online=n.observable(!0),this.skillGroupId=n.observable(),this.skillName="",this.isCalling=!1,this.kickOff=function(){p.online(!1)},this.hasMoreHistory=n.observable(!1),this.getHistoryStartTime="",this.historySessionId="",this.sessionTime=n.observable(0),this.showSessionTime=n.observable(""),this.addMessage=function(n,e,o,a,r,s,c){if("history"==s?p.messages.unshift(new t(n,e,o,a,r)):p.messages.push(new t(n,e,o,a,r,s)),!c)if("image"==o){var l=new Image;l.onload=function(){i.ScrollToBottom()},l.src=n.zoom||n.original}else i.ScrollToBottom();u=e,d=s,"recv"==e&&!p.isTiming&&p.online()&&"history"!=d&&"custom-chat"==p.chatBoxType()&&p.agentTimeoutReply(),"send"==e&&"history"!=d&&("blue"!=p.timeOutBack()&&p.timeOutBack("blue"),p.isTiming=!1,p.isFirstTiming=!1,p.isSecondTiming=!1)},this.getLastMessage=function(){var n=this,e={};return n.messages().length&&(e.previousTime=n.messages()[n.messages().length-1].time(),e.previousDirection=n.messages()[n.messages().length-1].direction),e},this.lastMsg=n.computed(function(){var n=this;if(n.messages().length){var e=n.messages()[n.messages().length-1].type,t=n.messages()[n.messages().length-1].text;switch(e){case"image":return"[图片]";case"file":return"[文件]";case"voice":return"[语音]";case"shortvideo":return"[视频]";default:return t&&-1!=t.indexOf("<br/>")?t.split("<br/>")[0]+"...":t}}},this),this.timeOutBack=n.observable("blue"),this.timeOut1=null,this.timeOut2=null,this.isTiming=!1,this.isFirstTiming=!1,this.isSecondTiming=!1,this.timing=n.observable(0);var g=function(n){if(n<60)return n<10?"00:0"+n:"00:"+n;var e=parseInt(n/60),t=n%60;return e<10?t<10?"0"+e+":0"+t:"0"+e+":"+t:t<10?e+":0"+t:e+":"+t},h=function(n){var e=parseInt(n),t=Math.floor(e/3600)<10?"0"+Math.floor(e/3600):Math.floor(e/3600),i=Math.floor(e/60%60)<10?"0"+Math.floor(e/60%60):Math.floor(e/60%60),o=Math.floor(e%60)<10?"0"+Math.floor(e%60):Math.floor(e%60),a="";return"00"!==t&&(a+=t+":"),a+=i+":",a+=o};this.changeSessionTime=function(n){"open"===n?p.sessionT=setInterval(function(){p.sessionTime(p.sessionTime()+1),p.showSessionTime(h(p.sessionTime()))},1e3):(clearInterval(p.sessionT),p.sessionTime(0),p.showSessionTime(h(p.sessionTime())))},this.agentTimeoutReply=function(){var n=(new Date).getTime(),e=0;l&&clearInterval(l),l=setInterval(function(){return e=parseInt(((new Date).getTime()-n)/1e3),p.timing(g(e)),p.online()?"send"==u&&"history"!=d?(e=0,p.timing(0),p.isTiming=!1,p.isFirstTiming=!1,p.isSecondTiming=!1,clearInterval(l),void(l=null)):e>=p.timeOut1&&!p.isFirstTiming?(o.timeOutTip({timeout:p.timeOut1/60,name:p.nickName()?p.nickName():p.name.substring(0,10)}),p.isFirstTiming=!0,p.isTiming=!0,void p.timeOutBack("yellow")):(e>=p.timeOut2&&!p.isSecondTiming&&(p.isSecondTiming=!0,p.isTiming=!0,p.timeOutBack("red"),o.timeOutTip({timeout:p.timeOut2/60,name:p.nickName()?p.nickName():p.name.substring(0,10)})),void(e>212400&&(clearInterval(l),l=null))):(p.timeOutBack(""),e=0,p.timing(0),p.isTiming=!1,p.isFirstTiming=!1,p.isSecondTiming=!1,clearInterval(l),void(l=null))},1e3)}}}),define("Drag",["jquery"],function(n){var e={};return e.dragElement=function(e,t,i){var o=!1,a={x:0,y:0};n(e).bind("mousedown",function(n){a.x=n.clientX,a.y=n.clientY,o=!0,n.preventDefault?n.preventDefault():n.returnValue=!1}),n(document).bind("mousemove",function(n){if(o){var e=n.clientX,r=n.clientY,s=e-a.x,c=r-a.y;if(t.style.left=t.offsetLeft+s+"px",t.style.top=t.offsetTop+c+"px",i){var u=parseInt(t.style.left),d=parseInt(t.style.top),p=i.offsetWidth,l=i.offsetHeight,g=t.offsetWidth,h=t.offsetHeight,m=p-g,f=l-h;m>=0?function(){u<0&&(t.style.left="0px"),u>m&&(t.style.left=m+"px")}():function(){u>=0&&(t.style.left="0px"),u<m&&(t.style.left=m+"px")}(),f>=0?function(){d<0&&(t.style.top="0px"),d>f&&(t.style.top=f+"px")}():function(){d>=0&&(t.style.top="0px"),d<f&&(t.style.top=f+"px")}()}a.x=e,a.y=r,n.preventDefault?n.preventDefault():n.returnValue=!1}}).bind("mouseup",function(){o=!1})},e}),define("IMG",["jquery","Drag"],function(n,e){function t(e,t){var i=n(".preview-image");l.css("width",e+"px"),l.css("height",t+"px");var o=p-t,a=d-e;i.css("top",o/2+"px"),i.css("left",a/2+"px")}function i(e){var t=n(".preview-percent"),i=parseInt(100*Math.pow(1.2,e))+"%";t.is(":hidden")&&t.show(),t.text(i),x&&clearTimeout(x),x=setTimeout(function(){n(".preview-percent").hide()},1e3)}function o(){v=(v+1)%4,a(v)}function a(n){l.get(0).style.filter="progid:DXImageTransform.Microsoft.BasicImage(rotation="+n+")"}function r(){360===w.deg&&(w.deg=0),l.css("transform","rotate("+(w.deg+=90)+"deg)")}function s(){w.nPower>=w.max_nPower||(w.nPower++,t(h*Math.pow(1.2,w.nPower),m*Math.pow(1.2,w.nPower)),i(w.nPower))}function c(){w.nPower<=w.min_nPower||(w.nPower--,t(h*Math.pow(1.2,w.nPower),m*Math.pow(1.2,w.nPower)),i(w.nPower))}function u(){function t(n){(n.originalEvent.wheelDelta||-n.originalEvent.detail)>0?s():c()}if(!n("#preview-div").get(0)){n("#chat_pane").append('<div id="preview-div" class="modal fade" role="dialog" aria-hidden="true" data-backdrop="static" style="padding-left: 0">                        <div style="text-align: center;">                            <div class="preview-container">                                <div class="preview-img-container">                                    <img class="preview-image" alt="" src="" id="img">        \t   \t\t\t\t\t\t<div class="preview-percent"></div>                                     <div class="preview-buttons">                                        <div class="preview-btn-group">                                            <span id="zoomIn" title="放大"></span>                                            <span id="zoomOut" title="缩小"></span>                                            <span id="rotate-btn" title="旋转"></span>                                        </div>                                     </div>                                </div>                                <div class="preview-close" data-dismiss="modal"></div>                            </div>                        </div>                    </div>');var i=n("#rotate-btn"),a=n("#zoomIn"),u=n("#zoomOut");l=n("#img"),g=n(".preview-img-container"),e.dragElement(l.get(0),l.get(0),g.get(0)),d=g.width(),p=g.height(),f=document.implementation.hasFeature("MouseEvents","2.0"),f||(i.bind("dblclick",function(){o()}),i.bind("click",function(){o()}),a.bind("dblclick",function(){s()}),
u.bind("dblclick",function(){c()})),i.bind("click",function(){r()}),a.bind("click",function(){s()}),u.bind("click",function(){c()}),g.bind("mousewheel",t).bind("DOMMouseScroll",t),g.bind("mouseover",function(){n(".preview-btn-group").show()}).bind("mouseout",function(){n(".preview-btn-group").hide()})}}var d,p,l,g,h,m,f,b={},x=null,v=0,w={deg:0,nPower:0,min_nPower:-15,max_nPower:15};return b.show=function(e){w.deg=0,w.nPower=0,u();var o=new Image;o.onload=function(){for(var n=h=o.width,e=m=o.height;n>d||e>p;)w.nPower--,n=h*Math.pow(1.2,w.nPower),e=m*Math.pow(1.2,w.nPower);i(w.nPower),t(n,e)},o.src=e,f||(v=0,a(v)),l.css("transform","rotate(0deg)"),l.attr("src",e),n("#preview-div").modal(),n(".modal-backdrop").addClass("modal-background")},b}),define("ViewModel",["jquery","knockout","util","User","require","IMG","RegisterEvent","css!weixinEmojiC","weixinEmojiJ","weixinEmojiExtend"],function(n,e,i,o,a,r,s){return function(){function c(n,e){var t=WebAgent.config.getProjectDataPath+"/chatLogInfo/queryChatLogInfo.do";n.getHistoryStartTime="function"==typeof e?"":(new Date).getTime(),console.log("chatBoxType:",n.chatBoxType());var o={entId:m.agentEntId(),customId:n.name,channel:S(n.channel),agentId:"1"===m.isShareMessage()||"custom-group"==n.chatBoxType()?"":m.agentId(),pageSize:10,time:n.getHistoryStartTime,imSessionId:"custom-group"==n.chatBoxType()?n.sessionId:n.historySessionId},a=function(t){var o=t.code,a=t.result;switch(o){case"0":if(a.length){n.messages([]),n.hasMoreHistory(!0);var r=m.refactorMsgs(a);r.forEach(function(e,t){t==r.length-1&&(n.getHistoryStartTime=e.timeMillis,"7"==e.contentType&&"以上内容为机器人会话内容"==e.msg?n.historySessionId=e.previousImSessionId:n.historySessionId=e.imSessionId),n.addMessage(e.msg,e.direction,e.type,e.time,"recv"==e.direction?n.name.substring(0,10):e.name,"history")}),"function"==typeof e?(e(!0),i.Log("log",n.name+"消息记录"+JSON.stringify(a,null,4))):i.Log("log","下线客户"+n.name+"消息记录"+JSON.stringify(a,null,4))}else n.hasMoreHistory(!1),e&&e(!1),i.Log("info",n.name+"聊天记录为空");break;case"-1":i.Log("error","获取消息记录接口异常，"+a)}};i.ajaxHelper.post(t,o,a)}function u(n){var e,t={},i={},o=[];for(var a in n){t.skillGroupName=n[a].skillGroupName,t.skillGroupId=a,t.agents=[],e=n[a].agents,m.username();for(var r in e)r!=m.agentId()&&(i=e[r],i.agentId=r,i.skillGroupId=a,i.skillGroupName=t.skillGroupName,t.agents.push(i));t.agents.length&&o.push(t),t={}}return o}function d(n,e){n=n||"",e=e||!1;var t=[],i=m.agentReadyLists,o=m.currentUser().membersAgentIdList;return console.log(m.currentUser()),i.length&&i.forEach(function(i){var a=[];a=i.agents.length&&i.agents.filter(function(t){return(!o.length||!o.includes(t.agentId))&&(e?t.currentServiceNum<t.maxServiceNum&&t.agentName.includes(n):t.agentName.includes(n))}),a.length&&t.push({skillGroupName:i.skillGroupName,skillGroupId:i.skillGroupId,agents:a})}),t}function p(n,e,t,i){var o=m.internalChatList().concat(m.userList());return o.length&&o.find(function(o){return e?e===o.name&&t===o.ent&&i===o.channel||o.sessionId==n:o.sessionId==n})||!1}function l(n){return n.reduce(function(n,e){return""==n?e.agentName:n+","+e.agentName},"")}function g(e,t,i,a){var r,s=i.split(":")[1],u=p(s),d="",g="",h="";if(msgBodyContent=t.content,membersAgentIdList=[],"msgFromDmsEnterMUC"==e&&!msgBodyContent.customId)return d=l(msgBodyContent.members),u?u.name=d:(u=new o(d,m.agentEntId(),"internal-chat",s,"agent-chat"),u.resource=a,m.internalChatList.push(u)),u.nickName(d),u.memberNum=msgBodyContent.memberNum,u.beInvited=msgBodyContent.beInvited,u.members(msgBodyContent.members),u.membersAgentIdList=msgBodyContent.members.map(function(n){return n.agentId}),msgBodyContent.memberNum>2&&(h=l(msgBodyContent.beInvited),u.chatBoxType("agent-group"),msgBodyContent.inviter.agentId==m.agentId()?u.addMessage(h+"已加入群聊","tip","text",new Date):msgBodyContent.beInvited.some(function(n){return n.agentId==m.agentId()})?(u.addMessage(msgBodyContent.inviter.agentName+"邀请你加入群聊","tip","text",new Date),u.msgNumber(1)):u.addMessage(msgBodyContent.inviter.agentName+"邀请"+h+"加入群聊","tip","text",new Date)),!1;if("msgFromDmsEnterMUC"==e&&msgBodyContent.customId)return r=msgBodyContent.customId.split(":"),msgBodyContent.inviter.agentId==m.agentId()?(u.addMessage(msgBodyContent.beInvited[0].agentName+"已加入群聊","tip","text",new Date),u.chatBoxType("custom-group")):(u?(u.online(!0),u.isNewUser(!0)):u=m.addUser(r[0],m.agentEntId(),msgBodyContent.customInfo.split(":")[2]),u.sessionId=s,u.chatBoxType("custom-group"),c(u,function(){u.addMessage(msgBodyContent.inviter.agentName+"邀请你加入群聊","tip","text",new Date),u.msgNumber(1)})),u.memberNum=msgBodyContent.memberNum,u.beInvited=msgBodyContent.beInvited,void u.members(msgBodyContent.members);if("msgFromDmsAgentQuitMUC"==e&&u)return 2==u.memberNum&&"agent-chat"==u.chatBoxType()?(m.internalChatList(m.internalChatList().filter(function(n){return n.sessionId!==u.sessionId})),m.currentUser().kickOff(),void u.changeSessionTime("close")):(u.members(u.members().filter(function(n){return n.agentId!==msgBodyContent.agentId&&(membersAgentIdList.push(n.agentId),!0)})),"custom-group"!=u.chatBoxType()&&(d=l(u.members()),u.nickName(d)),u.membersAgentIdList=membersAgentIdList,u.memberNum--,u.addMessage(msgBodyContent.agentName+"退出了群聊","tip","text",new Date),void(2==u.memberNum&&u.chatBoxType("custom-group"==u.chatBoxType()?"custom-chat":"agent-chat")));if("msgFromDmsSessionIdChange"==e&&u)return void(u.sessionId=msgBodyContent);if("msgFromDmsQuitMUCSuccess"==e&&u)return"custom-group"==u.chatBoxType()?m.userList(m.userList().filter(function(n){return n.sessionId!=s})):m.internalChatList(m.internalChatList().filter(function(n){return n.sessionId!=u.sessionId})),void(m.currentUser().sessionId==s&&(m.currentUser().name="",m.currentUser().kickOff(),m.currentUser().changeSessionTime("close"),m.currentUser().sessionId=""));if("msgAck"==e){var f=-1;if(u){for(var b=0;b<x.length;b++)if("text"==msgBodyContent.msgType&&x[b].type==msgBodyContent.msgType&&x[b].username==u.name&&decodeURI(x[b].content).trim()==msgBodyContent.msgContent.trim()||("image"==msgBodyContent.msgType||"file"==msgBodyContent.msgType)&&x[b].username==u.name){x[b].setTimeFun(!0),f=b;break}-1!=f&&x.splice(f,1)}return!1}if("text"==e||"image"==e||"file"==e){switch(e){case"text":g=WeixinEmojiExtend.replace(m.checkUrl(msgBodyContent));break;case"image":g={original:k(msgBodyContent),zoom:k(msgBodyContent)};break;case"file":g=k(t.content)}return void(u&&(u.addMessage(g,"recv",e,new Date,t.spokesman),u.sessionId!==m.currentUser().sessionId&&u.msgNumber(u.msgNumber()+1)))}return"msgFromDmsCreateMUCFailed"==e||"msgFromDmsJoinMUCFailed"==e?(m.msgTip(!0),m.msgWordHead("邀请坐席失败："),m.msgWord(msgBodyContent),void n(".message-input").attr("disabled",!0).css("background","white")):void 0}function h(n){var e;"audioCallOut"==n||"videoCallOut"==n?(e=m.currentUser(),m.currentUser().chatType("videoCallOut"==n?"video":"audio")):e=m.callInUser();var t=function(){switch(e.isCalling=!0,n){case"callIn":"video"==m.callInUser().chatType()?m.sendMessage("msgFromAgentAcceptVideo","","","",m.callInUser()):m.sendMessage("msgFromAgentAcceptCall","","","",m.callInUser());break;case"audioCallOut":m.sendMessage("msgFromAgentCallCustom");break;case"videoCallOut":m.sendMessage("msgFromAgentAskForVideo")}i.Log("info","IM侧发起外呼"),WebAgent.extend.makeCall({outCallNumber:"sip:"+e.webrtcNum(),disNumber:WebAgent.vm.disNumber().match(/\d+/)[0],userData:e.sessionId,mediaType:"video"==e.chatType()?"2":"1",ignoreTimeQuantumsCallLimit:"true"})};if(""==WebAgent.vm.disNumber())return void i.Log("error","外呼失败，外显号码不存在");WebAgent.vm.callEnabled()?t():WebAgent.vm.busyEnabled()?WebAgent.extend.setBusy(t):i.Log("info","当前状态不可呼叫")}var m=this,f=new RegExp("(http://|https://|ftp://|www.)+\\S+","g"),b=new RegExp("^(http://|https://|ftp://)");this.isShareMessage=e.observable("0"),this.username=e.observable(),this.userList=e.observableArray([]),this.currentUser=e.observable(new o),this.inputText=e.observable(),this.nickContent=e.observable({}),this.isRegister=e.observable(!1),this.agentOnline=e.observable(!1);var x=[];this.msgSendFail=e.observable(!1),this.msgContent=e.observable(""),this.msgTip=e.observable(!1),this.msgWord=e.observable(""),this.msgWordHead=e.observable(""),this.isMaxTalkUpSetBusy=e.observable(!1),this.maxTalkNum=e.observable(0),this.imPastePicDialog=e.observable(!1),this.imCutToolDialog=e.observable(!1),this.pastePicCancel=function(){document.querySelector("#picDiv").innerHTML="",m.imPastePicDialog(!1)};const v=JSON.parse(localStorage.getItem("commonWordList")||"[]");this.commonWordList=e.observableArray(v),this.commonWordValue=e.observable(""),this.isShowCommonWordBtn=e.observable(!0),this.currentCommonWord=e.observable(),this.isShowCommonWordDialog=e.observable(!1);const w=function(n){localStorage.setItem("commonWordList",JSON.stringify(n))};this.addCommonWord=function(){m.isShowCommonWordBtn(!1)},this.delCommonWord=function(n){m.commonWordList.splice(n,1),w(m.commonWordList())},this.handleChangeCommonWord=function(n){if("submit"===n){if(""===m.commonWordValue().trim())return void m.commonWordValue("");m.commonWordList.push({word:m.commonWordValue()}),w(m.commonWordList())}m.commonWordValue(""),m.isShowCommonWordBtn(!0)},this.showCommonWordDialog=function(){m.isShowCommonWordDialog(!0)},this.pastePicFun=function(e){var e=e.originalEvent,t=e.clipboardData,o=t.items[0];if("file"==o.kind){var a=o.getAsFile();if(0!=a.size){m.imPastePicDialog(!0);var r=document.querySelector("#picDiv"),s=n("#picDiv").width(),c=n("#picDiv").height(),u=0,d=new FileReader,p=new Image;p.file=a,d.onload=function(n){return function(e){n.src=e.target.result}}(p),d.onloadend=function(){for(var n=p.width,e=p.width,t=p.height,i=p.height;n>s||t>c;)u--,n=e*Math.pow(1.2,u),t=i*Math.pow(1.2,u);p.setAttribute("width",n+"px"),p.setAttribute("height",t+"px")},d.readAsDataURL(a),r.appendChild(p);return function(){var e=new FormData;e.append("file",a),n.ajax({url:WebAgent.config.FILE_UPLOAD_URL,type:"POST",cache:!1,data:e,processData:!1,contentType:!1,success:function(n){var e=JSON.parse(n);if("1"==e.ok){var t=e.originalImagePath,i=e.zoomImageUrl;m.sendMessage("image",t,i)}else alert(e.error);m.imPastePicDialog(!1),r.innerHTML=""},error:function(n){i.Log("log",n)}})}}}},this.openAutoMatch=e.observable(!1),this.intellHelp=e.observable(!1),this.openIntellHelp=e.observable(!1),this.agentEntId=e.observable(),this.agentId=e.observable(),this.timeOut=e.observable(),this.emojiPaneDis=e.observable(!1),this.videoPlace=e.observable(!1),this.onlineVideo=e.observable(""),this.videoImg=e.observable(WebAgent.baseUrl+"/Agent/images/video.png"),this.webRTCVideo=!1,this.webRTCAduio=!1,this.btnKeyListDis=e.observable(!1),this.btnKeyList=e.observableArray([{key:"Enter",desc:"按Enter键发送消息",faCheck:e.observable("Enter"==localStorage.getItem("chat-sendKey")||null==localStorage.getItem("chat-sendKey"))},{key:"CtrlEnter",desc:"按Ctrl+Enter键发送消息",faCheck:e.observable("CtrlEnter"==localStorage.getItem("chat-sendKey"))}]),this.readyEnabled=e.observable(!1),this.agentList=e.observableArray([]),this.transferMsg=e.observable(),this.isOnlineListShow=e.observable(!0),this.isOfflineListShow=e.observable(!0),this.isInternalChatListShow=e.observable(!1),this.isAgentAllListShow=e.observable(!1),this.onlineAgentNum=e.observable(0),this.queueUserNum=e.observable(0),this.currentImSessionId=e.observable(),this.onlineTipMusic=e.observable(WebAgent.baseUrl+"/Agent/tipMusic/onlineTip.mp3"),this.msgContentErrorDis=e.observable(!1),this.msgTipMusic=e.observable(WebAgent.baseUrl+"/Agent/tipMusic/msgTip.mp3"),this.setChatSoundTip=e.observable({onlineTip:!1,msgTip:!1}),this.isCheckWord=!0,this.checkWord=function(){if(!this.isCheckWord)return m.msgTip(!1),m.sendMessage("text"),void n(".message-input").attr("disabled",!1);var e=WebAgent.config.quickSmartReplyPath_sensitive+"/sensitiveWords/checkSensitiveWords",t="";if(console.log("self.inputText():",m.inputText()),(""==m.inputText()||void 0==m.inputText()||m.inputText()&&""==n.trim(m.inputText()))&&(t="消息内容不能为空！"),m.inputText()&&m.inputText().length>1e3&&(t="消息内容超出限制"),t)return m.msgContentErrorDis(t),void setTimeout(function(){m.msgContentErrorDis(!1)},800);if(""!=m.inputText()&&""!=m.inputText().trim()){var o={message:m.inputText(),entId:m.agentEntId()},a=function(e){switch(e.code){case"0":m.msgTip(!1),m.sendMessage("text"),n(".message-input").attr("disabled",!1);break;case"-1":m.msgTip(!0),m.msgWordHead("你输入的内容包含敏感词，无法发送："),m.msgWord(e.obj.join("/")),n(".message-input").attr("disabled",!0).css("background","white");break;default:i.Log("error",e.desc)}};i.ajaxHelper.post(e,o,a)}},o.prototype.msgTip=function(n,e){var t=this;if(!("Notification"in window))return void alert("您的浏览器不支持桌面通知特性，请下载谷歌浏览器试用该功能");Notification.requestPermission(function(i){if("granted"===i){var o=new Notification("提醒",{body:n,icon:WebAgent.baseUrl+"/Agent/images/qnsoft.png",dir:"auto",tag:t.name});e||(o.onclick=function(){m.selectUser(t),o.close()})}else alert("不能弹出通知，status:"+i)})},this.toggleChatList=function(e){return"online"==e?(m.isOnlineListShow(!m.isOnlineListShow()),void n("#onlineChatList").slideToggle()):"offline"==e?(m.isOfflineListShow(!m.isOfflineListShow()),void n("#offlineChatList").slideToggle()):"agentAllList"==e?(m.isAgentAllListShow(!m.isAgentAllListShow()),void n("#agentAllList").slideToggle()):void("internalChatList"==e&&(m.isInternalChatListShow(!m.isInternalChatListShow()),n("#internalChatList").slideToggle()))},this.addUser=function(n,e,t){var i=new o(n,e,t);return m.userList.push(i),i},this.selectUser=function(n){var e=m.currentUser();if(n.sessionId==e.sessionId)return void m.currentUser().msgNumber(0);m.currentUser().inputText(m.inputText()),m.transferMsg(""),m.currentUser(n),m.currentUser().msgNumber(0),m.inputText(n.inputText()),s.selectUser({userId:n.name,entId:n.ent,channel:n.channel}),n.isNewUser()&&(n.isNewUser(!1),i.ScrollToBottom())},this.onlineArr=e.computed(function(){return e.utils.arrayFilter(m.userList(),function(n){return n.online()})},this),this.offlineArr=e.computed(function(){return e.utils.arrayFilter(m.userList(),function(n){return!n.online()})},this),this.robotAgentList=e.observableArray(WebAgent.vm.robotAgentList()),this.agentAllList=e.observableArray([]),this.selectedRobotAgent=e.observable(),this.selectRobotAgent=function(n){var e=m.selectedRobotAgent();n.robotId==e.robotId&&n.robotName==e.robotName||m.selectedRobotAgent(n)},this.setReadyEnabled=e.computed(function(){return this.isMaxTalkUpSetBusy()&&this.maxTalkNum()<=this.onlineArr().length&&WebAgent.readyEnabled&&WebAgent.extend.setBusy(),!(this.isMaxTalkUpSetBusy()&&this.maxTalkNum()<=this.onlineArr().length)},this),this.msgTotal=e.computed(function(){var n=0;return e.utils.arrayFilter(m.userList(),function(e){n+=e.msgNumber()}),s.unReadMsgNum({unReadMsgNum:n}),n},this),this.setNickName=function(n,e){var t=p(e);t&&t.nickName(n&&n.substring(0,10))},this.setBusy=function(){m.sendState("msgFromAgentSetStateBusy","setBusy","PC")},this.setReady=function(){"webRTC"==WebAgent.callType&&(m.webRTCAduio=window.CR.checkDevice().supportVoice,m.webRTCVideo=m.webRTCVideo&&window.CR.checkDevice().supportVideo),m.sendState("msgFromAgentSetStateFree","setReady","PC",{content:{supportVoice:!WebAgent.sipUseWebRTC||m.webRTCAduio,supportVideo:!WebAgent.sipUseWebRTC||m.webRTCVideo}})},this.searchComLang=function(n){m.openAutoMatch()&&a("VmQuickReply").quickReplyDis()&&(s.autoMatchCallback(),a("VmQuickReply").searchComLang(n))},this.getIntellOpen=function(){var n=WebAgent.config.quickSmartReplyPath_sensitive+"/intelligentQuery/getPowerInfo",e={entId:m.agentEntId()},t=function(n){var e;"0"==n.code?(e="1"==n.obj.intelligentQueryPower,m.intellHelp(e)):i.Log("error",n.desc)};i.ajaxHelper.post(n,e,t)},this.searchSmartReply=function(n){var e=/^<img .*>$/;"text"!=n.type||e.test(n.text)||(s.openIntellCallback(),a("VmSmartReply").searchReply(n.text))},this.sendState=function(n,e,t,i){var o=null;switch(n){case"msgFromAgentSetStateBusy":case"msgFromAgentButelLogin":case"msgFromAgentButelLogout":case"msgFromAgentCallStart":o={type:n};break;case"msgFromAgentButelAlerting":case"msgFromAgentButelConnected":case"msgFromAgentButelEnd":case"msgFromAgentButelAlertingAbort":o={type:n,butelSessionId:i.butelSessionId};break;case"msgFromAgentSetStateFree":case"msgFromAgentCallEnd":o={type:n,content:i.content};break;case"msgFromAgentCreateMUC":o={type:n,agentList:i}}a("Login").sendState(e,m.agentEntId(),t,JSON.stringify(o))},this.sendMUC=function(n,e,t){var i;"msgFromAgentJoinMUC"==n&&(i={type:n,agentList:t.agentList,customId:t.customId}),a("Login").sendMUC(e,JSON.stringify(i))},this.sendSatisfy=function(){m.sendMessage("msgFromAgentSendSatisfy")},this.selectAgentForm=e.observable({}),this.getAgentList=function(e){"chat"==m.currentUser().chatType()&&("transfer"==e&&m.selectAgentForm({title:"请选择需要转移的坐席",type:"transfer"}),"addAgent"==e&&m.selectAgentForm({title:"请选择需要添加的群成员",type:"customAddAgent"}),m.sendMessage("msgFromAgentGetAgentList"),m.hasSelectedAgents([]),n("#agentSection").show())},this.agentLists=e.observableArray([]),this.agentReadyLists=[],this.agentListsLength=e.observable(0),this.hasSelectedAgents=e.observableArray([]),this.agentEabledSelectLists=e.observableArray([]),this.agentSearchText=e.observable(""),this.searchText=function(n){"agentListSearch"==n&&m.agentEabledSelectLists(d(m.agentSearchText(),"custom-chat"==m.currentUser().chatBoxType()))},this.internalChatList=e.observableArray([]),this.selectAgentChat=function(n){var e=m.internalChatList().length&&m.internalChatList().find(function(e){return 2==e.memberNum&&e.membersAgentIdList.includes(n.agentId)});e?m.currentUser(e):m.sendState("msgFromAgentCreateMUC","msgFromAgentCreateMUC","PC",n.agentId)},this.confirmAgent=function(){var e,t;return!!m.hasSelectedAgents().length&&(n("#agentSection").hide(),"transfer"==m.selectAgentForm().type?(e=m.hasSelectedAgents()[0],m.sendMessage("msgFromAgentTransferAgent",'{"destAgentId":"'+e.agentId+'","entId":"'+m.agentEntId()+'","skillGroupId":"'+e.skillGroupId+'","transferMessage":"'+m.transferMsg()+'"}'),void m.transferMsg("")):(t="custom-chat"==m.currentUser().chatBoxType()?m.hasSelectedAgents()[0].agentId:m.hasSelectedAgents().reduce(function(n,e){return n+","+e.agentId},""),void a("Login").sendMUC(m.currentUser().sessionId,{type:"msgFromAgentJoinMUC",agentList:t,customId:m.currentUser().name+":"+m.agentEntId()+":"+m.currentUser().channel})))},this.closeTip=function(e){switch(e){case"agentSession":n("#agentSection").hide();break;case"sensitive":m.msgTip(!1),n(".message-input").attr("disabled",!1);break;case"chatClose":m.keepChatTip({keepchatTipShow:!1,beInvitedAgentId:""});break;case"chatKeep":m.sendState("msgFromAgentCreateMUC","msgFromAgentCreateMUC","PC",m.keepChatTip().beInvitedAgentId),m.keepChatTip({keepchatTipShow:!1,beInvitedAgentId:""})}},this.keepChatTip=e.observable({keepchatTipShow:!1,beInvitedAgentId:""}),this.sendMessage=function(e,i,o,r,c,u){var d,p=/.*<.+>.*/i;if(""===m.inputText()&&"text"===e&&!r)return!1;if("text"==e&&p.test(m.inputText()))return m.msgContentErrorDis("您输入的内容存在非法字符"),void setTimeout(function(){m.msgContentErrorDis(!1)},1500);var c=c||m.currentUser(),l=c.name,g=c.ent,h=c.channel,f=c.resource,b=c.getLastMessage(),v=null;switch(e){case"text":r?(d=r,v={type:e,content:r}):(d=m.inputText()&&m.inputText().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;"),d=WeixinEmojiExtend.replace(m.checkUrl(d)),v={type:e,content:encodeURI(m.inputText())},m.inputText(""));break;case"tip":v={type:e,content:r},c.addMessage(r,"tip","text",new Date);break;case"voice":break;case"image":v={type:e,content:i,compressPicUrl:o},d={original:k(i),zoom:k(o)};break;case"file":e=/\.(mp4|MP4|OGG|ogg|WEBM|webm)$/.test(i)?"video":"file",v={type:e,content:i},d=k(i);break;case"msgFromAgentkickCustom":v={type:e},c.kickOff(),c.changeSessionTime("close"),c.addMessage("您结束了会话","tip","text",new Date),s.sessionQuit({userId:c.name,messages:c.messages()});break;case"msgFromAgentTransferAgent":c.changeSessionTime("close"),v={type:e,content:i};break;case"msgFromAgentSendSatisfy":case"msgFromAgentGetAgentList":case"msgFromAgentSatisfySend":case"msgFromAgentRefuseCall":case"msgFromAgentAcceptCall":case"msgFromAgentCallCustom":case"msgFromAgentAcceptVideo":case"msgFromAgentAskForVideo":case"msgFromAgentRefuseVideo":case"welcome":v={type:e};break;case"msgFromAgentMessageWithdraw":v={type:e,content:i}}1!=u&&c.msgNumber(0),v.previousTime=b.previousTime?b.previousTime:"","recv"===b.previousDirection?v.previousDirection="1":"send"===b.previousDirection||"tip"===b.previousDirection?v.previousDirection="2":v.previousDirection="",["text","image","file","video"].includes(e)&&(v.messageId=(new Date).getTime(),c.addMessage(d,"send",e,new Date,m.username(),v.messageId)),["text","image","file"].includes(e)&&(x.push({username:l,content:v.content,type:e,index:x.length,setTimeFun:function(i){if(i)return void clearTimeout(t);t=setTimeout(function(){var t="text"==e?text:"image"==e?"图片":"文件";x.splice(this.index,1),m.msgTip(!0),m.msgWordHead(l.slice(0,10)+"客户消息未发送成功:"),m.msgWord(t),n(".message-input").attr("disabled",!0).css("background","white")},1500)}}),x[x.length-1].setTimeFun(!1)),"custom-chat"==c.chatBoxType()||"msgFromAgentGetAgentList"==e?a("Login").sendMessage(l,g,h,JSON.stringify(v),f):a("Login").sendMUC(c.sessionId,v)},this.withdrawBtn=function(n,e,t){var i;"send"==e&&(t=m.currentUser()),(i=t.messages().findIndex(function(t){return t.messageId==n&&t.direction==e}))&&("send"==e&&this.sendMessage("msgFromAgentMessageWithdraw",n),t.messages.splice(i,1))},this.sendMessageByKey=function(n,e){var t=localStorage.getItem("chat-sendKey")||"Enter";if(!m.imPastePicDialog()){switch(t){case"Enter":13!==e.keyCode||e.ctrlKey||(e.preventDefault(),m.checkWord()),13===e.keyCode&&e.ctrlKey&&m.inputText(m.inputText()+"\n");break;case"CtrlEnter":13===e.keyCode&&e.ctrlKey&&m.checkWord()}return!0}},this.toggleBtnKeyList=function(){m.btnKeyListDis(!m.btnKeyListDis())},this.choseSendKey=function(n){for(var e=0;e<m.btnKeyList().length;e++)m.btnKeyList()[e].key!=n.key?m.btnKeyList()[e].faCheck(!1):m.btnKeyList()[e].faCheck(!0);m.btnKeyListDis(!1),localStorage.setItem("chat-sendKey",n.key)},this.checkUrl=function(n){return n&&n.match(f)&&(n=n.replace(f,function(n){return"<a target='_blank' href='"+(b.exec(n)?n:"http://"+n)+"'>"+n+"</a>"})),n};var k=function(n){if(b.test(n)){var e=n.split("/");e.splice(0,3),n=WebAgent.config.DOWN_FILE_URL+e.join("/")}else n=WebAgent.config.DOWN_FILE_URL+n;return n},y=function(n){return n<60?n+"秒":parseInt(n/60)+"分 "+n%60+"秒"};this.refactorMsgs=function(n){var e=null,t=null,i=null,o=[];return n.forEach(function(n,a){switch(e=null,"1"==n.direction&&(t="recv",i=n.customId),"2"==n.direction&&(t="send",i=n.agentName),n.contentType){case"1":e={msg:WeixinEmojiExtend.replace(m.checkUrl(n.content)),direction:t,type:"text",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,contentType:n.contentType};break;case"2":e={msg:{zoom:k(n.content),original:k(n.content)},direction:t,type:"image",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,contentType:n.contentType};break;case"3":e={msg:k(n.content),direction:t,type:"voice",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,contentType:n.contentType};break;case"4":e={msg:k(n.content),direction:t,type:"file",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,contentType:n.contentType};break;case"5":e={timeMillis:n.timeMillis,imSessionId:n.imSessionId,contentType:n.contentType};break;case"6":e={msg:n.content,direction:"tip",type:"text",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,contentType:n.contentType};break;case"7":e={msg:n.content,direction:"tip",type:"text",time:n.time,timeMillis:n.timeMillis,name:i,imSessionId:n.imSessionId,previousImSessionId:n.previousImSessionId,contentType:n.contentType}}e&&o.push(e)}),o};var E=function(n){switch(n){case"2":return"webim";case"3":return"weixin";case"4":return"butel";case"5":return"appim";case"7":return"weixinim"}},S=function(n){switch(n){case"webim":case"internal-chat":return"2";case"weixin":return"3";case"butel":return"4";case"appim":return"5";case"weixinim":return"7"}};this.getCuAmount=function(){var n=WebAgent.config.getProjectDataPath+"/cuAmount/getCuAmount.do",e={entId:m.agentEntId()},t=function(n){switch(n.code){case"0":n.result?(m.onlineAgentNum(n.result.onLine),m.queueUserNum(n.result.queue)):i.Log("info","获取在线客服数/排队客户数结果为空");break;case"-1":i.Log("error","获取在线客服数/排队客户数接口异常，"+n.result)}};i.ajaxHelper.post(n,e,t)},this.getOfflineList=function(){var n=WebAgent.config.getProjectDataPath+"/stateDetailForAgentId/queryForAgent.do",e={entId:m.agentEntId(),agentId:m.agentId()},t=function(n){var e=n.code,t=n.result,o=null;switch(e){case"0":i.Log("log","下线客户列表："+JSON.stringify(n)),t.length?t.forEach(function(n,e){o=m.addUser(n.customerId,n.entId,E(n.channel)),o.online(!1),c(o)}):i.Log("info","获取当天下线客户列表为空");break;case"-1":i.Log("error","获取当天下线客户列表接口异常，"+t)}};i.ajaxHelper.post(n,e,t)},this.getMoreHistoryChats=function(){var e=WebAgent.config.getProjectDataPath+"/chatLogInfo/queryChatLogInfo.do",t=m.currentUser(),o={entId:m.agentEntId(),customId:t.name,channel:"custom-group"==t.chatBoxType()?"":S(t.channel),agentId:"1"===m.isShareMessage()||"custom-group"==t.chatBoxType()?"":m.agentId(),pageSize:10,time:t.getHistoryStartTime,imSessionId:"custom-group"==t.chatBoxType()?t.sessionId:t.historySessionId},a=n(".scrollToBottom")[0].scrollHeight,r=function(e){var o=e.code,r=e.result;switch(o){case"0":if(r.length){i.Log("log",t.name+"更多消息记录"+JSON.stringify(r,null,4)),t.hasMoreHistory(!0);var s=m.refactorMsgs(r);s.forEach(function(n,e){e==s.length-1&&(t.getHistoryStartTime=n.timeMillis,"7"==n.contentType&&"以上内容为机器人会话内容"==n.msg?t.historySessionId=n.previousImSessionId:t.historySessionId=n.imSessionId),t.addMessage(n.msg,n.direction,n.type,n.time,"recv"==n.direction?t.name.substring(0,10):n.name,"history",!0)})}else t.hasMoreHistory(!1),t.addMessage("无更多消息记录","tip","text",new Date,"","history",!0);n(".scrollToBottom").scrollTop(n(".scrollToBottom")[0].scrollHeight-a-30);break;case"-1":i.Log("error","获取更多消息记录接口异常，"+r)}};i.ajaxHelper.post(e,o,r)},this.getChatMsgs=function(n){var e;if(m.userList().length)return m.userList().forEach(function(t,i){n==t.name&&(e=m.userList()[i].messages())}),e},this.handleMessage=function(n,e,t){function r(n){switch(C){case 0:n&&"1"==I.robotPower&&m.sendMessage("tip","","","以上内容为机器人会话内容",S);var e="新客户到达，客服"+m.username()+"为客户服务",t=y(parseInt(I.queueTime/1e3));m.sendMessage("tip","","",e,S),"webim"==v&&(l+="服务渠道："+v+"<br/>服务技能组："+T.groupName+"<br/>城市来源："+I.geoLocation+"<br/>业务来源："+I.businessSource+"<br/>网站名称："+I.websiteName+"<br/>排队时长："+t+"<br/>发起页面："+I.sessionAntecedents),"weixin"!=v&&"weixinim"!=v||(l+="服务渠道："+v+"<br/>服务技能组："+T.groupName+"<br/>城市来源："+I.geoLocation+"<br/>业务来源："+I.businessSource+"<br/>公众号名称："+I.websiteName+"<br/>排队时长："+t),"appim"==v&&(l+="服务渠道："+v+"<br/>服务技能组："+T.groupName+"<br/>城市来源："+I.geoLocation+"<br/>业务来源："+I.businessSource+"<br/>应用名称："+I.websiteName+"<br/>排队时长："+t),l&&m.sendMessage("tip","","",l,S),I.welcomeTip&&(S.addMessage(I.welcomeTip,"send","text",new Date),m.sendMessage("welcome","","","",S));break;case 1:var i="以上内容为客服"+T.transferAgentName+"与客户的聊天内容<br/>该会话转接自客服"+T.transferAgentName+" <br/>转接留言："+T.transferMessage;m.sendMessage("tip","","",i,S)}S.msgNumber(1)}i.Log("log","msgBody, nickContent, resource:"+n+","+e+","+t);var l="",h=e.split(":");console.log(h);var f=h[0],b=h[1],v=h[2],w=h[3],E=n.type;if("MUC"==f||"msgFromDmsEnterMUC"==E)return g(E,n,e,t),!1;var S=p(w,f,b,v),_=!1,C=null,A=null;if("butel"!==v){S&&!["msgFromDmsSetStateFreeSuccsess","msgFromDmsSetStateBusySuccess","msgFromDmsAgentLoginSuccess","msgAck","msgFromCustomMessageWithdraw","msgFromDmsGetAgentListResponse","msgFromCustomMessageWithdraw"].includes(E)&&m.userList().forEach(function(n,e){S==n&&(m.userList.splice(e,1),m.userList.unshift(S))}),S||"msgFromDmsNewCustomInter"!=E||(S=m.addUser(f,b,v));var j=S&&S.visitorInfo(),J=S&&S.visitInfo();switch(E){case"image":A={original:k(n.content),zoom:k(n.compressPicUrl)};break;case"text":A=WeixinEmojiExtend.replace(m.checkUrl(n.content));break;case"msgFromCustomAskForCallFail":A="客户要求与你进行语音电话失败",E="text";break;case"msgFromCustomAskForVideoFail":A="客户要求与你进行视频电话失败",E="text";break;case"file":case"voice":case"video":A=k(n.content),"file"==E&&/\.(mp4|MP4|OGG|ogg|WEBM|webm)$/.test(n.content)&&(E="video");break;case"msgFromDmsNewCustomInter":var T=JSON.parse(n.content),I=T.cad;i.Log("log","新用户到来随路数据info:"+n.content),m.isShareMessage(I.isShareMessage),C=T.isTransfer,_=!0,S.online(!0),S.webrtcNum(I.webrtcNum),S.chatBoxType("custom-chat"),WebAgent.sipUseWebRTC?(S.serviceVideo(("true"==I.supportVideo||!1)&&m.webRTCVideo),S.serviceAduio(("true"==I.supportVoice||!1)&&m.webRTCAduio)):(i.Log("log","chpone开启摄像头和音频"),S.serviceVideo("true"==I.supportVideo||!1),S.serviceAduio("true"==I.supportVoice||!1)),S.isNewUser(!0),S.skillGroupId(T.groupId),S.skillName=T.groupName,E="text",S.timeOut1&&S.timeOut2||(S.timeOut1=m.timeOut()&&m.timeOut().agentFirstTimeout,S.timeOut2=m.timeOut()&&m.timeOut().agentSecondTimeout);var N=m.currentUser();switch(S.name==N.name&&S.ent==N.ent&&S.channel==N.channel&&m.currentUser(new o),I&&I.previousImSessionId?(S.sessionId=I.previousImSessionId,S.historySessionId=I.previousImSessionId):(S.sessionId=T.sessionId,S.historySessionId=T.sessionId),C){case 0:c(S,function(n){r(n)});break;case 1:c(S,function(){r()})}var D={userId:S.name,userSource:I&&I.source,skillGroupId:T.groupId,skillGroupName:T.groupName,isTransfer:T.isTransfer,transferMessage:T.transferMessage,sessionId:T.sessionId,cesssionId:m.agentEntId()+":"+S.channel+":"+S.name,channel:S.channel,attachment:T.attachment};J.sessionAntecedents(T.sessionAntecedents),J.geoLocation(T.geoLocation),J.ipAddress(T.ipAddress),J.browserType(T.browserType),J.operatingSystem(T.operatingSystem),s.newCustomInter(D),m.setChatSoundTip()&&m.setChatSoundTip().onlineTip&&setTimeout(function(){document.getElementById("chat_online_tip").play()},100),S.resource=t,S.changeSessionTime("open");break;case"msgFromCustomSessionQuit":S.kickOff(),m.isShowCommonWordDialog(!1),S.addMessage("对方结束了会话","tip","text",new Date),m.emojiPaneDis(!1),s.sessionQuit({userId:S.name,messages:S.messages()}),S.changeSessionTime("close"),"custom-group"==S.chatBoxType()&&m.keepChatTip({keepchatTipShow:!0,beInvitedAgentId:S.beInvited[0].agentId});break;case"visitorInformation":var T=JSON.parse(n.content);j.workOrderName(T.workOrderName&&T.workOrderName.substring(0,10)),j.workOrderEmail(T.workOrderEmail),j.workOrderPhone(T.workOrderPhone);break;case"msgFromDmsSetStateFreeSuccsess":return WebAgent.readyEnabled=!0,s.readyCallback(),void(this.isMaxTalkUpSetBusy()&&this.maxTalkNum()<=this.onlineArr().length&&WebAgent.readyEnabled&&WebAgent.extend.setBusy());case"msgFromDmsSetStateBusySuccess":return WebAgent.readyEnabled=!1,void s.busyCallback();case"msgFromDmsGetOnlineAgentListResponse":var R=JSON.parse(n.content);m.agentLists(u(R.agentsList)),m.agentListsLength(R.agentsNum-1);break;case"msgFromDmsGetAgentListResponse":var R=JSON.parse(n.content);m.agentReadyLists=u(R),m.agentEabledSelectLists(d("","custom-chat"==m.currentUser().chatBoxType()));break;case"msgFromDmsTransferAgentSuccess":S=p("",f,b,v),S.kickOff(),S.name==m.currentUser().name&&m.currentUser().kickOff(),m.sendMessage("tip","","","该会话已经转接给客服"+m.hasSelectedAgents()[0].agentName,S);break;case"msgFromDmsAgentLoginSuccess":var L=JSON.parse(n.content),M=L.agentTimeout&&L.agentTimeout.agentFirstTimeout,B=L.agentTimeout&&L.agentTimeout.agentSecondTimeout;m.isMaxTalkUpSetBusy(2==L.agentAutoStatus),m.maxTalkNum(L.webChatCount),m.webRTCVideo="1"==L.availableVideo||!1,m.timeOut({agentFirstTimeout:60*M||180,agentSecondTimeout:60*B||300}),m.username(L.agentName),i.Log("info","坐席登录成功后，设置的超时未回复时间agentFirstTimeout:"+M+",agentSecondTimeout:"+B);break;case"msgAck":
for(var n=JSON.parse(n.content),O=-1,U=0;U<x.length;U++)if("text"==n.msgType&&x[U].type==n.msgType&&x[U].username==f&&decodeURI(x[U].content).trim()==n.msgContent.trim()||("image"==n.msgType||"file"==n.msgType)&&x[U].username==f){x[U].setTimeFun(!0),O=U;break}-1!=O&&x.splice(O,1);break;case"msgFromCustomAskForCall":console.log("webrtcNum:",n.webrtcNum),WebAgent.vm.callEnabled()||WebAgent.vm.busyEnabled()?(S.webrtcNum(n.webrtcNum),S.chatType("audio"),m.callInUser(S),s.callIn({name:f,type:"audio"})):m.sendMessage("msgFromAgentRefuseCall","","","",S);break;case"msgFromCustomAskForVideo":WebAgent.vm.callEnabled()||WebAgent.vm.busyEnabled()?(S.webrtcNum(n.webrtcNum),S.chatType("video"),m.callInUser(S),s.callIn({name:f,type:"video"})):m.sendMessage("msgFromAgentRefuseVideo","","","",S);break;case"msgFromCustomMessageWithdraw":return void m.withdrawBtn(n.content,"recv",S)}A&&(_||S.addMessage(A,"recv",E,new Date,S.nickName()?S.nickName():S.name.substring(0,10),n.messageId),m.openIntellHelp()&&"text"==E&&a("VmSmartReply").searchReply(A,0,S),f!=(m.currentUser()&&m.currentUser().name)&&S.msgNumber(S.msgNumber()+1),m.setChatSoundTip()&&m.setChatSoundTip().msgTip&&setTimeout(function(){document.getElementById("chat_msg_tip").play()},100))}},this.kickoffUser=function(){"custom-chat"==m.currentUser().chatBoxType()?m.sendMessage("msgFromAgentkickCustom"):a("Login").sendMUC(m.currentUser().sessionId,{type:"msgFromAgentQuitMUC"})},this.callInTip=e.observable(!1),this.callInUser=e.observable(new o),WebAgent.refusedCallIn=function(){"video"==m.callInUser().chatType()?m.sendMessage("msgFromAgentRefuseVideo","","","",m.callInUser()):m.sendMessage("msgFromAgentRefuseCall","","","",m.callInUser()),m.callInUser().chatType("chat")},this.makeCallAudio=h.bind(h,"audioCallOut"),this.makeCallVideo=h.bind(h,"videoCallOut"),WebAgent.imMakeCall=function(){h("callIn")},this.callEnd=function(n){m.callInUser()&&m.callInUser().isCalling?m.callInUser().isCalling=!1:m.currentUser()&&m.currentUser().isCalling&&(m.currentUser().isCalling=!1),m.sendState("msgFromAgentCallEnd","msgFromAgentCallEnd","PC",{content:{number:n}})},this.requestEvaluate=function(){m.currentUser().isSendEvalRequestBtnShow()&&(m.sendMessage("msgFromAgentSatisfySend"),m.currentUser().hasSendEvalRequest(!1),m.currentUser().addMessage("已经向客户发起评价请求","tip","text",new Date))},this.previewImg=function(n){r.show(n.text.original)},this.palyVideo=function(e,t){var i=e.text.split("/");i.splice(3,0,"play");var o=i.join("/"),a="<video width='400' height='300'  controls autoplay id='videoShow'><source src='"+o+"' type='video/mp4'/><source src='"+o+"' data-bind='attr: {src: onlineVideo}' type='video/webm'/><source src='"+o+"' data-bind='attr: {src: onlineVideo}' type='video/ogg'/></video>";n("#videoPlay").html(a),n(t.currentTarget).parent(".videoImg").addClass("showLoading"),n(".showLoading .video-loader-box").show(),document.getElementById("videoShow").addEventListener("canplaythrough",function(){m.videoPlace(!0),n(".video-loader-box").hide(),n(t.currentTarget).parent(".videoImg").removeClass("showLoading")})},this.closeVideo=function(){m.videoPlace(!1),n("#videoPlay").html("")},this.kchartCreate=function(){var n=m.currentUser(),e=n.visitorInfo();if(!e.workOrderEmail())return void alert("此访客未填写邮箱地址，无法创建工单！");var t={title:"来自"+e.workOrderName()+"的聊天对话",content:n.messages(),issue:n.messages(),customServiceName:m.username(),creatorId:n.name,creatorName:e.workOrderName(),creatorEmail:e.workOrderEmail(),email:e.workOrderEmail(),telphone:e.workOrderPhone()};return s.kchartCreate(t),!0}}}),define("Vm",["ViewModel"],function(n){return new n}),define("ViewModelQuickReply",["jquery","knockout","User","require","util","Vm"],function(n,e,t,i,o,a){"use strict";function r(n,t,i,o,a){this.id=n,this.name=t,this.selected=e.observable(i),this.type=o,this.typeGrop=e.observable(a)}function s(n,e,t){o.ajaxHelper.post(WebAgent.config.quickSmartReplyPath_sensitive+n,e,t)}return function(){var t=this;this.Title={1:"新增常用语分组",2:"编辑常用语分组",3:"新增常用语内容",4:"编辑常用语内容"},this.operateTip=e.observable(),this.quickReplySearchTxt=e.observable(),this.selectedGgroup=e.observable(),this.searchedContentList=e.observableArray([]),this.searchType=e.observable("commonSearch"),this.commLangContent=e.observable(""),this.quickReplyDis=e.observable(!0),this.deleteConfirmDis=e.observable(!1),this.commCreateDis=e.observable(!1),this.currentTitleKey=e.observable(),this.currentTitle=e.observable(),this.commSetTitle=e.computed(function(){return t.currentTitle(t.Title[t.currentTitleKey()]),!0},this),this.comLangGgroupList=e.observableArray([]),this.comLangContentList=e.observableArray([]),this.searchResultTip=e.observable(!1),this.loadQuickReplyModel=function(){t.quickReplyDis(!0),t.refreshList()},this.searchComLang=function(n){var e;t.searchType(n),"commonSearch"==n&&(e=t.quickReplySearchTxt()),"autoMatch"==n&&(e=a.inputText());var o={entId:a.agentEntId(),agentId:a.agentId(),content:e},r=function(e){0==e.code&&(e.obj.length>0?("autoMatch"==n&&i("RegisterEvent").autoMatchCallback(),t.searchedContentList([]),t.searchedContentList(e.obj)):0==t.searchedContentList().length&&t.searchResultTip(!0))};e.trim().length>1&&s("/commonphrase/PAndSlistForSearch",o,r),""==e&&(t.searchedContentList([]),t.searchResultTip(!1))},this.searchResultShow=e.computed(function(){return t.searchResultTip()||t.searchedContentList().length>0},this),this.handleSearchedContent=function(e){var t=e.name||e.sentenceDto.content;a.currentUser().online()?(a.inputText(t),vm.openAutoMatch()?n(".message-input").focus():a.checkWord()):o.Log("info","用户当前处于离线状态")},this.refreshList=function(){t.getGroupListForAgent(),t.quickReplySearchTxt(""),t.searchedContentList([]),t.searchResultTip(!1)},this.handleSetting=function(){var n=t.comLangGgroupList();t.quickReplyDis(!1),t.selectedGgroup(null),t.cacheValue(null),t.searchedContentList([]),t.quickReplySearchTxt(""),t.searchResultTip(!1),t.comLangContentList([]),n=n.filter(function(n,e,t){return!n.typeGrop()}),n=n.map(function(n,e){return n.selected(!1)}),t.comLangGgroupList(n),n.length&&t.getContentListForAgent(n[0].id)},this.getGroupListForAgent=function(){var n={entId:a.agentEntId(),agentId:a.agentId()},e=function(n){if(t.comLangGgroupList([]),0==n.code){var e,i;null!=t.selectedGgroup()&&(i=t.selectedGgroup().id),n.obj.forEach(function(n,o){e=n.id==i?new r(n.id,n.groupName,!0,"group"):new r(n.id,n.groupName,!1,"group"),t.comLangGgroupList.push(e)})}},i=function(n){if(t.comLangGgroupList([]),0==n.code){var e,i,o,a;n.obj.length&&(n.obj.forEach(function(n,s){o="0"==n.type,0==s?(a=o,i=n.group.id,e=new r(n.group.id,n.group.groupName,!0,"group",o)):e=new r(n.group.id,n.group.groupName,!1,"group",o),t.comLangGgroupList.push(e)}),t.getContentListForAgent(i,a))}};t.quickReplyDis()?s("/commonphrasegroup/commonAndAgentlist",n,i):s("/group/listForAgent",n,e)},this.getContentListForAgent=function(n,e){t.comLangContentList([]);var i={entId:a.agentEntId(),agentId:a.agentId(),gid:n},o=function(n){0==n.code&&n.obj.forEach(function(n,e){var i=new r(n.id,n.content,!1,"content");t.comLangContentList.push(i)})};e?s("/commonphrase/listByGid",i,o):s("/sentence/listByGid",i,o)},this.switchComLangGgroup=function(n){var e=t.comLangGgroupList();e=e.map(function(n,e){return n.selected(!1)}),t.comLangGgroupList(e),n.selected(!0),t.selectedGgroup(n),t.cacheValue(n),t.getContentListForAgent(n.id,n.typeGrop())},this.cacheValue=e.observable(null),this.handleCacheValue=function(n){var e=t.comLangContentList();e=e.map(function(n,e){return n.selected(!1)}),t.comLangContentList(e),n.selected(!0),t.cacheValue(n)},this.createCommLangG=function(){t.commCreateDis(!0),t.currentTitleKey(1)},this.createCommLangC=function(){t.commCreateDis(!0),t.currentTitleKey(3)},this.handleEdit=function(){"group"==t.cacheValue().type?t.currentTitleKey(2):t.currentTitleKey(4),t.commCreateDis(!0),t.commLangContent(t.cacheValue().name)},this.handleDelete=function(){t.deleteConfirmDis(!0)},this.handleReturn=function(){t.quickReplyDis(!0)},this.confirmDelete=function(){var n=t.cacheValue().id,e=t.selectedGgroup().id,i=null,o={entId:a.agentEntId(),agentId:a.agentId(),id:n};i="group"==t.cacheValue().type?"/group/remove":"/sentence/remove",s(i,o,function(n){t.deleteConfirmDis(!1),0==n.code&&("group"==t.cacheValue().type?(t.getGroupListForAgent(),t.comLangContentList([]),t.cacheValue(null)):(t.getContentListForAgent(e),t.cacheValue(null)))})},this.handleCancel=function(){t.commCreateDis(!1),t.commLangContent(""),t.deleteConfirmDis(!1)};var c="";this.handleSave=function(){var e=t.commLangContent().trim(),i=t.currentTitleKey(),o=null,r=null,u=function(n){0==n.code?(t.commCreateDis(!1),t.commLangContent(""),1==i||2==i?t.getGroupListForAgent():3!=i&&4!=i||t.getContentListForAgent(t.selectedGgroup().id)):(t.operateTip(n.desc),setTimeout(function(){t.operateTip(null)},2e3))};switch(i){case 1:o="/group/save",r={entId:a.agentEntId(),agentId:a.agentId(),groupName:e};break;case 2:o="/group/update",r={entId:a.agentEntId(),agentId:a.agentId(),id:t.selectedGgroup().id,groupName:e};break;case 3:o="/sentence/save",r={entId:a.agentEntId(),agentId:a.agentId(),gid:t.selectedGgroup().id,content:e};break;case 4:o="/sentence/update",r={entId:a.agentEntId(),agentId:a.agentId(),gid:t.selectedGgroup().id,id:t.cacheValue().id,content:e}}s(o,r,u),n("#handleSave").unbind("click"),c=setTimeout(function(){n("#handleSave").click(t.handleSave)},3e3)},this.downLoadUrl=WebAgent.config.quickSmartReplyPath_sensitive+"/template/sentence/SentenceAdd.xlsx",this.handleExport=function(){var n=WebAgent.config.quickSmartReplyPath_sensitive+"/sentence/exportSentence?entId="+a.agentEntId()+"&agentId="+a.agentId();window.open(n)}}}),define("VmQuickReply",["ViewModelQuickReply"],function(n){return new n}),define("ViewModelSmartReply",["jquery","knockout","User","require","util","Vm"],function(n,e,t,i,o,a){"use strict";return function(){var n=this;this.smartReplySearchTxt=e.observable(""),this.smartReply=e.observableArray([]),this.smartContent=e.observable(!1),this.smartTip=e.observable("暂无内容"),this.photoName=e.observable(1),this.searchReply=function(e,t,a){t=0==t?0:1,e="string"==typeof e?e:n.smartReplySearchTxt();var r={question:e,resultType:t,entId:i("Vm").agentEntId()};1==t&&n.smartReplySearchTxt(e);var s=function(e){"0"==e.code&&"1"==e.obj.answerType?1==t?(n.smartReply(e.obj.msg4TextResult),n.smartContent(!0)):n.sendSmartReply(e.obj.msg4TextResult[0],a):(1==t&&(n.photoName(-1),n.smartTip("你的问题我还无法回答，请完善我的知识库"),n.smartContent(!1)),console.log("[webAgent-smartReply]:","0"==e.code?"未找到答案":e.desc))};o.ajaxHelper.post(WebAgent.config.quickSmartReplyPath_sensitive+"/intelligentQuery/query",r,s)},this.reflash=function(){n.photoName(1),n.smartReply([]),n.smartReplySearchTxt(""),n.smartContent(!1),n.smartTip("暂无内容")},this.sendSmartReply=function(n,e){e=e.ent?e:a.currentUser(),e.online()?a.sendMessage("text","","",n.answer,e,!0):o.Log("warm","用户当前处于离线状态")}}}),define("VmSmartReply",["ViewModelSmartReply"],function(n){return new n}),JSJAC_HAVEKEYS=!0,JSJAC_NKEYS=16,JSJAC_INACTIVITY=300,JSJAC_ERR_COUNT=10,JSJAC_ALLOW_PLAIN=!0,JSJAC_ALLOW_SCRAM=!1,JSJAC_CHECKQUEUEINTERVAL=100,JSJAC_CHECKINQUEUEINTERVAL=100,JSJAC_TIMERVAL=2e3,JSJAC_RETRYDELAY=5e3,JSJAC_REGID_TIMEOUT=2e4,JSJACHBC_MAX_HOLD=1,JSJACHBC_MAX_WAIT=300,JSJACHBC_BOSH_VERSION="1.10",JSJACHBC_USE_BOSH_VER=!0,JSJACHBC_MAXPAUSE=120,JSJACPING_INTERVAL=25e3;var NS_DISCO_ITEMS="http://jabber.org/protocol/disco#items",NS_DISCO_INFO="http://jabber.org/protocol/disco#info",NS_VCARD="vcard-temp",NS_VCARD_UPDATE="vcard-temp:x:update",NS_AUTH="jabber:iq:auth",NS_AUTH_ERROR="jabber:iq:auth:error",NS_REGISTER="jabber:iq:register",NS_SEARCH="jabber:iq:search",NS_ROSTER="jabber:iq:roster",NS_PRIVACY="jabber:iq:privacy",NS_PRIVATE="jabber:iq:private",NS_VERSION="jabber:iq:version",NS_TIME="jabber:iq:time",NS_TIME_NEW="urn:xmpp:time",NS_LAST="jabber:iq:last",NS_XDATA="jabber:x:data",NS_IQDATA="jabber:iq:data",NS_DELAY="jabber:x:delay",NS_DELAY_NEW="urn:xmpp:delay",NS_EXPIRE="jabber:x:expire",NS_EVENT="jabber:x:event",NS_XCONFERENCE="jabber:x:conference",NS_PING="urn:xmpp:ping",NS_BOOKSMARKS="storage:bookmarks",NS_FORWARD_0="urn:xmpp:forward:0",NS_CARBONS_2="urn:xmpp:carbons:2",NS_CHAT_STATES="http://jabber.org/protocol/chatstates",NS_STATS="http://jabber.org/protocol/stats",NS_MUC="http://jabber.org/protocol/muc",NS_MUC_USER="http://jabber.org/protocol/muc#user",NS_MUC_ADMIN="http://jabber.org/protocol/muc#admin",NS_MUC_OWNER="http://jabber.org/protocol/muc#owner",NS_PUBSUB="http://jabber.org/protocol/pubsub",NS_PUBSUB_EVENT="http://jabber.org/protocol/pubsub#event",NS_PUBSUB_OWNER="http://jabber.org/protocol/pubsub#owner",NS_PUBSUB_ERRORS="http://jabber.org/protocol/pubsub#errors",NS_PUBSUB_NMI="http://jabber.org/protocol/pubsub#node-meta-info",NS_COMMANDS="http://jabber.org/protocol/commands",NS_CAPS="http://jabber.org/protocol/caps",NS_STREAM="http://etherx.jabber.org/streams",NS_FRAMING="urn:ietf:params:xml:ns:xmpp-framing",NS_CLIENT="jabber:client",NS_BOSH="http://jabber.org/protocol/httpbind",NS_XBOSH="urn:xmpp:xbosh",NS_STANZAS="urn:ietf:params:xml:ns:xmpp-stanzas",NS_STREAMS="urn:ietf:params:xml:ns:xmpp-streams",NS_TLS="urn:ietf:params:xml:ns:xmpp-tls",NS_SASL="urn:ietf:params:xml:ns:xmpp-sasl",NS_SESSION="urn:ietf:params:xml:ns:xmpp-session",NS_BIND="urn:ietf:params:xml:ns:xmpp-bind",NS_FEATURE_IQAUTH="http://jabber.org/features/iq-auth",NS_FEATURE_IQREGISTER="http://jabber.org/features/iq-register",NS_FEATURE_COMPRESS="http://jabber.org/features/compress",NS_COMPRESS="http://jabber.org/protocol/compress",ERR_BAD_REQUEST=STANZA_ERROR("400","modify","bad-request"),ERR_CONFLICT=STANZA_ERROR("409","cancel","conflict"),ERR_FEATURE_NOT_IMPLEMENTED=STANZA_ERROR("501","cancel","feature-not-implemented"),ERR_FORBIDDEN=STANZA_ERROR("403","auth","forbidden"),ERR_GONE=STANZA_ERROR("302","modify","gone"),ERR_INTERNAL_SERVER_ERROR=STANZA_ERROR("500","wait","internal-server-error"),ERR_ITEM_NOT_FOUND=STANZA_ERROR("404","cancel","item-not-found"),ERR_JID_MALFORMED=STANZA_ERROR("400","modify","jid-malformed"),ERR_NOT_ACCEPTABLE=STANZA_ERROR("406","modify","not-acceptable"),ERR_NOT_ALLOWED=STANZA_ERROR("405","cancel","not-allowed"),ERR_NOT_AUTHORIZED=STANZA_ERROR("401","auth","not-authorized"),ERR_PAYMENT_REQUIRED=STANZA_ERROR("402","auth","payment-required"),ERR_RECIPIENT_UNAVAILABLE=STANZA_ERROR("404","wait","recipient-unavailable"),ERR_REDIRECT=STANZA_ERROR("302","modify","redirect"),ERR_REGISTRATION_REQUIRED=STANZA_ERROR("407","auth","registration-required"),ERR_REMOTE_SERVER_NOT_FOUND=STANZA_ERROR("404","cancel","remote-server-not-found"),ERR_REMOTE_SERVER_TIMEOUT=STANZA_ERROR("504","wait","remote-server-timeout"),ERR_RESOURCE_CONSTRAINT=STANZA_ERROR("500","wait","resource-constraint"),ERR_SERVICE_UNAVAILABLE=STANZA_ERROR("503","cancel","service-unavailable"),ERR_SUBSCRIPTION_REQUIRED=STANZA_ERROR("407","auth","subscription-required"),ERR_UNEXPECTED_REQUEST=STANZA_ERROR("400","wait","unexpected-request"),hexcase=0,b64pad="=";"undefined"!=typeof atob&&"undefined"!=typeof btoa||b64arrays(),"undefined"==typeof atob?(b64decode=function(n){return utf8d2t(b64t2d(n))},b64decode_bin=function(n){for(var e=b64t2d(n),t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}):(b64decode=function(n){return decodeURIComponent(escape(atob(n)))},b64decode_bin=atob),"undefined"==typeof btoa?b64encode=function(n){return b64d2t(utf8t2d(n))}:b64encode=function(n){return btoa(unescape(encodeURIComponent(n)))},XmlHttp.create=function(){try{if(window.XMLHttpRequest){var n=new XMLHttpRequest;return null===n.readyState&&(n.readyState=1,n.addEventListener("load",function(){n.readyState=4,"function"==typeof n.onreadystatechange&&n.onreadystatechange()},!1)),n}if(window.ActiveXObject)return new ActiveXObject(XmlHttp.getPrefix()+".XmlHttp")}catch(n){}throw new Error("Your browser does not support XmlHttp objects")},XmlHttp.getPrefix=function(){if(XmlHttp.prefix)return XmlHttp.prefix;for(var n=["MSXML2","Microsoft","MSXML","MSXML3"],e=0;e<n.length;e++)try{return new ActiveXObject(n[e]+".XmlHttp"),XmlHttp.prefix=n[e]}catch(n){}throw new Error("Could not find an installed XML parser")},XmlDocument.create=function(n,e){n=n||"foo",e=e||"";try{var t;if(document.implementation&&document.implementation.createDocument?(t=document.implementation.createDocument(e,n,null),null===t.readyState&&(t.readyState=1,t.addEventListener("load",function(){t.readyState=4,"function"==typeof t.onreadystatechange&&t.onreadystatechange()},!1))):window.ActiveXObject&&(t=new ActiveXObject(XmlDocument.getPrefix()+".DomDocument")),!t.documentElement||t.documentElement.tagName!=n||t.documentElement.namespaceURI&&t.documentElement.namespaceURI!=e)try{""!==e?t.appendChild(t.createElement(n)).setAttribute("xmlns",e):t.appendChild(t.createElement(n))}catch(i){t=document.implementation.createDocument(e,n,null),null===t.documentElement&&t.appendChild(t.createElement(n)),""!==e&&t.documentElement.getAttribute("xmlns")!=e&&t.documentElement.setAttribute("xmlns",e)}return t}catch(n){}throw new Error("Your browser does not support XmlDocument objects")},XmlDocument.getPrefix=function(){if(XmlDocument.prefix)return XmlDocument.prefix;for(var n=["MSXML2","Microsoft","MSXML","MSXML3"],e=0;e<n.length;e++)try{return new ActiveXObject(n[e]+".DomDocument"),XmlDocument.prefix=n[e]}catch(n){}throw new Error("Could not find an installed XML parser")},"undefined"!=typeof Document&&window.DOMParser&&(Document.prototype.loadXML=function(n){for(var e=(new DOMParser).parseFromString(n,"text/xml");this.hasChildNodes();)this.removeChild(this.lastChild);for(var t=0;t<e.childNodes.length;t++)this.appendChild(this.importNode(e.childNodes[t],!0))}),window.XMLSerializer&&window.Node&&Node.prototype&&Node.prototype.__defineGetter__&&(XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)})),window.XDomainRequest&&(window.ieXDRToXHR=function(n){var e=n.XMLHttpRequest;n.XMLHttpRequest=function(){this.onreadystatechange=Object,this.xhr=null,this.xdr=null,this.readyState=0,this.status="",this.statusText=null,this.responseText=null,this.getResponseHeader=null,this.getAllResponseHeaders=null,this.setRequestHeader=null,this.abort=null,this.send=null,this.isxdr=!1;var n=this;n.xdrLoadedBinded=function(){n.xdrLoaded()},n.xdrErrorBinded=function(){n.xdrError()},n.xdrProgressBinded=function(){n.xdrProgress()},n.xhrReadyStateChangedBinded=function(){n.xhrReadyStateChanged()}},XMLHttpRequest.prototype.open=function(t,i,o,a,r){var s=document.createElement("a");s.href=i,s.hostname!=document.domain?(null===this.xdr&&(this.xdr=new n.XDomainRequest),this.isxdr=!0,this.setXDRActive(),this.xdr.open(t,i)):(null===this.xhr&&(this.xhr=new e),this.isxdr=!1,this.setXHRActive(),this.xhr.open(t,i,o,a,r))},XMLHttpRequest.prototype.xdrGetResponseHeader=function(n){return"Content-Type"===n&&this.xdr.contentType>""?this.xdr.contentType:""},XMLHttpRequest.prototype.xdrGetAllResponseHeaders=function(){return this.xdr.contentType>""?"Content-Type: "+this.xdr.contentType:""},XMLHttpRequest.prototype.xdrSetRequestHeader=function(n,e){},XMLHttpRequest.prototype.xdrLoaded=function(){if(null!==this.onreadystatechange){if(this.readyState=4,this.status=200,this.statusText="OK",this.responseText=this.xdr.responseText,n.ActiveXObject){var e=new ActiveXObject("Microsoft.XMLDOM");e.async="false",e.loadXML(this.responseText),this.responseXML=e}this.onreadystatechange()}},XMLHttpRequest.prototype.xdrError=function(){null!==this.onreadystatechange&&(this.readyState=4,this.status=0,this.statusText="",this.responseText="",this.onreadystatechange())},XMLHttpRequest.prototype.xdrProgress=function(){null!==this.onreadystatechange&&3!==this.status&&(this.readyState=3,this.status=3,this.statusText="",this.onreadystatechange())},XMLHttpRequest.prototype.finalXDRRequest=function(){var n=this.xdr;delete n.onload,delete n.onerror,delete n.onprogress},XMLHttpRequest.prototype.sendXDR=function(n){var e=this.xdr;e.onload=this.xdrLoadedBinded,e.onerror=this.xdr.ontimeout=this.xdrErrorBinded,e.onprogress=this.xdrProgressBinded,this.responseText=null,this.xdr.send(n)},XMLHttpRequest.prototype.abortXDR=function(){this.finalXDRRequest(),this.xdr.abort()},XMLHttpRequest.prototype.setXDRActive=function(){this.send=this.sendXDR,this.abort=this.abortXDR,this.getResponseHeader=this.xdrGetResponseHeader,this.getAllResponseHeaders=this.xdrGetAllResponseHeaders,this.setRequestHeader=this.xdrSetRequestHeader},XMLHttpRequest.prototype.xhrGetResponseHeader=function(n){return this.xhr.getResponseHeader(n)},XMLHttpRequest.prototype.xhrGetAllResponseHeaders=function(){return this.xhr.getAllResponseHeaders()},XMLHttpRequest.prototype.xhrSetRequestHeader=function(n,e){return this.xhr.setRequestHeader(n,e)},XMLHttpRequest.prototype.xhrReadyStateChanged=function(){if(null!==this.onreadystatechange&&this.readyState!==this.xhr.readyState){var n=this.xhr;this.readyState=n.readyState,4===this.readyState&&(this.status=n.status,this.statusText=n.statusText,this.responseText=n.responseText,this.responseXML=n.responseXML,this.responseBody=n.responseBody),this.onreadystatechange()}},XMLHttpRequest.prototype.finalXHRRequest=function(){delete this.xhr.onreadystatechange},XMLHttpRequest.prototype.abortXHR=function(){this.finalXHRRequest(),this.xhr.abort()},XMLHttpRequest.prototype.sendXHR=function(n){this.xhr.onreadystatechange=this.xhrReadyStateChangedBinded,this.xhr.send(n)},XMLHttpRequest.prototype.setXHRActive=function(){this.send=this.sendXHR,this.abort=this.abortXHR,this.getResponseHeader=this.xhrGetResponseHeader,this.getAllResponseHeaders=this.xhrGetAllResponseHeaders,this.setRequestHeader=this.xhrSetRequestHeader},n.ieXDRToXHR=void 0},window.ieXDRToXHR(window)),String.prototype.htmlEnc=function(){if(!this)return this;var n=this.replace(/&/g,"&amp;");return n=n.replace(/</g,"&lt;"),n=n.replace(/>/g,"&gt;"),n=n.replace(/\"/g,"&quot;"),n=n.replace(/\n/g,"<br />")},String.prototype.revertHtmlEnc=function(){if(!this)return this;var n=this.replace(/&amp;/gi,"&");return n=n.replace(/&lt;/gi,"<"),n=n.replace(/&gt;/gi,">"),n=n.replace(/&quot;/gi,'"'),n=n.replace(/<br( )?(\/)?>/gi,"\n")},Date.jab2date=function(n){var e=new Date(Date.UTC(n.substr(0,4),n.substr(5,2)-1,n.substr(8,2),n.substr(11,2),n.substr(14,2),n.substr(17,2)));if("Z"!=n.substr(n.length-6,1)){var t=new Date;t.setTime(0),t.setUTCHours(n.substr(n.length-5,2)),t.setUTCMinutes(n.substr(n.length-2,2)),"+"==n.substr(n.length-6,1)?e.setTime(e.getTime()-t.getTime()):"-"==n.substr(n.length-6,1)&&e.setTime(e.getTime()+t.getTime())}return e},Date.hrTime=function(n){return Date.jab2date(n).toLocaleString()},Date.prototype.jabberDate=function(){var n=function(n){return n<10?"0"+n:n},e=this.getUTCFullYear()+"-";return e+=n(this.getUTCMonth()+1)+"-",e+=n(this.getUTCDate())+"T",e+=n(this.getUTCHours())+":",e+=n(this.getUTCMinutes())+":",e+=n(this.getUTCSeconds())+"Z"},Number.max=function(n,e){return n>e?n:e},Number.min=function(n,e){return n<e?n:e};var JSJaC={Version:"1.4",require:function(n){document.write('<script type="text/javascript" src="'+n+'"><\/script>')},load:function(){var n,e=["xmlextras","jsextras","crypt","JSJaCConfig","JSJaCConstants","JSJaCCookie","JSJaCJSON","JSJaCJID","JSJaCUtils","JSJaCBuilder","JSJaCPacket","JSJaCError","JSJaCKeys","JSJaCConnection","JSJaCHttpPollingConnection","JSJaCHttpBindingConnection","JSJaCConsoleLogger","JSJaCWebSocketConnection"],t=document.getElementsByTagName("script"),i="./";for(n=0;n<t.length;n++)if(t.item(n).src&&t.item(n).src.match(/JSJaC\.js$/)){i=t.item(n).src.replace(/JSJaC.js$/,"");break}for(n=0;n<e.length;n++)this.require(i+e[n]+".js")},bind:function(n,e,t){return function(i){return n.apply(e,[i,t])}}};void 0===JSJaCConnection&&JSJaC.load();var JSJaCBuilder={buildNode:function(n,e){var t,i=arguments[4];if(arguments[2])if(JSJaCBuilder._isStringOrNumber(arguments[2])||arguments[2]instanceof Array)t=this._createElement(n,e,i),JSJaCBuilder._children(n,t,arguments[2]);else{i=arguments[2].xmlns||i,t=this._createElement(n,e,i);for(var o in arguments[2])arguments[2].hasOwnProperty(o)&&"xmlns"!=o&&t.setAttribute(o,arguments[2][o])}else t=this._createElement(n,e,i);return arguments[3]&&JSJaCBuilder._children(n,t,arguments[3],i),t},_createElement:function(n,e,t){try{if(t)return n.createElementNS(t,e)}catch(n){}var i=n.createElement(e);return t&&i.setAttribute("xmlns",t),i},_text:function(n,e){return n.createTextNode(e)},_children:function(n,e,t,i){if("object"==typeof t){for(var o in t)if(t.hasOwnProperty(o)){var a=t[o];if("object"==typeof a)if(a instanceof Array){var r=JSJaCBuilder.buildNode(n,a[0],a[1],a[2],i);e.appendChild(r)}else e.appendChild(a);else JSJaCBuilder._isStringOrNumber(a)&&e.appendChild(JSJaCBuilder._text(n,a))}}else JSJaCBuilder._isStringOrNumber(t)&&e.appendChild(JSJaCBuilder._text(n,t))},_attributes:function(n){var e=[];for(var t in n)n.hasOwnProperty(t)&&e.push(t+'="'+n[t].toString().htmlEnc()+'"');return e.join(" ")},_isStringOrNumber:function(n){return"string"==typeof n||"number"==typeof n}};JSJaCConnection.prototype.connect=function(n){this._setStatus("connecting"),this.domain=n.domain||"localhost",this.username=n.username,this.resource=n.resource,this.pass=n.password||n.pass,this.authzid=n.authzid||"",this.register=n.register,this.authhost=n.authhost||n.host||n.domain,this.authtype=n.authtype||"sasl",n.xmllang&&""!==n.xmllang?this._xmllang=n.xmllang:this._xmllang="en",n.allow_plain?this._allow_plain=n.allow_plain:this._allow_plain=JSJAC_ALLOW_PLAIN,n.allow_scram?this._allow_scram=n.allow_scram:this._allow_scram=JSJAC_ALLOW_SCRAM,this.host=n.host,this.port=n.port||5222,this.jid=this.username+"@"+this.domain,this.fulljid=this.jid+"/"+this.resource,this._rid=Math.round(100000.5+799999.99999*Math.random());var e=this._getFreeSlot();this._req[e]=this._setupRequest(!0);var t=this._getInitialRequestString();this.oDbg.log(t,4),this._req[e].r.onreadystatechange=JSJaC.bind(function(){var n=this._req[e].r;4==n.readyState&&(this.oDbg.log("async recv: "+n.responseText,4),this._handleInitialResponse(n))},this),void 0!==this._req[e].r.onerror&&(this._req[e].r.onerror=JSJaC.bind(function(){this.oDbg.log("XmlHttpRequest error",1)},this)),this._req[e].r.send(t)},JSJaCConnection.prototype.connected=function(){return this._connected},JSJaCConnection.prototype.disconnect=function(){if(this._setStatus("disconnecting"),this.connected()){this._connected=!1,clearInterval(this._interval),clearInterval(this._inQto),this._timeout&&clearTimeout(this._timeout);var n=this._getFreeSlot();this._req[n]=this._setupRequest(!1);var e=this._getRequestString(!1,!0);this.oDbg.log("Disconnecting: "+e,4);try{this._req[n].r.send(e)}catch(n){}this.oDbg.log("disconnected");try{JSJaCCookie.read(this._cookie_prefix+"JSJaC_State").erase()}catch(n){}this._handleEvent("ondisconnect")}},JSJaCConnection.prototype.getPollInterval=function(){return this._timerval},JSJaCConnection.prototype.registerHandler=function(n){n=n.toLowerCase();var e={handler:arguments[arguments.length-1],childName:"*",childNS:"*",type:"*"};return arguments.length>2&&(e.childName=arguments[1]),arguments.length>3&&(e.childNS=arguments[2]),arguments.length>4&&(e.type=arguments[3]),this._events[n]?this._events[n]=this._events[n].concat(e):this._events[n]=[e],this._events[n]=this._events[n].sort(function(n,e){var t=0,i=0;return"*"==n.type&&t++,"*"==n.childNS&&t++,"*"==n.childName&&t++,"*"==e.type&&i++,"*"==e.childNS&&i++,"*"==e.childName&&i++,t>i?1:t<i?-1:0}),this.oDbg.log("registered handler for event '"+n+"'",2),this},JSJaCConnection.prototype.unregisterHandler=function(n,e){if(n=n.toLowerCase(),!this._events[n])return this;for(var t=this._events[n],i=[],o=0;o<t.length;o++)t[o].handler!=e&&i.push(t[o]);return t.length!=i.length&&(this._events[n]=i,this.oDbg.log("unregistered handler for event '"+n+"'",2)),this},JSJaCConnection.prototype.registerIQGet=function(n,e,t){return this.registerHandler("iq",n,e,"get",t)},JSJaCConnection.prototype.registerIQSet=function(n,e,t){return this.registerHandler("iq",n,e,"set",t)},JSJaCConnection.prototype.resume=function(){try{var n=JSJaCCookie.read(this._cookie_prefix+"JSJaC_State").getValue();return this.oDbg.log("read cookie: "+n,2),JSJaCCookie.read(this._cookie_prefix+"JSJaC_State").erase(),this.resumeFromData(JSJaCJSON.parse(n))}catch(n){}return!1},JSJaCConnection.prototype.resumeFromData=function(n){try{for(var e in n)n.hasOwnProperty(e)&&(this[e]=n[e]);if(this._keys){this._keys2=new JSJaCKeys;for(var t=this._keys2._getSuspendVars(),i=0;i<t.length;i++)this._keys2[t[i]]=this._keys[t[i]];this._keys=this._keys2}return this._connected?(this._setStatus("resuming"),this._handleEvent("onresume"),setTimeout(JSJaC.bind(this._resume,this),this.getPollInterval()),this._interval=setInterval(JSJaC.bind(this._checkQueue,this),JSJAC_CHECKQUEUEINTERVAL),this._inQto=setInterval(JSJaC.bind(this._checkInQ,this),JSJAC_CHECKINQUEUEINTERVAL)):this._setStatus("terminated"),!0===this._connected}catch(n){return n.message?this.oDbg.log("Resume failed: "+n.message,1):this.oDbg.log("Resume failed: "+n,1),!1}},JSJaCConnection.prototype.send=function(n,e,t){return n&&n.pType?!!this.connected()&&(e&&(n.getID()||n.setID("JSJaCID_"+this._ID++),this._registerPID(n,e,t)),this._pQueue=this._pQueue.concat(n.xml()),this._handleEvent(n.pType()+"_out",n),this._handleEvent("packet_out",n),!0):(this.oDbg.log("no packet: "+n,1),!1)},JSJaCConnection.prototype.sendIQ=function(n,e,t){if(!n||"iq"!=n.pType())return!1;e=e||{};var i=e.error_handler||JSJaC.bind(function(n){this.oDbg.log(n.xml(),1)},this),o=e.result_handler||JSJaC.bind(function(n){this.oDbg.log(n.xml(),2)},this),a=function(n,e){switch(n.getType()){case"error":i(n);break;case"result":o(n,e)}};return this.send(n,a,t)},JSJaCConnection.prototype.setPollInterval=function(n){return n&&!isNaN(n)&&(this._timerval=n),this._timerval},JSJaCConnection.prototype.status=function(){return this._status},JSJaCConnection.prototype.suspend=function(){var n=this.suspendToData();try{var e=new JSJaCCookie(this._cookie_prefix+"JSJaC_State",JSJaCJSON.toString(n));this.oDbg.log("writing cookie: "+e.getValue()+"\n(length:"+e.getValue().length+")",2),e.write();var t=JSJaCCookie.get(this._cookie_prefix+"JSJaC_State");return e.getValue()==t||(this.oDbg.log("Suspend failed writing cookie.\nread: "+t,1),e.erase(),!1)}catch(n){this.oDbg.log("Failed creating cookie '"+this._cookie_prefix+"JSJaC_State': "+n.message,1)}return!1},JSJaCConnection.prototype.suspendToData=function(){clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._suspend();var n="_connected,_keys,_ID,_xmllang,_inQ,_pQueue,_regIDs,_errcnt,_inactivity,domain,username,resource,jid,fulljid,_sid,_httpbase,_timerval,_is_polling".split(",");n=n.concat(this._getSuspendVars());for(var e={},t=0;t<n.length;t++)if(this[n[t]]){var i={};if(this[n[t]]._getSuspendVars)for(var o=this[n[t]]._getSuspendVars(),a=0;a<o.length;a++)i[o[a]]=this[n[t]][o[a]];else i=this[n[t]];e[n[t]]=i}return this._connected=!1,this._setStatus("suspending"),e},JSJaCConnection.prototype._abort=function(){clearTimeout(this._timeout),clearInterval(this._inQto),clearInterval(this._interval),this._connected=!1,this._setStatus("aborted"),this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",JSJaCError("500","cancel","service-unavailable"))},JSJaCConnection.prototype._checkInQ=function(){for(var n=0;n<this._inQ.length&&n<10;n++){var e=this._inQ[0];this._inQ=this._inQ.slice(1,this._inQ.length);var t=JSJaCPacket.wrapNode(e);if(!t)return;this._handleEvent("packet_in",t),t.pType&&!this._handlePID(t)&&(this._handleEvent(t.pType()+"_in",t),this._handleEvent(t.pType(),t))}},JSJaCConnection.prototype._checkQueue=function(){return this._pQueue.length>0&&this._process(),!0},
JSJaCConnection.prototype._doAuth=function(){return this.has_sasl&&"nonsasl"==this.authtype&&this.oDbg.log("Warning: SASL present but not used",1),!(!this._doSASLAuth()&&!this._doLegacyAuth())||(this.oDbg.log("Auth failed for authtype "+this.authtype,1),this.disconnect(),!1)},JSJaCConnection.prototype._doInBandReg=function(){if("saslanon"!=this.authtype&&"anonymous"!=this.authtype){var n=new JSJaCIQ;n.setType("set"),n.setID("reg1"),n.appendNode("query",{xmlns:NS_REGISTER},[["username",this.username],["password",this.pass]]),this.send(n,this._doInBandRegDone)}},JSJaCConnection.prototype._doInBandRegDone=function(n){if(n&&"error"==n.getType())return this.oDbg.log("registration failed for "+this.username,0),void this._handleEvent("onerror",n.getChild("error"));this.oDbg.log(this.username+" registered succesfully",0),this._doAuth()},JSJaCConnection.prototype._doLegacyAuth=function(){if("nonsasl"!=this.authtype&&"anonymous"!=this.authtype)return!1;var n=new JSJaCIQ;return n.setIQ(null,"get","auth1"),n.appendNode("query",{xmlns:NS_AUTH},[["username",this.username]]),this.send(n,this._doLegacyAuth2),!0},JSJaCConnection.prototype._doLegacyAuth2=function(n){if(!n||"result"!=n.getType())return n&&"error"==n.getType()&&this._handleEvent("onerror",n.getChild("error")),void this.disconnect();var e=null!==n.getChild("digest"),t=new JSJaCIQ;t.setIQ(null,"set","auth2");var i=t.appendNode("query",{xmlns:NS_AUTH},[["username",this.username],["resource",this.resource]]);if(e)i.appendChild(t.buildNode("digest",{xmlns:NS_AUTH},hex_sha1(this.streamid+this.pass)));else{if(!this._allow_plain)return this.oDbg.log("no valid login mechanism found",1),void this.disconnect();i.appendChild(t.buildNode("password",{xmlns:NS_AUTH},this.pass))}this.send(t,this._doLegacyAuthDone)},JSJaCConnection.prototype._doLegacyAuthDone=function(n){"result"!=n.getType()?("error"==n.getType()&&this._handleEvent("onerror",n.getChild("error")),this.disconnect()):this._handleEvent("onconnect")},JSJaCConnection.prototype._doSASLAuth=function(){if("nonsasl"==this.authtype||"anonymous"==this.authtype)return!1;if("saslanon"==this.authtype){if(this.mechs.ANONYMOUS)return this.oDbg.log("SASL using mechanism 'ANONYMOUS'",2),this._sendRaw("<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='ANONYMOUS'/>",this._doSASLAuthDone);this.oDbg.log("SASL ANONYMOUS requested but not supported",1)}else{if(this._allow_scram&&this.mechs["SCRAM-SHA-1"]){this.oDbg.log("SASL using mechanism 'SCRAM-SHA-1'",2),this._clientFirstMessageBare="n="+this.username.replace(/=/g,"=3D").replace(/,/g,"=2C")+",r="+JSJaCUtils.cnonce(16);var n;n=this.authzid?"n,a="+this.authzid.replace(/=/g,"=3D").replace(/,/g,"=2C")+",":"n,,";var e=n+this._clientFirstMessageBare;return this._sendRaw("<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='SCRAM-SHA-1'>"+b64encode(e)+"</auth>",this._doSASLAuthScramSha1S1)}if(this.mechs["DIGEST-MD5"])return this.oDbg.log("SASL using mechanism 'DIGEST-MD5'",2),this._sendRaw("<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='DIGEST-MD5'/>",this._doSASLAuthDigestMd5S1);if(this._allow_plain&&this.mechs.PLAIN){this.oDbg.log("SASL using mechanism 'PLAIN'",2);var t=this.authzid+String.fromCharCode(0)+this.username+String.fromCharCode(0)+this.pass;return this.oDbg.log("authenticating with '"+t+"'",2),t=b64encode(t),this._sendRaw("<auth xmlns='urn:ietf:params:xml:ns:xmpp-sasl' mechanism='PLAIN'>"+t+"</auth>",this._doSASLAuthDone)}this.oDbg.log("No SASL mechanism applied",1),this.authtype="nonsasl"}return!1},JSJaCConnection.prototype._doSASLAuthScramSha1S1=function(n){if("challenge"!=n.nodeName)this.oDbg.log("challenge missing",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),this.disconnect();else{var e=b64decode(n.firstChild.nodeValue);this.oDbg.log("got challenge: "+e,2);var t={},i=e.split(",");for(var o in i)if(i.hasOwnProperty(o)){var a=i[o].substring(2);t[i[o].substring(0,1)]=a}for(var r,s=str2rstr_utf8(this.pass),c=b64decode_bin(t.s)+"\0\0\0",u=parseInt(t.i,10),d=0;d<u;d++)c=rstr_hmac_sha1(s,c),r=JSJaCUtils.xor(r,c);var p;p=this.authzid?"n,a="+this.authzid.replace(/=/g,"=3D").replace(/,/g,"=2C")+",":"n,,";var l="c="+b64encode(p)+",r="+t.r;this._saltedPassword=r;var g=rstr_hmac_sha1(this._saltedPassword,"Client Key"),h=rstr_sha1(g);this._authMessage=this._clientFirstMessageBare+","+e+","+l;var m=rstr_hmac_sha1(h,str2rstr_utf8(this._authMessage)),f=JSJaCUtils.xor(g,m),b=l+",p="+rstr2b64(f);this.oDbg.log("response: "+b,2),this._sendRaw("<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>"+b64encode(b)+"</response>",this._doSASLAuthScramSha1S2)}},JSJaCConnection.prototype._doSASLAuthScramSha1S2=function(n){if("success"!=n.nodeName)this.oDbg.log("auth failed",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),this.disconnect();else{var e=b64decode(n.firstChild.nodeValue);this.oDbg.log("got success: "+e,2);var t={},i=e.split(",");for(var o in i)if(i.hasOwnProperty(o)){var a=i[o].substring(2);t[i[o].substring(0,1)]=a}rstr_hmac_sha1(rstr_hmac_sha1(this._saltedPassword,"Server Key"),str2rstr_utf8(this._authMessage))!==b64decode_bin(t.v)?(this.oDbg.log("server auth failed",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),this.disconnect()):this._reInitStream(JSJaC.bind(this._doStreamBind,this))}},JSJaCConnection.prototype._doSASLAuthDigestMd5S1=function(n){if("challenge"!=n.nodeName)this.oDbg.log("challenge missing",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),this.disconnect();else{var e,t=b64decode(n.firstChild.nodeValue);if(this.oDbg.log("got challenge: "+t,2),-1===(e=t.indexOf('nonce="')))return this.oDbg.log("no valid nonce found, aborting",1),void this.disconnect();this._nonce=t.substring(e+7),this._nonce=this._nonce.substring(0,this._nonce.indexOf('"')),this.oDbg.log("nonce: "+this._nonce,2),e=t.indexOf('realm="'),-1!==e&&(this._realm=t.substring(e+7),this._realm=this._realm.substring(0,this._realm.indexOf('"'))),this._realm=this._realm||this.domain,this.oDbg.log("realm: "+this._realm,2),this._digest_uri="xmpp/"+this.domain,this._cnonce=JSJaCUtils.cnonce(14),this._nc="00000001";var i=this.username+":"+this._realm+":"+this.pass,o=rstr_md5(str2rstr_utf8(i)),a=o+":"+this._nonce+":"+this._cnonce;this.authzid&&(a=a+":"+this.authzid);var r=rstr2hex(rstr_md5(a)),s="AUTHENTICATE:"+this._digest_uri,c=hex_md5(s),u=hex_md5(r+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+c),d='username="'+this.username+'",realm="'+this._realm+'",nonce="'+this._nonce+'",cnonce="'+this._cnonce+'",nc='+this._nc+',qop=auth,digest-uri="'+this._digest_uri+'",response='+u+",charset=utf-8";this.authzid&&(d='authzid="'+this.authzid+'",'+d),this.oDbg.log("response: "+d,2),this._sendRaw("<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'>"+b64encode(d)+"</response>",this._doSASLAuthDigestMd5S2)}},JSJaCConnection.prototype._doSASLAuthDigestMd5S2=function(n){if("failure"==n.nodeName)return n.xml?this.oDbg.log("auth error: "+n.xml,1):this.oDbg.log("auth error",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),void this.disconnect();var e=b64decode(n.firstChild.nodeValue);this.oDbg.log("response: "+e,2);var t=e.substring(e.indexOf("rspauth=")+8);this.oDbg.log("rspauth: "+t,2);var i=this.username+":"+this._realm+":"+this.pass,o=rstr_md5(str2rstr_utf8(i)),a=o+":"+this._nonce+":"+this._cnonce;this.authzid&&(a=a+":"+this.authzid);var r=rstr2hex(rstr_md5(a)),s=":"+this._digest_uri,c=hex_md5(s),u=hex_md5(r+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+c);if(this.oDbg.log("rsptest: "+u,2),u!=t)return this.oDbg.log("SASL Digest-MD5: server repsonse with wrong rspauth",1),void this.disconnect();"success"==n.nodeName?this._reInitStream(JSJaC.bind(this._doStreamBind,this)):this._sendRaw("<response xmlns='urn:ietf:params:xml:ns:xmpp-sasl'/>",this._doSASLAuthDone)},JSJaCConnection.prototype._doSASLAuthDone=function(n){"success"!=n.nodeName?(this.oDbg.log("auth failed",1),this._handleEvent("onerror",JSJaCError("401","auth","not-authorized")),this.disconnect()):this._reInitStream(JSJaC.bind(this._doStreamBind,this))},JSJaCConnection.prototype._doStreamBind=function(){var n=new JSJaCIQ;n.setIQ(null,"set","bind_1"),n.appendNode("bind",{xmlns:NS_BIND},[["resource",this.resource]]),this.oDbg.log(n.xml()),this.send(n,this._doXMPPSess)},JSJaCConnection.prototype._doXMPPSess=function(n){if("result"!=n.getType()||"error"==n.getType())return this.disconnect(),void("error"==n.getType()&&this._handleEvent("onerror",n.getChild("error")));this.fulljid=n.getChildVal("jid"),this.jid=this.fulljid.substring(0,this.fulljid.lastIndexOf("/")),n=new JSJaCIQ,n.setIQ(null,"set","sess_1"),n.appendNode("session",{xmlns:NS_SESSION},[]),this.oDbg.log(n.xml()),this.send(n,this._doXMPPSessDone)},JSJaCConnection.prototype._doXMPPSessDone=function(n){if("result"!=n.getType()||"error"==n.getType())return this.disconnect(),void("error"==n.getType()&&this._handleEvent("onerror",n.getChild("error")));this._handleEvent("onconnect")},JSJaCConnection.prototype._handleEvent=function(n,e){if(n=n.toLowerCase(),this.oDbg.log("incoming event '"+n+"'",3),this._events[n]){this.oDbg.log("handling event '"+n+"'",2);for(var t=0;t<this._events[n].length;t++){var i=this._events[n][t];if("function"==typeof i.handler)if(e){if(e.pType){if(!e.getNode().hasChildNodes()&&"*"!=i.childName||e.getNode().hasChildNodes()&&!e.getChild(i.childName,i.childNS))continue;if("*"!=i.type&&e.getType()!=i.type)continue;this.oDbg.log(i.childName+"/"+i.childNS+"/"+i.type+" => match for handler "+i.handler,3)}if(i.handler(e))break}else if(i.handler())break}}},JSJaCConnection.prototype._handlePID=function(n){if(!n.getID())return!1;var e=n.getFrom()||this.jid;n.getFrom()==this.domain&&(e=this.jid);var t=n.getID();if(this._regIDs[e]&&this._regIDs[e][t]){this.oDbg.log("handling id "+t,3);var i=this._regIDs[e][t];return!1!==i.cb.call(this,n,i.arg)&&(delete this._regIDs[e][t],!0)}return this.oDbg.log("not handling id '"+t+"' from jid "+e,1),!1},JSJaCConnection.prototype._handleResponse=function(n){var e=this._parseResponse(n);if(e)for(var t=0;t<e.childNodes.length;t++)if(this._sendRawCallbacks.length){var i=this._sendRawCallbacks[0];this._sendRawCallbacks=this._sendRawCallbacks.slice(1,this._sendRawCallbacks.length),i.fn.call(this,e.childNodes.item(t),i.arg)}else this._inQ=this._inQ.concat(e.childNodes.item(t))},JSJaCConnection.prototype._parseStreamFeatures=function(n){if(!n)return this.oDbg.log("nothing to parse ... aborting",1),!1;var e,t;if(n.getElementsByTagNameNS)e=n.getElementsByTagNameNS(NS_STREAM,"error").item(0);else{var i=n.getElementsByTagName("error");for(t=0;t<i.length;t++)if(i.item(t).namespaceURI==NS_STREAM||i.item(t).getAttribute("xmlns")==NS_STREAM){e=i.item(t);break}}if(e)return this._setStatus("internal_server_error"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",JSJaCError("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),!1;this.mechs={};var o=n.getElementsByTagName("mechanisms");if(!o.length)return!1;for(this.has_sasl=!1,t=0;t<o.length;t++)if(o.item(t).getAttribute("xmlns")==NS_SASL){this.has_sasl=!0;for(var a=o.item(t).getElementsByTagName("mechanism"),r=0;r<a.length;r++)this.mechs[a.item(r).firstChild.nodeValue]=!0;break}return this.has_sasl?(this.oDbg.log("SASL detected",2),!0):(this.oDbg.log("No support for SASL detected",2),!0)},JSJaCConnection.prototype._process=function(n){if(!this.connected())return this.oDbg.log("Connection lost ...",1),void(this._interval&&clearInterval(this._interval));this.setPollInterval(n),this._timeout&&clearTimeout(this._timeout);var e=this._getFreeSlot();if(!(e<0)){if(void 0!==this._req[e]&&void 0!==this._req[e].r&&4!=this._req[e].r.readyState)return void this.oDbg.log("Slot "+e+" is not ready");if(!this.isPolling()&&0===this._pQueue.length&&this._req[(e+1)%2]&&4!=this._req[(e+1)%2].r.readyState)return void this.oDbg.log("all slots busy, standby ...",2);this.isPolling()||this.oDbg.log("Found working slot at "+e,2),this._req[e]=this._setupRequest(!0),this._req[e].r.onreadystatechange=JSJaC.bind(function(){this.connected()&&4==this._req[e].r.readyState&&(this.oDbg.log("async recv: "+this._req[e].r.responseText,4),this._handleResponse(this._req[e]),this._setStatus("processing"),this._pQueue.length?this._timeout=setTimeout(JSJaC.bind(this._process,this),100):(this.oDbg.log("scheduling next poll in "+this.getPollInterval()+" msec",4),this._timeout=setTimeout(JSJaC.bind(this._process,this),this.getPollInterval())))},this);try{this._req[e].r.onerror=JSJaC.bind(function(){if(this.connected()){if(this._errcnt++,this.oDbg.log("XmlHttpRequest error ("+this._errcnt+")",1),this._errcnt>JSJAC_ERR_COUNT)return void this._abort();this._setStatus("onerror_fallback"),setTimeout(JSJaC.bind(this._repeat,this),JSJAC_RETRYDELAY)}},this)}catch(n){}var t=this._getRequestString();void 0!==this._rid&&(this._req[e].rid=this._rid),this.oDbg.log("sending: "+t,4),this._req[e].r.send(t)}},JSJaCConnection.prototype._registerPID=function(n,e,t){this.oDbg.log("registering id for packet "+n.xml(),3);var i=n.getID();if(!i)return this.oDbg.log("id missing",1),!1;if("function"!=typeof e)return this.oDbg.log("callback is not a function",1),!1;var o=n.getTo()||this.jid;return n.getTo()==this.domain&&(o=this.jid),this._regIDs[o]||(this._regIDs[o]={}),null!=this._regIDs[o][i]?(this.oDbg.log("id already registered: "+i,1),!1):(this._regIDs[o][i]={cb:e,arg:t,ts:JSJaCUtils.now()},this.oDbg.log("registered id "+i,3),this._cleanupRegisteredPIDs(),!0)},JSJaCConnection.prototype._cleanupRegisteredPIDs=function(){var n=Date.now();for(var e in this._regIDs)if(this._regIDs.hasOwnProperty(e))for(var t in this._regIDs[e])this._regIDs[e].hasOwnProperty(t)&&this._regIDs[e][t].ts+JSJAC_REGID_TIMEOUT<n&&(this.oDbg.log("deleting registered id '"+t+"' due to timeout",1),delete this._regIDs[e][t])},JSJaCConnection.prototype._prepSendEmpty=function(n,e){return function(){e._sendEmpty(JSJaC.bind(n,e))}},JSJaCConnection.prototype._sendEmpty=function(n){var e=this._getFreeSlot();this._req[e]=this._setupRequest(!0),this._req[e].r.onreadystatechange=JSJaC.bind(function(){4==this._req[e].r.readyState&&(this.oDbg.log("async recv: "+this._req[e].r.responseText,4),n(this._req[e].r))},this),void 0!==this._req[e].r.onerror&&(this._req[e].r.onerror=JSJaC.bind(function(){this.oDbg.log("XmlHttpRequest error",1)},this));var t=this._getRequestString();this.oDbg.log("sending: "+t,4),this._req[e].r.send(t)},JSJaCConnection.prototype._sendRaw=function(n,e,t){return e&&this._sendRawCallbacks.push({fn:e,arg:t}),this._pQueue.push(n),this._process(),!0},JSJaCConnection.prototype._setStatus=function(n){n&&""!==n&&n!=this._status&&(this._status=n,this._handleEvent("onstatuschanged",n),this._handleEvent("status_changed",n))},JSJaCCookie.read=function(n){for(var e=n+"=",t=document.cookie.split(";"),i=0;i<t.length;i++){for(var o=t[i];" "==o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e))return new JSJaCCookie(n,JSJaCCookie._unescape(o.substring(e.length,o.length)))}throw new JSJaCCookieException("Cookie not found")},JSJaCCookie.get=function(n){return JSJaCCookie.read(n).getValue()},JSJaCCookie.remove=function(n){JSJaCCookie.read(n).erase()},JSJaCCookie._escape=function(n){return n.replace(/;/g,"%3AB")},JSJaCCookie._unescape=function(n){return n.replace(/%3AB/g,";")},JSJaCDebugger.prototype.log=function(n,e){},JSJaCHttpBindingConnection.prototype=new JSJaCConnection,JSJaCHttpBindingConnection.prototype.inherit=function(n){if(n.jid){var e=new JSJaCJID(n.jid);this.domain=e.getDomain(),this.username=e.getNode(),this.resource=e.getResource()}else this.domain=n.domain||"localhost",this.username=n.username,this.resource=n.resource;this._sid=n.sid,this._rid=n.rid,this._min_polling=n.polling,this._inactivity=n.inactivity,this._setHold(n.requests-1),this.setPollInterval(this._timerval),n.wait&&(this._wait=n.wait),this._connected=!0,this._handleEvent("onconnect"),this._interval=setInterval(JSJaC.bind(this._checkQueue,this),JSJAC_CHECKQUEUEINTERVAL),this._inQto=setInterval(JSJaC.bind(this._checkInQ,this),JSJAC_CHECKINQUEUEINTERVAL),this._timeout=setTimeout(JSJaC.bind(this._process,this),this.getPollInterval())},JSJaCHttpBindingConnection.prototype.setPollInterval=function(n){return n&&!isNaN(n)&&(this.isPolling()?this._min_polling&&n<1e3*this._min_polling?this._timerval=1e3*this._min_polling:this._inactivity&&n>1e3*this._inactivity?this._timerval=1e3*this._inactivity:this._timerval=n:this._timerval=100),this._timerval},JSJaCHttpBindingConnection.prototype.isPolling=function(){return 0===this._hold},JSJaCHttpBindingConnection.prototype._getFreeSlot=function(){for(var n=0;n<this._hold+1;n++)if(void 0===this._req[n]||void 0===this._req[n].r||4==this._req[n].r.readyState)return n;return-1},JSJaCHttpBindingConnection.prototype._getHold=function(){return this._hold},JSJaCHttpBindingConnection.prototype._getRequestString=function(n,e){n=n||"";var t="";if(this._rid<=this._last_rid&&void 0!==this._last_requests[this._rid])t=this._last_requests[this._rid].xml;else{for(var i="";this._pQueue.length;){i+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length)}t="<body rid='"+this._rid+"' sid='"+this._sid+"' xmlns='http://jabber.org/protocol/httpbind'",JSJAC_HAVEKEYS&&(t+=" key='"+this._keys.getKey()+"'",this._keys.lastKey()&&(this._keys=new JSJaCKeys(hex_sha1,this.oDbg),t+=" newkey='"+this._keys.getKey()+"'")),e?t+=" type='terminate'":this._reinit&&(JSJACHBC_USE_BOSH_VER&&(t+=" xml:lang='"+this._xmllang+"' xmpp:restart='true' xmlns:xmpp='urn:xmpp:xbosh' to='"+this.domain+"'"),this._reinit=!1),t+=""!==i||""!==n?">"+n+i+"</body>":"/>",this._last_requests[this._rid]={},this._last_requests[this._rid].xml=t,this._last_rid=this._rid;for(var o in this._last_requests)this._last_requests.hasOwnProperty(o)&&o<this._rid-this._hold&&delete this._last_requests[o]}return t},JSJaCHttpBindingConnection.prototype._getInitialRequestString=function(){var n="<body content='text/xml; charset=utf-8' hold='"+this._hold+"' xmlns='http://jabber.org/protocol/httpbind' to='"+this.authhost+"' wait='"+this._wait+"' rid='"+this._rid+"'";if(this.host&&this.port&&(n+=" route='xmpp:"+this.host+":"+this.port+"'"),JSJAC_HAVEKEYS){this._keys=new JSJaCKeys(hex_sha1,this.oDbg);n+=" newkey='"+this._keys.getKey()+"'"}return n+=" xml:lang='"+this._xmllang+"'",JSJACHBC_USE_BOSH_VER&&(n+=" ver='"+JSJACHBC_BOSH_VERSION+"'",n+=" xmlns:xmpp='urn:xmpp:xbosh'","sasl"!=this.authtype&&"saslanon"!=this.authtype||(n+=" xmpp:version='1.0'")),n+="/>"},JSJaCHttpBindingConnection.prototype._getStreamID=function(n){if(this.oDbg.log(n.responseText,4),!n.responseXML||!n.responseXML.documentElement)return void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"));var e=n.responseXML.documentElement;return"terminate"==e.getAttribute("type")?void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable")):(e.getAttribute("authid")&&(this.streamid=e.getAttribute("authid"),this.oDbg.log("got streamid: "+this.streamid,2)),this._parseStreamFeatures(e)?(this._timeout=setTimeout(JSJaC.bind(this._process,this),this.getPollInterval()),void(this.register?this._doInBandReg():this._doAuth())):void this._sendEmpty(JSJaC.bind(this._getStreamID,this)))},JSJaCHttpBindingConnection.prototype._getSuspendVars=function(){return"host,port,_rid,_last_rid,_wait,_min_polling,_inactivity,_hold,_last_requests,_pause".split(",")},JSJaCHttpBindingConnection.prototype._handleInitialResponse=function(n){try{this.oDbg.log(n.getAllResponseHeaders(),4),this.oDbg.log(n.responseText,4)}catch(n){this.oDbg.log("No response",4)}if(200!=n.status||!n.responseXML)return this.oDbg.log("initial response broken (status: "+n.status+")",1),void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"));var e=n.responseXML.documentElement;return e&&"body"==e.tagName&&e.namespaceURI==NS_BOSH?"terminate"==e.getAttribute("type")?(this.oDbg.log("invalid response:\n"+n.responseText,1),clearTimeout(this._timeout),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"))):(this._sid=e.getAttribute("sid"),this.oDbg.log("got sid: "+this._sid,2),e.getAttribute("polling")&&(this._min_polling=e.getAttribute("polling")),e.getAttribute("inactivity")&&(this._inactivity=e.getAttribute("inactivity")),e.getAttribute("requests")&&this._setHold(e.getAttribute("requests")-1),this.oDbg.log("set hold to "+this._getHold(),2),e.getAttribute("ver")&&(this._bosh_version=e.getAttribute("ver")),e.getAttribute("maxpause")&&(this._pause=Number.min(e.getAttribute("maxpause"),JSJACHBC_MAXPAUSE)),this.setPollInterval(this._timerval),this._connected=!0,this._inQto=setInterval(JSJaC.bind(this._checkInQ,this),JSJAC_CHECKINQUEUEINTERVAL),this._interval=setInterval(JSJaC.bind(this._checkQueue,this),JSJAC_CHECKQUEUEINTERVAL),void this._getStreamID(n)):(this.oDbg.log("no body element or incorrect body in initial response",1),void this._handleEvent("onerror",JSJaCError("500","wait","internal-service-error")))},JSJaCHttpBindingConnection.prototype._parseResponse=function(n){if(!this.connected()||!n)return null;var e=n.r;try{if(404==e.status||403==e.status)return this._abort(),null;if(200!=e.status||!e.responseXML){this._errcnt++;var t="invalid response ("+e.status+"):\n"+e.getAllResponseHeaders()+"\n"+e.responseText;return e.responseXML||(t+="\nResponse failed to parse!"),(this.oDbg.log(t,1),this._errcnt>JSJAC_ERR_COUNT)?(this._abort(),null):(this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(JSJaC.bind(this._repeat,this),this.getPollInterval())),null)}}catch(n){return this.oDbg.log("XMLHttpRequest error: status not available",1),this._errcnt++,this._errcnt>JSJAC_ERR_COUNT?this._abort():this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(JSJaC.bind(this._repeat,this),this.getPollInterval())),null}var i=e.responseXML.documentElement;if(!i||"body"!=i.tagName||i.namespaceURI!=NS_BOSH)return this.oDbg.log("invalid response:\n"+e.responseText,1),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._setStatus("internal_server_error"),this._handleEvent("onerror",JSJaCError("500","wait","internal-server-error")),null;if(void 0!==n.rid&&this._last_requests[n.rid]){if(this._last_requests[n.rid].handled)return this.oDbg.log("already handled "+n.rid,2),null;this._last_requests[n.rid].handled=!0}if("terminate"==i.getAttribute("type")){var o=i.getAttribute("condition");this.oDbg.log("session terminated:\n"+e.responseText,1),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto);try{JSJaCCookie.read(this._cookie_prefix+"JSJaC_State").erase()}catch(n){}this._connected=!1,"remote-stream-error"==o&&i.getElementsByTagName("conflict").length>0?this._setStatus("session-terminate-conflict"):this._setStatus("terminated"),null===o&&(o="session-terminate"),this._handleEvent("onerror",JSJaCError("503","cancel",o)),this.oDbg.log("Aborting remaining connections",4);for(var a=0;a<this._hold+1;a++)try{this._req[a]&&this._req[a]!=n&&this._req[a].r.abort()}catch(n){this.oDbg.log(n,1)}return this.oDbg.log("parseResponse done with terminating",3),this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),null}return this._errcnt=0,e.responseXML.documentElement},JSJaCHttpBindingConnection.prototype._reInitStream=function(n){this._reinit=!0,this._sendEmpty(this._prepReInitStreamWait(n))},JSJaCHttpBindingConnection.prototype._prepReInitStreamWait=function(n){return JSJaC.bind(function(e){this._reInitStreamWait(e,n)},this)},JSJaCHttpBindingConnection.prototype._reInitStreamWait=function(n,e){this.oDbg.log("checking for stream features");var t,i,o=n.responseXML.documentElement;if(this.oDbg.log(o),o.getElementsByTagNameNS)this.oDbg.log("checking with namespace"),(t=o.getElementsByTagNameNS(NS_STREAM,"features").item(0))&&(i=t.getElementsByTagNameNS(NS_BIND,"bind").item(0));else{var a,r,s=o.getElementsByTagName("stream:features");for(a=0,r=s.length;a<r;a++)if(s.item(a).namespaceURI==NS_STREAM||s.item(a).getAttribute("xmlns")==NS_STREAM){t=s.item(a);break}if(t)for(i=t.getElementsByTagName("bind"),a=0,r=i.length;a<r;a++)if(i.item(a).namespaceURI==NS_BIND||i.item(a).getAttribute("xmlns")==NS_BIND){i=i.item(a);break}}this.oDbg.log(t),this.oDbg.log(i),t?i?e():(this.oDbg.log("no bind feature - giving up",1),this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this._sendEmpty(this._prepReInitStreamWait(e))},JSJaCHttpBindingConnection.prototype._repeat=function(){this._rid>=this._last_rid&&(this._rid=this._last_rid-1),this._process()},JSJaCHttpBindingConnection.prototype._resume=function(){0===this._pause?this._repeat():this._process()},JSJaCHttpBindingConnection.prototype._setHold=function(n){return!n||isNaN(n)||n<0?n=0:n>JSJACHBC_MAX_HOLD&&(n=JSJACHBC_MAX_HOLD),this._hold=n,this._hold},JSJaCHttpBindingConnection.prototype._setupRequest=function(n){var e={},t=XmlHttp.create();try{t.open("POST",this._httpbase,n),t.setRequestHeader("Content-Type","text/xml; charset=utf-8")}catch(n){this.oDbg.log(n,1)}return e.r=t,this._rid++,e.rid=this._rid,e},JSJaCHttpBindingConnection.prototype._suspend=function(){if(0!==this._pause){var n=this._getFreeSlot();this._req[n]=this._setupRequest(!1);var e="<body pause='"+this._pause+"' xmlns='http://jabber.org/protocol/httpbind' sid='"+this._sid+"' rid='"+this._rid+"'";for(JSJAC_HAVEKEYS&&(e+=" key='"+this._keys.getKey()+"'",this._keys.lastKey()&&(this._keys=new JSJaCKeys(hex_sha1,this.oDbg),e+=" newkey='"+this._keys.getKey()+"'")),e+=">";this._pQueue.length;){e+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length)}e+="</body>",this.oDbg.log("Disconnecting: "+e,4),this._req[n].r.send(e)}},JSJaCHttpPollingConnection.prototype=new JSJaCConnection,JSJaCHttpPollingConnection.prototype.isPolling=function(){return!0},JSJaCHttpPollingConnection.prototype._getFreeSlot=function(){return void 0===this._req[0]||void 0===this._req[0].r||4==this._req[0].r.readyState?0:-1},JSJaCHttpPollingConnection.prototype._getInitialRequestString=function(){var n="0";if(JSJAC_HAVEKEYS){this._keys=new JSJaCKeys(b64_sha1,this.oDbg);n+=";"+this._keys.getKey()}var e=this.domain;return this.authhost&&(e=this.authhost),n+=",<stream:stream to='"+e+"' xmlns='jabber:client' xmlns:stream='http://etherx.jabber.org/streams'","sasl"!=this.authtype&&"saslanon"!=this.authtype||(n+=" version='1.0'"),n+=">"},JSJaCHttpPollingConnection.prototype._getRequestString=function(n,e){var t=this._sid;for(JSJAC_HAVEKEYS&&(t+=";"+this._keys.getKey(),this._keys.lastKey()&&(this._keys=new JSJaCKeys(b64_sha1,this.oDbg),t+=";"+this._keys.getKey())),t+=",",n&&(t+=n);this._pQueue.length;)t+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);return e&&(t+="</stream:stream>"),t},JSJaCHttpPollingConnection.prototype._getStreamID=function(){if(""===this._req[0].r.responseText)return this.oDbg.log("waiting for stream id",2),void(this._timeout=setTimeout(JSJaC.bind(this._sendEmpty,this),1e3));this.oDbg.log(this._req[0].r.responseText,4),this._req[0].r.responseText.match(/id=[\'\"]([^\'\"]+)[\'\"]/)&&(this.streamid=RegExp.$1),this.oDbg.log("got streamid: "+this.streamid,2);var n;try{var e=this._req[0].r.responseText;if(e.match(/<\/stream:stream>\s*$/)||(e+="</stream:stream>"),n=XmlDocument.create("doc"),n.loadXML(e),!this._parseStreamFeatures(n))return void(this.authtype="nonsasl")}catch(n){this.oDbg.log("loadXML: "+n.toString(),1)}this._connected=!0,this.register?this._doInBandReg():this._doAuth(),this._process(this._timerval)},JSJaCHttpPollingConnection.prototype._getSuspendVars=function(){return[]},JSJaCHttpPollingConnection.prototype._handleInitialResponse=function(){this.oDbg.log(this._req[0].r.getAllResponseHeaders(),4);var n=this._req[0].r.getResponseHeader("Set-Cookie");n=n.split(";");for(var e=0;e<n.length;e++){var t=n[e].split("=");"ID"==t[0]&&(this._sid=t[1])}this.oDbg.log("got sid: "+this._sid,2),this._connected=!0,this._interval=setInterval(JSJaC.bind(this._checkQueue,this),JSJAC_CHECKQUEUEINTERVAL),this._inQto=setInterval(JSJaC.bind(this._checkInQ,this),JSJAC_CHECKINQUEUEINTERVAL),this._getStreamID()},JSJaCHttpPollingConnection.prototype._parseResponse=function(n){var e=n.r;if(!this.connected())return null;if(200!=e.status)return this.oDbg.log("invalid response ("+e.status+"):"+e.responseText+"\n"+e.getAllResponseHeaders(),1),this._setStatus("internal_server_error"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable")),null;this.oDbg.log(e.getAllResponseHeaders(),4);var t,i=e.getResponseHeader("Set-Cookie");if(null===i)t="-1:0";else{i=i.split(";");for(var o=0;o<i.length;o++){var a=i[o].split("=");"ID"==a[0]&&(t=a[1])}}if(void 0!==t&&-1!=t.indexOf(":0")){switch(t.substring(0,t.indexOf(":0"))){case"0":this.oDbg.log("invalid response:"+e.responseText,1);break;case"-1":this.oDbg.log("Internal Server Error",1);break;case"-2":this.oDbg.log("Bad Request",1);break;case"-3":this.oDbg.log("Key Sequence Error",1)}return this._setStatus("internal_server_error"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",JSJaCError("500","wait","internal-server-error")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),null}if(!e.responseText)return null;try{var r=e.responseText.replace(/<\?xml.+\?>/,"");r.match(/<stream:stream/)&&(r+="</stream:stream>");var s=JSJaCHttpPollingConnection._parseTree("<body>"+r+"</body>");return s&&"parsererror"!=s.tagName?s:(this.oDbg.log("parsererror",1),s=JSJaCHttpPollingConnection._parseTree("<stream:stream xmlns:stream='http://etherx.jabber.org/streams'>"+e.responseText),s&&"parsererror"!=s.tagName?(this.oDbg.log("stream closed",1),s.getElementsByTagName("conflict").length>0&&this._setStatus("session-terminate-conflict"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",JSJaCError("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this.oDbg.log("parsererror:"+s,1),s)}catch(n){this.oDbg.log("parse error:"+n.message,1)}return null},JSJaCHttpPollingConnection.prototype._reInitStream=function(n){var e=this.authhost?this.authhost:this.domain;this._sendRaw("<stream:stream xmlns:stream='http://etherx.jabber.org/streams' xmlns='jabber:client' to='"+e+"' version='1.0'>",n)},JSJaCHttpPollingConnection.prototype._repeat=function(){this._resume()},JSJaCHttpPollingConnection.prototype._resume=function(){this._process(this._timerval)},JSJaCHttpPollingConnection.prototype._setupRequest=function(n){var e=XmlHttp.create();try{e.open("POST",this._httpbase,n),e.overrideMimeType&&e.overrideMimeType("text/plain; charset=utf-8"),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(n){this.oDbg.log(n,1)}var t={};return t.r=e,t},JSJaCHttpPollingConnection.prototype._suspend=function(){},JSJaCHttpPollingConnection._parseTree=function(n){try{var e=XmlDocument.create("body","foo");if(void 0!==e.loadXML)return e.loadXML(n),e.documentElement;if(window.DOMParser)return(new DOMParser).parseFromString(n,"text/xml").documentElement}catch(n){}return null};var JSJACJID_FORBIDDEN=['"'," ","&","'","/",":","<",">","@"];JSJaCJID.prototype.getBareJID=function(){return this.getNode()+"@"+this.getDomain()},
JSJaCJID.prototype.getNode=function(){return this._node},JSJaCJID.prototype.getDomain=function(){return this._domain},JSJaCJID.prototype.getResource=function(){return this._resource},JSJaCJID.prototype.setNode=function(n){return JSJaCJID._checkNodeName(n),this._node=n||"",this},JSJaCJID.prototype.setDomain=function(n){if(!n||""===n)throw new JSJaCJIDInvalidException("domain name missing");return JSJaCJID._checkNodeName(n),this._domain=n,this},JSJaCJID.prototype.setResource=function(n){return this._resource=n||"",this},JSJaCJID.prototype.toString=function(){var n="";return this.getNode()&&""!==this.getNode()&&(n=this.getNode()+"@"),n+=this.getDomain(),this.getResource()&&""!==this.getResource()&&(n+="/"+this.getResource()),n},JSJaCJID.prototype.removeResource=function(){return this.setResource()},JSJaCJID.prototype.clone=function(){return new JSJaCJID(this.toString())},JSJaCJID.prototype.isEntity=function(n){return n="string"==typeof n?new JSJaCJID(n):n.clone(),n.removeResource(),this.clone().removeResource().toString()===n.toString()},JSJaCJID._checkNodeName=function(n){if(n&&""!==n)for(var e=0;e<JSJACJID_FORBIDDEN.length;e++)if(-1!=n.indexOf(JSJACJID_FORBIDDEN[e]))throw new JSJaCJIDInvalidException("forbidden char in nodename: "+JSJACJID_FORBIDDEN[e])},JSJaCJSON.toString=function(n){var e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},t={array:function(n){var e,i,o,a,r=["["],s=n.length;for(o=0;o<s;o+=1)if(a=n[o],i=t[typeof a])try{a=i(a),"string"==typeof a&&(e&&(r[r.length]=","),r[r.length]=a,e=!0)}catch(n){}return r[r.length]="]",r.join("")},boolean:function(n){return String(n)},null:function(){return"null"},number:function(n){return isFinite(n)?String(n):"null"},object:function(n){if(n){if(n instanceof Array)return t.array(n);var e,i,o,a,r=[];r.push("{");for(o in n)if(n.hasOwnProperty(o)&&(a=n[o],i=t[typeof a]))try{a=i(a),"string"==typeof a&&(e&&(r[r.length]=","),r.push(t.string(o),":",a),e=!0)}catch(n){}return r[r.length]="}",r.join("")}return"null"},string:function(n){return/["\\\x00-\x1f]/.test(n)&&(n=n.replace(/([\x00-\x1f\\"])/g,function(n,t){var i=e[t];return i||(i=t.charCodeAt(),"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16))})),'"'+n+'"'}};switch(typeof n){case"object":return t.object(n);case"array":return t.array(n)}},JSJaCJSON.parse=function(str){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(str.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+str+")")}catch(n){return!1}};var JSJACPACKET_USE_XMLNS=!0;JSJaCPacket.prototype.pType=function(){return this.name},JSJaCPacket.prototype.getDoc=function(){return this.doc},JSJaCPacket.prototype.getNode=function(){return this.getDoc()&&this.getDoc().documentElement?this.getDoc().documentElement:null},JSJaCPacket.prototype.setTo=function(n){return n?"string"==typeof n?this.getNode().setAttribute("to",n):this.getNode().setAttribute("to",n.toString()):this.getNode().removeAttribute("to"),this},JSJaCPacket.prototype.setFrom=function(n){return n?"string"==typeof n?this.getNode().setAttribute("from",n):this.getNode().setAttribute("from",n.toString()):this.getNode().removeAttribute("from"),this},JSJaCPacket.prototype.setID=function(n){return n?this.getNode().setAttribute("id",n):this.getNode().removeAttribute("id"),this},JSJaCPacket.prototype.setType=function(n){return n?this.getNode().setAttribute("type",n):this.getNode().removeAttribute("type"),this},JSJaCPacket.prototype.setXMLLang=function(n){return n?this.getNode().setAttribute("xml:lang",n):this.getNode().removeAttribute("xml:lang"),this},JSJaCPacket.prototype.getTo=function(){return this.getNode().getAttribute("to")},JSJaCPacket.prototype.getFrom=function(){return this.getNode().getAttribute("from")},JSJaCPacket.prototype.getToJID=function(){return new JSJaCJID(this.getTo())},JSJaCPacket.prototype.getFromJID=function(){return new JSJaCJID(this.getFrom())},JSJaCPacket.prototype.getID=function(){return this.getNode().getAttribute("id")},JSJaCPacket.prototype.getType=function(){return this.getNode().getAttribute("type")},JSJaCPacket.prototype.getXMLLang=function(){return this.getNode().getAttribute("xml:lang")},JSJaCPacket.prototype.getXMLNS=function(){return this.getNode().namespaceURI||this.getNode().getAttribute("xmlns")},JSJaCPacket.prototype.getChild=function(n,e){if(!this.getNode())return null;if(n=n||"*",e=e||"*",this.getNode().getElementsByTagNameNS)return this.getNode().getElementsByTagNameNS(e,n).item(0);var t=this.getNode().getElementsByTagName(n);if("*"==e)return t.item(0);for(var i=0;i<t.length;i++)if(t.item(i).namespaceURI==e||t.item(i).getAttribute("xmlns")==e)return t.item(i);return null},JSJaCPacket.prototype.getChildVal=function(n,e){var t=this.getChild(n,e),i="";if(t&&t.hasChildNodes())for(var o=0;o<t.childNodes.length;o++)t.childNodes.item(o).nodeValue&&(i+=t.childNodes.item(o).nodeValue);return i},JSJaCPacket.prototype.clone=function(){return JSJaCPacket.wrapNode(this.getNode())},JSJaCPacket.prototype.isError=function(){return"error"==this.getType()},JSJaCPacket.prototype.errorReply=function(n){var e=this.clone();return e.setTo(this.getFrom()),e.setFrom(),e.setType("error"),e.appendNode("error",{code:n.code,type:n.type},[[n.cond,{xmlns:NS_STANZAS}]]),e},JSJaCPacket.prototype.xml="undefined"!=typeof XMLSerializer?function(){var n=(new XMLSerializer).serializeToString(this.getNode());return void 0===n&&(n=(new XMLSerializer).serializeToString(this.doc)),n}:function(){return this.getDoc().xml},JSJaCPacket.prototype._getAttribute=function(n){return this.getNode().getAttribute(n)},document.ELEMENT_NODE||(document.ELEMENT_NODE=1,document.ATTRIBUTE_NODE=2,document.TEXT_NODE=3,document.CDATA_SECTION_NODE=4,document.ENTITY_REFERENCE_NODE=5,document.ENTITY_NODE=6,document.PROCESSING_INSTRUCTION_NODE=7,document.COMMENT_NODE=8,document.DOCUMENT_NODE=9,document.DOCUMENT_TYPE_NODE=10,document.DOCUMENT_FRAGMENT_NODE=11,document.NOTATION_NODE=12),JSJaCPacket.prototype._importNode=function(n,e){switch(n.nodeType){case document.ELEMENT_NODE:var t;t=this.getDoc().createElementNS?this.getDoc().createElementNS(n.namespaceURI,n.nodeName):this.getDoc().createElement(n.nodeName);var i,o;if(n.attributes&&n.attributes.length>0)for(i=0,o=n.attributes.length;i<o;i++){var a=n.attributes.item(i);("xmlns"!=a.nodeName||null===t.getAttribute("xmlns")&&!t.namespaceURI)&&(t.setAttributeNS&&a.namespaceURI?t.setAttributeNS(a.namespaceURI,a.name,a.value):t.setAttribute(a.name,a.value))}if(e&&n.childNodes&&n.childNodes.length>0)for(i=0,o=n.childNodes.length;i<o;i++)t.appendChild(this._importNode(n.childNodes.item(i),e));return t;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:return this.getDoc().createTextNode(n.nodeValue)}},JSJaCPacket.prototype._setChildNode=function(n,e){var t=this.getChild(n),i=this.getDoc().createTextNode(e);if(t)try{t.replaceChild(i,t.firstChild)}catch(n){}else{try{t=this.getDoc().createElementNS(this.getNode().namespaceURI,n)}catch(e){t=this.getDoc().createElement(n)}this.getNode().appendChild(t),t.appendChild(i)}return t},JSJaCPacket.prototype.buildNode=function(n){return JSJaCBuilder.buildNode(this.getDoc(),n,arguments[1],arguments[2],arguments[3])},JSJaCPacket.prototype.appendNode=function(n){return"object"==typeof n?this.getNode().appendChild(n):this.getNode().appendChild(this.buildNode(n,arguments[1],arguments[2],this.getNode().namespaceURI)),this},JSJaCPresence.prototype=new JSJaCPacket,JSJaCPresence.prototype.setStatus=function(n){return this._setChildNode("status",n),this},JSJaCPresence.prototype.setShow=function(n){return"chat"!=n&&"away"!=n&&"xa"!=n&&"dnd"!=n||this._setChildNode("show",n),this},JSJaCPresence.prototype.setPriority=function(n){return this._setChildNode("priority",n),this},JSJaCPresence.prototype.setPresence=function(n,e,t){return n&&this.setShow(n),e&&this.setStatus(e),t&&this.setPriority(t),this},JSJaCPresence.prototype.getStatus=function(){return this.getChildVal("status")},JSJaCPresence.prototype.getShow=function(){return this.getChildVal("show")},JSJaCPresence.prototype.getPriority=function(){return this.getChildVal("priority")},JSJaCIQ.prototype=new JSJaCPacket,JSJaCIQ.prototype.setIQ=function(n,e,t){return n&&this.setTo(n),e&&this.setType(e),t&&this.setID(t),this},JSJaCIQ.prototype.setQuery=function(n){var e;try{e=this.getDoc().createElementNS(n,"query")}catch(t){e=this.getDoc().createElement("query"),e.setAttribute("xmlns",n)}return this.getNode().appendChild(e),e},JSJaCIQ.prototype.getQuery=function(){return this.getNode().getElementsByTagName("query").item(0)},JSJaCIQ.prototype.getQueryXMLNS=function(){return this.getQuery()?this.getQuery().namespaceURI||this.getQuery().getAttribute("xmlns"):null},JSJaCIQ.prototype.reply=function(n){var e=this.clone();if(e.setTo(this.getFrom()),e.setFrom(),e.setType("result"),n)if("string"==typeof n)e.getChild().appendChild(e.getDoc().loadXML(n));else if(n.constructor==Array)for(var t=e.getChild(),i=0;i<n.length;i++)"string"==typeof n[i]?t.appendChild(e.getDoc().loadXML(n[i])):"object"==typeof n[i]&&t.appendChild(n[i]);else"object"==typeof n&&e.getChild().appendChild(n);return e},JSJaCMessage.prototype=new JSJaCPacket,JSJaCMessage.prototype.setBody=function(n){return this._setChildNode("body",n),this},JSJaCMessage.prototype.setSubject=function(n){return this._setChildNode("subject",n),this},JSJaCMessage.prototype.setThread=function(n){return this._setChildNode("thread",n),this},JSJaCMessage.prototype.getThread=function(){return this.getChildVal("thread")},JSJaCMessage.prototype.getBody=function(){return this.getChildVal("body")},JSJaCMessage.prototype.getSubject=function(){return this.getChildVal("subject")},JSJaCPacket.wrapNode=function(n){var e=null;switch(n.nodeName.toLowerCase()){case"presence":e=new JSJaCPresence;break;case"message":e=new JSJaCMessage;break;case"iq":e=new JSJaCIQ}return e&&e.getDoc().replaceChild(e._importNode(n,!0),e.getNode()),e};var JSJaCUtils={xor:function(n,e){if(!n)return e;if(!e)return n;for(var t="",i=0;i<n.length;i++)t+=String.fromCharCode(n.charCodeAt(i)^e.charCodeAt(i));return t},cnonce:function(n){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t="",i=0;i<n;i++)t+=e.charAt(Math.round(Math.random((new Date).getTime())*(e.length-1)));return t},now:function(){return Date.now&&"function"==typeof Date.now?Date.now():(new Date).getTime()}};JSJaCWebSocketConnection.prototype=new JSJaCConnection,JSJaCWebSocketConnection.prototype._cleanupWebSocket=function(){null!==this._ws&&(this._ws.onclose=null,this._ws.onerror=null,this._ws.onopen=null,this._ws.onmessage=null,this._ws.close(),this._ws=null)},JSJaCWebSocketConnection.prototype.connect=function(n){if(this._setStatus("connecting"),this.domain=n.domain||"localhost",this.username=n.username,this.resource=n.resource,this.pass=n.password||n.pass,this.authzid=n.authzid||"",this.register=n.register,this.authhost=n.authhost||this.domain,this.authtype=n.authtype||"sasl",this.jid=this.username+"@"+this.domain,this.fulljid=this.jid+"/"+this.resource,n.allow_plain?this._allow_plain=n.allow_plain:this._allow_plain=JSJAC_ALLOW_PLAIN,n.allow_scram?this._allow_scram=n.allow_scram:this._allow_scram=JSJAC_ALLOW_SCRAM,n.xmllang&&""!==n.xmllang?this._xmllang=n.xmllang:this._xmllang="en","undefined"==typeof WebSocket)return void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"));this._ws=new WebSocket(this._httpbase,"xmpp"),this._ws.onclose=JSJaC.bind(this._onclose,this),this._ws.onerror=JSJaC.bind(this._onerror,this),this._ws.onopen=JSJaC.bind(this._onopen,this)},JSJaCWebSocketConnection.prototype._onopen=function(){var n=this._getInitialRequestString();this.oDbg.log(n,4),this._ws.onmessage=JSJaC.bind(this._handleOpenStream,this),this._ws.send(n),this.setPing(this)},JSJaCWebSocketConnection.prototype.setPing=function(n){n.pingIntervalTimer&&clearTimeout(n.pingIntervalTimer),n.pingIntervalTimer=setTimeout(function(){n._ws&&(n._ws.send("<iq type='get'><ping xmlns='urn:xmpp:ping'/></iq>"),n.setPing(n))},JSJACPING_INTERVAL)},JSJaCWebSocketConnection.prototype._handleOpenStream=function(n){var e,t;if(this.oDbg.log(n.data,4),e=n.data,!(t=this._parseXml(e)))return void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"));this.streamid=t.getAttribute("id"),this.oDbg.log("got streamid: "+this.streamid,2),this._ws.onmessage=JSJaC.bind(this._handleInitialResponse,this)},JSJaCWebSocketConnection.prototype._handleInitialResponse=function(n){var e=this._parseXml(n.data);if(!this._parseStreamFeatures(e))return void this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"));this._connected=!0,this.register?this._doInBandReg():this._doAuth()},JSJaCWebSocketConnection.prototype.disconnect=function(){this._setStatus("disconnecting"),this.connected()&&(this._connected=!1,this.oDbg.log("Disconnecting",4),this._sendRaw('<close xmlns="'+NS_FRAMING+'"/>',JSJaC.bind(this._cleanupWebSocket,this)),this.oDbg.log("Disconnected",2),this._handleEvent("ondisconnect"))},JSJaCWebSocketConnection.prototype._onclose=function(){this.oDbg.log("websocket closed",2),"disconnecting"!==this._status&&(this._connected=!1,this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable")))},JSJaCWebSocketConnection.prototype._onerror=function(){this.oDbg.log("websocket error",1),this._connected=!1,this._handleEvent("onerror",JSJaCError("503","cancel","service-unavailable"))},JSJaCWebSocketConnection.prototype._onmessage=function(n){var e,t,i;if(e=n.data,this._setStatus("processing"),e&&""!==e){if(t=this._parseXml(e),t.namespaceURI===NS_STREAM&&"error"===t.localName)return t.getElementsByTagNameNS(NS_STREAMS,"conflict").length>0&&this._setStatus("session-terminate-conflict"),this._connected=!1,void this._handleEvent("onerror",JSJaCError("503","cancel","remote-stream-error"));i=JSJaCPacket.wrapNode(t),i&&(this.oDbg.log("async recv: "+n.data,4),this._handleEvent("packet_in",i),i.pType&&!this._handlePID(i)&&(this._handleEvent(i.pType()+"_in",i),this._handleEvent(i.pType(),i)))}},JSJaCWebSocketConnection.prototype._parseXml=function(n){var e;this.oDbg.log("Parsing: "+n,4);try{if(e=XmlDocument.create("stream",NS_STREAM),0===n.lastIndexOf("<close ",0)){this.oDbg.log("session terminated",1),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto);try{JSJaCCookie.read(this._cookie_prefix+"JSJaC_State").erase()}catch(n){}return this._connected=!1,this._handleEvent("onerror",JSJaCError("503","cancel","session-terminate")),this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),null}return e.loadXML(n),e.documentElement}catch(n){this.oDbg.log("Error: "+n),this._connected=!1,this._handleEvent("onerror",JSJaCError("500","wait","internal-service-error"))}return null},JSJaCWebSocketConnection.prototype._getInitialRequestString=function(){var n;return n=this.domain,this.authhost&&(n=this.authhost),'<open xmlns="'+NS_FRAMING+'" to="'+n+'" version="1.0"/>'},JSJaCWebSocketConnection.prototype.send=function(n,e,t){if(!this.connected())return!1;if(!n||!n.pType)return this.oDbg.log("no packet: "+n,1),!1;this._ws.onmessage=JSJaC.bind(this._onmessage,this),e&&(n.getID()||n.setID("JSJaCID_"+this._ID++),this._registerPID(n,e,t));try{this._handleEvent(n.pType()+"_out",n),this._handleEvent("packet_out",n),this._ws.send(n.xml())}catch(n){return this.oDbg.log(n.toString(),1),!1}return!0},JSJaCWebSocketConnection.prototype.resume=function(){return!1},JSJaCWebSocketConnection.prototype.suspend=function(){return!1},JSJaCWebSocketConnection.prototype._doSASLAuthScramSha1S1=function(n){var e=this._parseXml(n.data);return JSJaC.bind(JSJaCConnection.prototype._doSASLAuthScramSha1S1,this)(e)},JSJaCWebSocketConnection.prototype._doSASLAuthScramSha1S2=function(n){var e=this._parseXml(n.data);return JSJaC.bind(JSJaCConnection.prototype._doSASLAuthScramSha1S2,this)(e)},JSJaCWebSocketConnection.prototype._doSASLAuthDigestMd5S1=function(n){var e=this._parseXml(n.data);return JSJaC.bind(JSJaCConnection.prototype._doSASLAuthDigestMd5S1,this)(e)},JSJaCWebSocketConnection.prototype._doSASLAuthDigestMd5S2=function(n){var e=this._parseXml(n.data);return JSJaC.bind(JSJaCConnection.prototype._doSASLAuthDigestMd5S2,this)(e)},JSJaCWebSocketConnection.prototype._doSASLAuthDone=function(n){var e=this._parseXml(n.data);return JSJaC.bind(JSJaCConnection.prototype._doSASLAuthDone,this)(e)},JSJaCWebSocketConnection.prototype._reInitStream=function(n){var e,t=this.domain;this.authhost&&(t=this.authhost),e='<open xmlns="'+NS_FRAMING+'" to="'+t+'" version="1.0"/>',this._sendRaw(e,n)},JSJaCWebSocketConnection.prototype._sendRaw=function(n,e,t){return!!this._ws&&(e&&(this._ws.onmessage=JSJaC.bind(e,this,t)),this._ws.send(n),!0)},define("jsjac",function(){}),define("Login",["jquery","jsjac","require","RegisterEvent","util","User"],function(n,e,t,i,o,a){"use strict";function r(){if(w.send(new JSJaCPresence),E)return clearTimeout(E),void(WebAgent.readyEnabled&&t("Vm").setReady());t("Vm").agentOnline(!0);var n=new JSJaCIQ;n.setType("get").setQuery("jabber:iq:roster"),w.send(n),A||(A=setInterval(function(){t("Vm").getCuAmount()},3e4)),t("Vm").getOfflineList(),o.Log("log","登入成功"),t("Vm").getIntellOpen()}function s(){S&&(t("Vm").agentOnline(!1),clearInterval(A)),o.Log("warn","disconnected后台传输数据："+JSON.stringify(arguments))}function c(n){i.loginFailCallback({type:"loginFail",error:n}),o.Log("error","error后台传输数据："+JSON.stringify(arguments)),WebAgent.isNormalError?WebAgent.isNormalError=!1:(l("reconnect"),E=setTimeout(function(){S||(i.openfireDisconnect(),S=!0)},15e3))}function u(n){var e=n.getFromJID(),t=e.toString(),a=t.split("/")[0],r=0;if(-1==Object.keys(_).indexOf(a)&&(_[a]={}),_[a][t]={type:n.getType(),show:n.getShow(),status:n.getStatus()},o.Log("log","openfire好友状态列表："+JSON.stringify(_,null,4)),a==C&&"unavailable"==_[C][t].type)for(var s in _[C]){if("unavailable"!=_[C][s].type)return;++r==Object.keys(_[C]).length&&(o.Log("info","openfire-"+a+"下线了"),v(),i.openfireDisconnect())}}function d(e){var t=e.getChild("query").innerHTML||n(e.getChild("query")).text();o.Log("log","openfire好友列表："+t),-1==Object.keys(_).indexOf(C)?(o.Log("log",C+"不在线"),v(),i.openfireDisconnect()):i.loginCallback()}function p(n){w="ws://"===y.http_base.substring(0,5)||"wss://"===y.http_base.substr(0,6)?new JSJaCWebSocketConnection({httpbase:y.http_base}):new JSJaCHttpBindingConnection({httpbase:y.http_base,oDbg:new JSJaCConsoleLogger(4)}),h(w);var e={};e.domain=y&&y.domain,e.username=y&&y.openfireUsername(),e.resource=n?"reconnect":"PC",e.pass=y&&y.password,e.register=!1,w.connect(e)}function l(e){n.ajax({url:WebAgent.config.ADD_AGENT_URL,dataType:"json",data:{username:y.entId+"_"+y.agentId},success:function(n){p(e)}})}function g(n){return t("Vm").agentOnline()?void i.loginCallback():(y={entId:n.entId,agentId:n.agentId,password:n.password,domain:WebAgent.config.HTTP_SERVER,http_base:WebAgent.config.HTTP_BASE,openfireUsername:function(){return this.entId+"_"+this.agentId}},t("Vm").agentEntId(n.entId),t("Vm").agentId(n.agentId),t("Vm").userList([]),t("Vm").currentUser(new a),l(),S=!1,!1)}function h(n){n.registerHandler("message",x),n.registerHandler("onconnect",r),n.registerHandler("ondisconnect",s),n.registerHandler("onerror",c),n.registerHandler("iq","query","jabber:iq:roster",d),n.registerHandler("presence",u)}function m(n,e,t,i,a){var r=new JSJaCMessage;if(o.Log("log","上一条数据信息："+i),_[C]&&_[C][C+"/"+a]&&"unavailable"==_[C][C+"/"+a].type)for(var s in _[C])if("unavailable"!=_[C][s].type){a=s.split("/")[1];break}r.setTo(new JSJaCJID(k+"@"+w.domain+"/"+a)),r.setBody(i);var c=document.createElementNS("http://jabber.org/protocol/nick","nick");return c.appendChild(document.createTextNode(n+":"+e+":"+t)),r.appendNode(c),w.send(r),!1}function f(n,e,t,i){var a=new JSJaCMessage;return o.Log("log","发送状态："+i),a.setTo(new JSJaCJID("cchat001@"+w.domain)),a.setBody(i),a.appendNode("nick",{xmlns:"http://jabber.org/protocol/nick"},n+":"+e+":"+t),w.send(a),!1}function b(n,e){console.log("sendMUC");var t=new JSJaCMessage;return t.setTo(new JSJaCJID("cchat001@"+w.domain)),t.setBody(JSON.stringify(e)),t.appendNode("nick",{xmlns:"http://jabber.org/protocol/nick"},"MUC:"+n),w.send(t),!1}function x(e){var i=e.getFromJID()._node,o=e.getFromJID().toString().split("/")[1];k||(k=i);var a=e.getBody().trim().replace(/\n/g,"\\\\n").replace(/\r/g,"\\\\r");a=JSON.parse(a);var r=e.getChild("nick");t("Vm").handleMessage(a,r.innerHTML||n(r).text(),o)}function v(){var n=new JSJaCPresence;n.setType("unavailable"),n.setStatus("normalLogout"),w.send(n),S=!0,w.disconnect(),s(),clearTimeout(E),E="",i.logOutCallback({type:"logOut"})}var w,k,y,E,S=!1;WebAgent.isNormalError=!1;var _={},C="cchat001@ccod",A=null;return{login:g,sendMessage:m,sendState:f,sendMUC:b,logout:v}}),define("FileUpload",["jquery","Vm","VmQuickReply","util"],function(n,e,t,i){function o(n){var t=n,o=(n.id,/msie/i.test(navigator.userAgent)&&!window.opera),u=0,d=t.value,p=new RegExp(".(jpg|png|gif|jpeg|bmp|tif|tiff|wbmp|ico|svg)$","g"),l=new RegExp(".(zip|rar|7z|doc|docx|xlsx|xls|amr|wav|mp3|txt|mp4|MP4|OGG|ogg|webm|WEBM)$","g");if(!d.match(p)&&!d.match(l)||!d.match(p)&&"webim"!=e.currentUser().channel&&"appim"!=e.currentUser().channel)return alert("该类型文件不允许发送，请重新选择"),!1;if(o&&!t.files)try{var g=t.value,h=new ActiveXObject("Scripting.FileSystemObject");if(!h.FileExists(g))return alert("附件不存在，请重新输入！"),!1;var n=h.GetFile(g);u=n.Size}catch(n){return void i.Log("error",n)}else u=t.files[0].size;var m=u/1024;if(m>5120)return alert("文件超过5M，无法发送!"),t.value="",!1;if(m<=0)return alert("文件大小不能为0!"),t.value="",!1;var f=new FormData;f.append("fileToUpload",document.getElementById("fileToUpload").files[0]);var b=new XMLHttpRequest;b.upload.addEventListener("progress",a,!1),b.addEventListener("load",r,!1),b.addEventListener("error",s,!1),b.addEventListener("abort",c,!1),b.open("post",WebAgent.config.FILE_UPLOAD_URL,!0),b.send(f)}function a(e){var t=e.position||e.loaded,i=e.totalSize||e.total;e.lengthComputable?(l=Math.round(t/i*100)+"%",n("#progressNumber").show(),n("#progressNumber").text(l)):document.getElementById("progressNumber").innerHTML="unable to compute"}function r(t){"100%"===n("#progressNumber").text()&&n("#progressNumber").hide();var i=JSON.parse(t.target.responseText);switch(i.ok.toString()){case"0":alert(i.error);break;case"1":var o=i.originalImagePath||i.originalFilePath,a=i.zoomImageUrl||"",r=a?"image":"file";e.sendMessage(r,o,a);break;case"2":alert(i.error)}}function s(n){alert("There was an error attempting to upload the file.")}function c(n){alert("The upload has been canceled by the user or the browser dropped the connection.")}function u(){l=0,n("#fileToUpload").val(""),n("#fileToUpload").trigger("click")}function d(){n("#commLangToUpload").val(""),n("#commLangToUpload").trigger("click")}function p(){var n=new FormData,o=document.getElementById("commLangToUpload").files[0];n.append("file",o);var a=new XMLHttpRequest,r=WebAgent.config.quickSmartReplyPath_sensitive+"/sentence/importSentence?entId="+e.agentEntId()+"&agentId="+e.agentId();a.open("POST",r),a.onload=function(n){var e=JSON.parse(n.target.responseText);i.Log("info",e),0==e.code?(t.operateTip(e.desc),setTimeout(function(){t.operateTip(null),t.getGroupListForAgent()},3e3)):(t.operateTip(e.desc),setTimeout(function(){t.operateTip(null)},2e3))},a.error=function(n){alert("There was an error attempting to upload the file.")},a.send(n)}var l;return{fileSelected:u,uploadFile:o,commLangSelected:d,uploadCommLang:p}}),define("ButelEvent",["RegisterEvent","Vm"],function(n,e){var t={};return t.msgFromAgentButelAlerting=function(t,i){n.getButelState({type:"msgFromAgentButelAlerting"}),t&&t.CustomId&&e.sendState("msgFromAgentButelAlerting",t.CustomId,"butel",{butelSessionId:i})},t.msgFromAgentButelConnected=function(t,i){n.getButelState({type:"msgFromAgentButelConnected"}),t&&t.CustomId&&e.sendState("msgFromAgentButelConnected",t.CustomId,"butel",{butelSessionId:i})},t.msgFromAgentButelEnd=function(t,i){n.getButelState({type:"msgFromAgentButelEnd"}),t&&t.CustomId&&e.sendState("msgFromAgentButelEnd",t.CustomId,"butel",{butelSessionId:i})},t.msgFromAgentButelAlertingAbort=function(t,i){n.getButelState({type:"msgFromAgentButelAlertingAbort"}),t&&t.CustomId&&e.sendState("msgFromAgentButelAlertingAbort",t.CustomId,"butel",{butelSessionId:i})},t.msgFromAgentButelLogin=function(e){n.getButelState({type:"msgFromAgentButelLogin",errorCode:e})},t.msgFromAgentButelLogout=function(t){n.getButelState({type:"msgFromAgentButelLogout",errorCode:t}),e.sendState("msgFromAgentButelLogout","ButelLogout","butel")},t.msgFromAgentButelLogoutFail=function(e){n.getButelState({type:"msgFromAgentButelLogoutFail",errorCode:e})},t.msgFromAgentButelLoginFail=function(e){n.getButelState({type:"msgFromAgentButelLoginFail",errorCode:e})},t}),define("text",["module"],function(n){"use strict";var e,t,i,o,a,r=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,c=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,d=u&&location.protocol&&location.protocol.replace(/\:/,""),p=u&&location.hostname,l=u&&(location.port||void 0),g={},h=n.config&&n.config()||{};return e={version:"2.0.14",strip:function(n){if(n){n=n.replace(s,"");var e=n.match(c);e&&(n=e[1])}else n="";return n},jsEscape:function(n){return n.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:h.createXhr||function(){var n,e,t;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(e=0;e<3;e+=1){t=r[e];try{n=new ActiveXObject(t)}catch(n){}if(n){r=[t];break}}return n},parseName:function(n){var e,t,i,o=!1,a=n.lastIndexOf("."),r=0===n.indexOf("./")||0===n.indexOf("../");return-1!==a&&(!r||a>1)?(e=n.substring(0,a),t=n.substring(a+1)):e=n,i=t||e,a=i.indexOf("!"),-1!==a&&(o="strip"===i.substring(a+1),i=i.substring(0,a),t?t=i:e=i),{moduleName:e,ext:t,strip:o}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(n,t,i,o){var a,r,s,c=e.xdRegExp.exec(n);return!c||(a=c[2],r=c[3],r=r.split(":"),s=r[1],r=r[0],!(a&&a!==t||r&&r.toLowerCase()!==i.toLowerCase()||(s||r)&&s!==o))},finishLoad:function(n,t,i,o){i=t?e.strip(i):i,h.isBuild&&(g[n]=i),o(i)},load:function(n,t,i,o){if(o&&o.isBuild&&!o.inlineText)return void i();h.isBuild=o&&o.isBuild;var a=e.parseName(n),r=a.moduleName+(a.ext?"."+a.ext:""),s=t.toUrl(r),c=h.useXhr||e.useXhr;if(0===s.indexOf("empty:"))return void i();!u||c(s,d,p,l)?e.get(s,function(t){e.finishLoad(n,a.strip,t,i)},function(n){i.error&&i.error(n)}):t([r],function(n){e.finishLoad(a.moduleName+"."+a.ext,a.strip,n,i)})},write:function(n,t,i,o){if(g.hasOwnProperty(t)){var a=e.jsEscape(g[t]);i.asModule(n+"!"+t,"define(function () { return '"+a+"';});\n")}},writeFile:function(n,t,i,o,a){var r=e.parseName(t),s=r.ext?"."+r.ext:"",c=r.moduleName+s,u=i.toUrl(r.moduleName+s)+".js";e.load(c,i,function(t){var i=function(n){return o(u,n)};i.asModule=function(n,e){return o.asModule(n,u,e)},e.write(n,c,i,a)},a)}},"node"===h.env||!h.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(t=require.nodeRequire("fs"),e.get=function(n,e,i){try{var o=t.readFileSync(n,"utf8");"\ufeff"===o[0]&&(o=o.substring(1)),e(o)}catch(n){i&&i(n)}}):"xhr"===h.env||!h.env&&e.createXhr()?e.get=function(n,t,i,o){var a,r=e.createXhr();if(r.open("GET",n,!0),o)for(a in o)o.hasOwnProperty(a)&&r.setRequestHeader(a.toLowerCase(),o[a]);h.onXhr&&h.onXhr(r,n),r.onreadystatechange=function(e){var o,a;4===r.readyState&&(o=r.status||0,o>399&&o<600?(a=new Error(n+" HTTP status: "+o),a.xhr=r,i&&i(a)):t(r.responseText),h.onXhrComplete&&h.onXhrComplete(r,n))},r.send(null)}:"rhino"===h.env||!h.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?e.get=function(n,e){var t,i,o=new java.io.File(n),a=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),"utf-8")),s="";try{for(t=new java.lang.StringBuffer,i=r.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&t.append(i);null!==(i=r.readLine());)t.append(a),t.append(i);s=String(t.toString())}finally{r.close()}e(s)}:("xpconnect"===h.env||!h.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,o=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),a="@mozilla.org/windows-registry-key;1"in i,e.get=function(n,e){var t,r,s,c={};a&&(n=n.replace(/\//g,"\\")),s=new FileUtils.File(n);try{t=i["@mozilla.org/network/file-input-stream;1"].createInstance(o.nsIFileInputStream),t.init(s,1,0,!1),r=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(o.nsIConverterInputStream),r.init(t,"utf-8",t.available(),o.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),r.readString(t.available(),c),r.close(),t.close(),e(c.value)}catch(n){throw new Error((s&&s.path||"")+": "+n)}}),e}),define("text!dom",[],function(){
return'<div id="chat_pane">\n\n    <div class="chat-users">\n        <div class="queue-info">\n            <span>在线客服数:<span class="queue-info-data" data-bind="text: onlineAgentNum">253</span></span>\n            <span>排队客户数:<span class="queue-info-data" data-bind="text: queueUserNum">162</span></span>\n        </div>\n        <div class="users-online">\n            <div class="chat-users-title">\n                <span>进行中对话(<span data-bind="text: onlineArr() && onlineArr().length"></span>)</span>\n                <span\n                    data-bind="css: {\'chat-users-arrow-down\': !isOnlineListShow(), \'chat-users-arrow-up\': isOnlineListShow()}, click: function(data){toggleChatList(\'online\',data, event);}"></span>\n            </div>\n            <div id="onlineChatList" data-bind="template: {name:\'userList\', foreach: onlineArr}"></div>\n        </div>\n\n        <div class="users-online">\n            <div class="chat-users-title">\n                <span>已结束对话(<span data-bind="text: offlineArr() && offlineArr().length"></span>)</span>\n                <span\n                    data-bind="css: {\'chat-users-arrow-down\': !isOfflineListShow(), \'chat-users-arrow-up\': isOfflineListShow()},click: function(data){toggleChatList(\'offline\', data, event);}"></span>\n            </div>\n            <div id="offlineChatList" data-bind="template: {name:\'userList\', foreach: offlineArr}"></div>\n        </div>\n\n        <div class="users-online">\n            <div class="chat-users-title">\n                <span>内部沟通坐席(<span data-bind="text: internalChatList() && internalChatList().length"></span>)</span>\n                <span\n                    data-bind="css: {\'chat-users-arrow-down\': !isInternalChatListShow(), \'chat-users-arrow-up\': isInternalChatListShow()},click: function(data){toggleChatList(\'internalChatList\', data, event);}"></span>\n            </div>\n            <div id="internalChatList" data-bind="template: {name:\'userList\', foreach: internalChatList}"></div>\n        </div>\n\n        <div class="users-offline">\n            <div class="chat-users-title">\n                <span>坐席列表(<span data-bind="text: agentListsLength()"></span>)</span>\n                <span\n                    data-bind="css: {\'chat-users-arrow-down\': isAgentAllListShow(), \'chat-users-arrow-up\': !isAgentAllListShow()},click: function(data){toggleChatList(\'agentAllList\', data, event);}"></span>\n            </div>\n            <div id="agentAllList" data-bind="template: {name:\'agentLists\', foreach: agentLists}"></div>\n        </div>\n    </div>\n\n    <div class="chat-content-info" data-bind="visible: !userList().length || !currentUser().ent">\n        <div class="chat-tip">\n            <i class="fa fa-comment"></i>\n\n            <p>欢迎使用</p>\n        </div>\n    </div>\n\n    <div class="chat-content-info" data-bind="visible: currentUser().name">\n        <div class="chat-content">\n            \x3c!-- ko foreach: userList().concat(internalChatList()) --\x3e\n            <div class="chat-discussion"\n                data-bind="visible: $data == $root.currentUser(),css:{scrollToBottom:$data == $root.currentUser()}">\n                <div class="chatTip" data-bind="visible: hasMoreHistory">\n                    <p style="background: #fff">\n                        <a href="javascript:void(0);" style="color: #5bc1df"\n                            data-bind="click: $root.getMoreHistoryChats">查看更多消息</a>\n                    </p>\n                </div>\n                \x3c!-- ko foreach: messages --\x3e\n                <div class="chat-message">\n                    \x3c!--ko if:direction == \'recv\'||direction == \'send\'--\x3e\n                    <div data-bind="css: \'time \' + direction">\n                        <span\n                            data-bind="text: name ? name : (direction == \'recv\' ? name : $root.username)"></span>&nbsp;<span\n                        data-bind="text: time()"></span>\n                    </div>\n                    \x3c!--<img data-bind="css: \'message-avatar \' + direction" src="images/head.jpg" alt="">--\x3e\n                    <div data-bind="css: \'message \' + direction ">\n                        <span data-bind="css: \'arrow \' + direction"></span>\n\n                        <span class="message-content">\n                            \x3c!-- ko if: type == "text" --\x3e\n                              <span data-bind="html: text , click: $root.searchSmartReply.bind(text)"></span>\n                            \x3c!-- /ko --\x3e\n\n                            \x3c!-- ko if: type == "image"--\x3e\n                             <span>\n                                  <img alt=""\n                                      data-bind="attr:{src:text.zoom || text.original}, click:$root.previewImg"\n                                      width="200"/>\n                             </span>\n                            \x3c!-- /ko --\x3e\n\n                            \x3c!-- ko if: type == "file" --\x3e\n                             <span>\n                                  <a data-bind="attr:{href:text}" target="_blank">点击下载</a>\n                             </span>\n                            \x3c!-- /ko --\x3e\n\n                            \x3c!-- ko if: type == "voice" --\x3e\n                             <span>\n                                  <a data-bind="attr:{href:text}" target="_blank">点击下载</a>\n                             </span>\n                            \x3c!-- /ko --\x3e\n\n                            \x3c!-- ko if: type == "video" --\x3e\n                             <span class="videoImg">\n                                 <img alt=""\n                                     data-bind="attr:{src:$root.videoImg} , click:$root.palyVideo"\n                                     width="200"/>\n                                 </br>\n                                 <div class="video-loader-box">\n                                     <div class="video-loader"></div>\n                                 </div>\n                                  <a data-bind="attr:{href:text}" target="_blank">点击下载</a>\n\n                             </span>\n                            \x3c!-- /ko --\x3e\n                        </span>                        \n                    </div>\n                    <div class="retract-msg" data-bind="visible:isShowWithdrawBtn,click: function(){$root.withdrawBtn(messageId,\'send\')}">撤回</div>\n                    \x3c!-- /ko --\x3e\n\n                    \x3c!--ko if:direction == \'tip\' --\x3e\n                    <div class="chatTip">\n                        <p data-bind="html: text"></p>\n                    </div>\n                    \x3c!-- /ko --\x3e\n                </div>\n                \x3c!-- /ko --\x3e\n            </div>\n            \x3c!-- /ko --\x3e\n\n            <div class="chat-message-form">\n                <div id="emojiPane" data-bind="visible: emojiPaneDis">\n                    <span\n                        class="i">/::)</span><span>/::~</span><span>/::B</span><span>/::|</span><span>/::<</span><span>/::$</span><span>/::X</span><span>/::Z</span><span>/::@</span><span>/::P</span><span>/::D</span><span>/::O</span><span>/::(</span><span>/::+</span><span>/::d</span><span>/::Q</span><span>/::T</span><span>/::g</span><span>/::8</span><span>/::!</span><span>/::L</span><span>/:xx</span><span>/::></span><span>/:8-)</span><span>/::\'(</span><span>/::-|</span><span>/:,@P</span><span>/:--b</span><span>/:,@o</span><span>/:|-)</span><span>/::,@</span><span>/:,@f</span><span>/::-S</span><span>/:,@x</span><span>/:,@@</span><span>/::-O</span><span>/:>-|</span><span>/:P-(</span><span>/::\'|</span><span>/:X-)</span><span>/:,@!</span><span>/:!!!</span><span>/:bye</span><span>/:<@</span><span>/:@></span><span>/::*</span><span>/:@x</span><span>/:8*</span><span>/:pd</span><span>/:?</span><span>/:,@-D</span><span>/:wipe</span><span>/:dig</span><span>/:handclap</span><span>/:&-(</span><span>/:B-)</span><span>/:&lt;W&gt;</span><span>/:oo</span><span>/:li</span><span>/:@)</span><span>/:jj</span><span>/:@@</span><span>/:kn</span><span>/:no</span><span>/:ok</span><span>/:oY</span><span>/:eat</span><span>/:pig</span><span>/:sun</span><span>/:&lt;L&gt;</span><span>/:&lt;O&gt;</span><span>/:hug</span><span>/:bad</span><span>/:lvu</span><span>/:cake</span><span>/:shit</span><span>/:moon</span><span>/:bome</span><span>/:rose</span><span>/:gift</span><span>/:weak</span><span>/:fade</span><span>/:beer</span><span>/:turn</span><span>/:skip</span><span>/:love</span><span>/:jump</span><span>/:heart</span><span>/:break</span><span>/:share</span><span>/:footb</span><span>/:kotow</span><span>/:shake</span><span>/:coffee</span><span>/:strong</span><span>/:circle</span><span>/:basketb</span><span>/:ladybug</span><span>/:showlove</span><span>/:v</span><span>/:#-0</span><span>/:hiphot</span><span>/:kiss</span><span>/:&lt;&amp;</span><span>/:&amp;&gt;</span>\n                </div>\n                <div class="top-bar">\n                    <span id="expressBtn" data-bind="click:function() {emojiPaneDis(!emojiPaneDis())}">\n                        <i id="emojiBtn"></i>\n                    </span>\n                    <span id="uploadBtn">\n                    </span>\n                    <input type="file" name="fileToUpload" id="fileToUpload"/>\n                    <span id=\'progressNumber\'></span>\n                    <span data-bind="visible: currentUser().serviceAduio() && currentUser().chatBoxType() ==\'custom-chat\', click:makeCallAudio"\n                        class="callOut-audio-icon">\n                    </span>\n                    <span data-bind="visible: currentUser().serviceVideo() && currentUser().chatBoxType() ==\'custom-chat\', click:makeCallVideo"\n                        class="callOut-video-icon">\n                    </span>\n                    <span id="send-request"\n                        data-bind="visible: currentUser().isSendEvalRequestBtnShow(),css: {\'isSendEvalRequest\': !currentUser().isSendEvalRequestBtnShow()},click: requestEvaluate">\n                    </span>\n\n                    <div class="chat-checked">\n                        <span id="openAutoMatchTipIcon" class="tipIcon">\n                        <i class="fa fa-exclamation" style="font-size: 3px;vertical-align: super; color: red;"></i>\n                    </span>\n                        <span>\n                        <input type="checkbox" style="vertical-align: top;margin-right: 5px;"\n                               data-bind="checked: openAutoMatch"/>自动匹配常用语\n                        </span>\n                        <div class="openAutoMatchTip">开启时,系统会根据输入内容自动匹配常用语内容并呈现,点击常用语内容会插入到输入框，关闭时点击常用语内容直接发送给客户</div>\n                    </div>\n\n                    <div data-bind="visible: intellHelp" class="chat-checked" style="margin-right: 15px">\n                        <span id="openIntellTipIcons" class="tipIcon">\n                        <i class="fa fa-exclamation" style="font-size: 3px;vertical-align: super; color: red;"></i>\n                    </span>\n                        <span>\n                        <input type="checkbox" style="vertical-align: top;margin-right: 5px;"\n                            data-bind="checked: openIntellHelp"/>智能协助\n                    </span>\n                        <div class="openIntellTip">开启智能协作时，机器人将自动回答客户问题</div>\n                    </div>\n                </div>\n\n                <p id="error" class="error" data-bind="visible:msgContentErrorDis,text:msgContentErrorDis"></p>\n\n                <textarea class="message-input" id="textArea"\n                    data-bind="textInput: inputText, event: {keydown: sendMessageByKey, keyup: function(data, event){searchComLang(\'autoMatch\', data, event)}}"\n                    placeholder="输入消息内容,请用空格分隔多个链接地址"></textarea>\n\n                <div class="bottom-bar">\n                    <a class="kickoffUser" data-bind="click: kickoffUser">结束会话</a>\n                    <a data-bind="visible: currentUser().isTransferAgentBtnShow(),click: getAgentList.bind($data,\'transfer\')">转接坐席</a>\n                    <a data-bind="visible: currentUser().isAddAgentBtnShow(),click: getAgentList.bind($data,\'addAgent\')">添加坐席</a>\n                    <span class="session-time" data-bind="visible : currentUser().online()">\n                        会话时长\n                        <span data-bind="text: currentUser().showSessionTime()"></span>\n                    </span>\n                    \x3c!--<a data-bind="click: sendSatisfy">满意度调查</a>--\x3e\n                    \x3c!--<button class="send-btn" data-bind="click: function(){$root.sendMessage(\'text\')}">发送</button>--\x3e\n                </div>\n            </div>\n            <div id="send-btn-group">\n                <button id="btn-send" data-bind="click: checkWord">发送</button>\n                <button id="btn-caret" data-bind="click: toggleBtnKeyList">\n                    <span class="fa fa-caret-up"></span>\n                </button>\n                <ul id="btn-key-list" data-bind="visible: btnKeyListDis, foreach: btnKeyList, event: {blur: blur}">\n                    <li data-bind="click: $parent.choseSendKey">\n                        <div style="display: inline-block;width: 15px;">\n                            <span class="fa fa-check" data-bind="visible: faCheck"></span>\n                        </div>\n                        <span data-bind="text: desc"></span>\n                    </li>\n                </ul>\n            </div>\n            <div id="chat-message-form-shadow" data-bind="visible: !currentUser().online()"></div>\n            <div class="chat-box-tip" data-bind="visible:msgTip()">\n                <div class="sensitiveTip">\n                    <span data-bind="html:msgWordHead"></span>\n                    <div data-bind="html:msgWord"></div>\n                    <button data-bind="click:closeTip.bind($data,\'sensitive\')">知道了</button>\n                </div>\n            </div>\n            <div class="chat-box-tip" data-bind="visible:keepChatTip().keepchatTipShow">\n                <div class="keep-chat-tip">\n                    <div>客户已结束对话，是否关闭聊天窗口</div>\n                    <button class="red-skin" data-bind="click:closeTip.bind($data,\'chatClose\')">关闭</button>\n                    <button data-bind="click:closeTip.bind($data,\'chatKeep\')">取消</button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="agentSection" data-bind="style:{width:currentUser().chatBoxType() == \'agent-group\'? \'675px\':\'450px\'}">\n        <p class="title" data-bind="text:selectAgentForm().title"></p>\n        <div class="agent-lists" >\n            <div class="agent-lists-left">\n                <div>\n                    <div class="serach-input">\n                        <span><i class="fa fa-search"></i></span>\n                        <input type="text" placeholder="搜索" data-bind="textInput: agentSearchText, event: {keyup: function(){searchText(\'agentListSearch\')}}"/>\n\x3c!--                         <span><i class="fa  fa-times-circle" style="font-size: 12px;"></i></span>\n --\x3e                    </div>                    \n                </div> \n                <ul class="agent-select-list" data-bind="visible:agentEabledSelectLists().length>0,foreach:agentEabledSelectLists">\n                    <li>\n                        <div class="skill-name">\n                            <span class="icon chat-users-arrow-down"></span>\n                            <span data-bind="text:skillGroupName"></span>\n                        </div>\n                        <ul data-bind="foreach: agents" class="agent-list">\n                            <li class="agent-list-item">\n                                <label data-bind="for:agentId, text:agentName"></label>\n                                <input type="checkbox" class="select-agent" data-bind="value:$data,checked: $root.hasSelectedAgents">\n                            </li>\n                        </ul>\n                    </li>\n                </ul>\n                <p class="none-agent-tip" data-bind="visible:!agentEabledSelectLists().length">暂无可选坐席</p>\n            </div>\n            <div class="agent-lists-right">\n                <p class="right-title">已选择坐席\n                    <span class="select-tip" data-bind="visible:currentUser().chatBoxType() == \'custom-chat\'">(仅能选择一个坐席，优先选择第一个坐席)</span>\n                </p>\n                <ul data-bind="foreach:hasSelectedAgents">\n                    <li style="margin:0 0 5px 10px">\n                        <span data-bind="text:agentName"></span>\n                        (<span data-bind="text:skillGroupName"></span>)\n                    </li>\n                </ul>\n                <textarea class="leave_words" placeholder="请输入转接留言" data-bind="visible:selectAgentForm().type == \'transfer\',textInput: transferMsg"></textarea>\n            </div>\n            <div class="agent-lists-side" data-bind="visible:currentUser().chatBoxType() == \'agent-group\'">\n                <p class="right-title">群成员-\n                    <span data-bind="text:currentUser().members.length"></span>\n                </p>\n                <ul data-bind="foreach:currentUser().members">\n                    <li style="margin:0 0 5px 10px">\n                        <span data-bind="text:agentName"></span>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        <div class="btns">\n            <button class="cancle_btn" data-bind="click: closeTip.bind($data,\'agentSession\')">取消</button>\n            <button class="transfer_btn" data-bind="click: $root.confirmAgent">确定</button>\n        </div>\n    </div>\n    <audio id="chat_online_tip" data-bind="attr: {src: onlineTipMusic}"></audio>\n    <audio id="chat_msg_tip" data-bind="attr: {src: msgTipMusic}"></audio>\n\n    <div class="video-place" data-bind="visible: videoPlace">\n        <div data-bind="click: closeVideo" class="close-video">X</div>\n        <div id="videoPlay"></div>\n    </div>\n\n    <div class="im-dialog" data-bind="visible: imPastePicDialog">\n        <div id="im-pastePic-dialog">\n            <div class="im-pastePic-content" id="picDiv"></div>\n            <div class="im-pastePic-footer">\n                <button type="button" id="sendPic" class="im-btn im-btn-info">发送</button>\n                <button type="button"\n                    class="im-btn im-btn-default"\n                    style="color:#000"\n                    data-bind="click:pastePicCancel">取消\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n<script type="text/html" id="userList">\n    <div class="chat-user" data-bind="click:$root.selectUser, css: {\'selected\': $data == $root.currentUser()}">\n\n        \x3c!-- ko if: channel == "weixin" || channel == "weixinim" --\x3e\n        <span class="chat-avatar"\n            data-bind="css:{\'chat-avatar-weixin-on\': online(), \'chat-avatar-weixin-off\': !online(), \'chat-avatar-weixin-timeout1\': timeOutBack() == \'yellow\',  \'chat-avatar-weixin-timeout2\': timeOutBack() == \'red\'}">\n            <span class="chat-user-msgNumber" data-bind="text: msgNumber, visible: msgNumber()"></span>\n        </span>\n        \x3c!-- /ko --\x3e\n\n        \x3c!-- ko if: channel == "webim" --\x3e\n        <span class="chat-avatar"\n            data-bind="css:{\'chat-avatar-webim-on\': online(), \'chat-avatar-webim-off\': !online(), \'chat-avatar-webim-timeout1\': timeOutBack() == \'yellow\',  \'chat-avatar-webim-timeout2\': timeOutBack() == \'red\'}">\n            <span class="chat-user-msgNumber" data-bind="text: msgNumber, visible: msgNumber()"></span>\n        </span>\n        \x3c!-- /ko --\x3e\n\n        \x3c!-- ko if: channel == "appim" --\x3e\n        <span class="chat-avatar"\n            data-bind="css:{\'chat-avatar-app-on\': online(), \'chat-avatar-app-off\': !online(),\'chat-avatar-app-timeout1\': timeOutBack() == \'yellow\',  \'chat-avatar-app-timeout2\': timeOutBack() == \'red\'}">\n              <span class="chat-user-msgNumber" data-bind="text:msgNumber, visible: msgNumber()"></span>\n        </span>\n        \x3c!-- /ko --\x3e\n\n        \x3c!-- ko if: channel == "internal-chat" --\x3e\n        <span class="chat-avatar chat-avatar-webim-on">\n            <span class="chat-user-msgNumber" data-bind="text: msgNumber, visible: msgNumber()"></span>\n        </span>\n        \x3c!-- /ko --\x3e        \n\n        <div class="chat-user-name">\n            <a href="#">\n                <span data-bind="text: nickName() || visitorInfo().workOrderName()"></span>\n                <span class="chat-user-timing" data-bind="text: timing, visible: !!timing() && online()"></span>\n            </a>\n            <span class="lastMsg" data-bind="html:lastMsg"></span>\n        </div>\n    </div>\n<\/script>\n<script type="text/html" id="agentLists">\n    <li>\n        <div class="skill-name">\n            <span class="icon chat-users-arrow-down"></span>\n            <span data-bind="text:skillGroupName"></span>\n        </div>\n        <ul data-bind="foreach: agents" class="agent-list">\n            <li class="agent-list-item" data-bind="click:$root.selectAgentChat">\n                <div data-bind="text:agentName"></div>\n                <div>\n                    <span data-bind="text:currentServiceNum"></span>人\n                </div>\n            </li>\n        </ul>\n    </li>\n<\/script>\n'}),define("text!quickReplyDom",[],function(){return'<div id="chat_quick_reply">\n    <div id="quick_reply" data-bind="visible:quickReplyDis">\n        <div id="handle_bar">\n            <div class="serach_input">\n                \x3c!--<input type="text" data-bind="textInput: quickReplySearchTxt, event: {keyup: function(){searchComLang(\'commonSearch\')}}"/>--\x3e\n                <input type="text" data-bind="textInput: quickReplySearchTxt, event: {keyup: function(){searchComLang(\'commonSearch\')}}"/>\n\n                <span><i class="fa fa-search"></i></span>\n            </div>\n            <div class="handle_button">\n                <span><i class="fa fa-refresh" data-bind="click: refreshList"></i></span>\n                <span><i class="fa fa-cog" data-bind="click: handleSetting"></i></span>\n            </div>\n        </div>\n        <div data-bind="template: {name: \'quickReplyContent\'}"></div>\n    </div>\n\n    <div id="common_Language_set" data-bind="visible: !quickReplyDis()">\n        <div id="comLang_title">\n            <span>设置常用语</span>\n            <div class="edit-btns" data-bind="visible: !!cacheValue()">\n                <button type="button" class="qn-button primary" data-bind="click:handleEdit">编辑</button>\n                <button type="button" class="qn-button danger" data-bind="click:handleDelete">删除</button>\n            </div>\n        </div>\n        <div data-bind="template: {name: \'quickReplyContent\'}"></div>\n        <div class="bottom-btns">\n            <form hidden encType="multipart/form-data" target="upload">\n                <input type="file" name="file" id="commLangToUpload"/>\n            </form>\n            <button type="button" class="qn-button primary" id="commLangUploadBtn">导入</button>\n            <button type="button" class="qn-button primary" data-bind="click:handleExport">导出</button>\n            <button type="button" class="qn-button primary">\n                <a data-bind="attr:{href:downLoadUrl}" target="_blank">模板下载</a>\n            </button>\n            <button type="button" class="qn-button primary" data-bind="click:handleReturn">返回</button>\n        </div>\n        <div class="common-Language-create" data-bind="visible:commCreateDis">\n            <div class="commLang-create-title">\n                <span data-bind="text:currentTitle"></span>\n            </div>\n            <div class="commLang-create-content">\n                \x3c!--ko if:currentTitleKey() == 1 || currentTitleKey() == 2--\x3e\n                <textarea data-bind="textInput:commLangContent" maxlength="10"></textarea>\n                <p>\n                    <span data-bind="text:commLangContent().length"></span>\n                    <span>/10</span>\n                </p>\n                \x3c!--/ko--\x3e\n                \x3c!--ko if:currentTitleKey() == 3 || currentTitleKey() == 4--\x3e\n                <textarea data-bind="textInput:commLangContent"></textarea>\n                \x3c!--/ko--\x3e\n            </div>\n            <div style="text-align: right">\n                <button type="button" class="qn-button default" data-bind="click:handleCancel">取消</button>\n                <button type="button" class="qn-button primary" id="handleSave" data-bind="click:handleSave">保存</button>\n            </div>\n        </div>\n        <div class="operateTip" data-bind="visible:!!operateTip()">\n            <span data-bind="text:operateTip"></span>\n        </div>\n        <div class="deleteConfirm" data-bind="visible:deleteConfirmDis">\n            \x3c!--ko if:cacheValue() && cacheValue().type == \'group\' --\x3e\n            <p>如果删除分组，该分组下的常用语内容将全部删除，并且不可恢复，是否确定删除?</p>\n            \x3c!--/ko--\x3e\n            \x3c!--ko if:cacheValue() && cacheValue().type == \'content\' --\x3e\n            <p>确定删除该条常用语内容?</p>\n            \x3c!--/ko--\x3e\n            <div style="text-align: right">\n                <button type="button" style="margin-right:10px;" class="qn-button default" data-bind="click:handleCancel">取消</button>\n                <button type="button" class="qn-button danger" data-bind="click:confirmDelete">删除</button>\n            </div>\n        </div>\n    </div>\n\n</div>\n<script type="text/html" id="quickReplyContent">\n    <div id="content_area">\n        <div class="com_language_group" data-bind="visible: !searchResultShow()">\n            <p>常用语分组\n                <button class="create_icon"\n                        data-bind="visible: !quickReplyDis(),click:createCommLangG,enable:comLangGgroupList().length < 20"><i\n                        class="fa fa-plus-square-o"></i></button>\n            </p>\n            <ul data-bind="foreach: comLangGgroupList">\n                <li data-bind="click: $parent.switchComLangGgroup,css:{\'selectedGroupActive\': selected()}">\n                    <span class="selected-group-style"\n                          data-bind="style: {visibility: selected() ? \'visible\' : \'hidden\'}"></span>\n                    <span data-bind="text: name"></span>\n                    <span class="iconComm" data-bind="style: {visibility: typeGrop() ? \'visible\' : \'hidden\'}"></span>\n                </li>\n            </ul>\n        </div>\n        <div class="com_language_content" data-bind="visible: !searchResultShow()">\n            <p>常用语内容\n                <button class="create_icon" data-bind="visible: !quickReplyDis(), click:createCommLangC,enable: !!selectedGgroup()">\n                    <i class="fa fa-plus-square-o" data-bind="style: {color: !!selectedGgroup() ? \'#07968a\' : \'#ddd\'}"></i>\n                </button>\n            </p>\n            <ul data-bind="foreach: comLangContentList">\n\n                \x3c!--ko if:$root.quickReplyDis()--\x3e\n                <li data-bind="text: name,click: $root.handleSearchedContent,css:{\'selectedContentActive\': selected()}"></li>\n                \x3c!--/ko--\x3e\n\n                \x3c!--ko if:!$root.quickReplyDis()--\x3e\n                <li data-bind="text: name,click: $root.handleCacheValue,css:{\'selectedContentActive\': selected()}"></li>\n                \x3c!--/ko--\x3e\n\n            </ul>\n        </div>\n        <div class="com_language_content search_result" data-bind="visible: searchResultShow">\n           \x3c!--ko if:searchedContentList().length > 0--\x3e\n            <ul data-bind="foreach: searchedContentList">\n                <li data-bind="text: sentenceDto.content,css:{\'iconCom_show\':type==\'0\'},click: $parent.handleSearchedContent">\n                </li>\n            </ul>\n            \x3c!--/ko--\x3e\n            <div class ="search_result_none" data-bind="visible:searchResultTip">\n                <p>没有搜索结果</p>\n            </div>\n        </div>\n    </div>\n<\/script>'}),define("text!smartReplyDom",[],function(){return'<div id="chat_smart_reply">\n    \x3c!--搜索框--\x3e\n    <div class="handle_bar">\n        <div class="serach_input">\n            <input type="text" placeholder="请输入您要问的问题" data-bind="textInput: smartReplySearchTxt"/>\n        </div>\n        <div class="handle_button">\n            <span><i class="fa fa-search" data-bind="click: searchReply"></i></span>\n            <span><i class="fa fa-refresh" data-bind="click: reflash"></i></span>\n        </div>\n    </div>\n    \x3c!--搜索结果--\x3e\n    <div class="content_bar">\n        <div data-bind="visible: smartContent">\n            <ul data-bind="foreach:smartReply">\n                <li>\n                    <p data-bind="text:question">\n                    </p>\n                    <p>\n                        <span data-bind="text: answer "></span>\n                        <span  data-bind="click: $parent.sendSmartReply.bind($index())"></span>\n                        \x3c!--<span data-bind=\'visible:msgtype=="1"\'>[图片]</span>--\x3e\n                    </p>\n                </li>\n            </ul>\n        </div>\n        <div class="no-content" data-bind="visible: !smartContent()">\n            \x3c!-- <img data-bind="attr:{ src: \'../images/\' + photoName() }" height="64" width="80"/>--\x3e\n            \x3c!--<div data-bind="style:{background:url(\'../images/\'+photoName())}"></div>--\x3e\n            <div data-bind="css: {mostar: photoName()<0}"></div>\n            <p data-bind="text:smartTip"></p>\n        </div>\n\n    </div>\n</div>'}),define("css!bsf",[],function(){}),function(n,e,t){requirejs.config({urlArgs:n,baseUrl:e,paths:{jquery:"MultiChannel/windowJquery",jsjac:"Agent/lib/jsjac-2.1",font:"public_css/font-awesome.min",agent:"Agent/scss/agent-cdesk",bsf:"Agent/css/bsf",dom:"Agent/app/Agent-ui-desk.html",quickReplyDom:"Agent/app/Quick-reply-ui.html",smartReplyDom:"Agent/app/Smart-reply-ui.html",FileUpload:"Agent/app/FileUpload",Login:"Agent/app/Login",Message:"Agent/app/Message",User:"Agent/app/User",ViewModel:"Agent/app/ViewModel",Vm:"Agent/app/Vm",ViewModelQuickReply:"Agent/app/ViewModelQuickReply",ViewModelSmartReply:"Agent/app/ViewModelSmartReply",VmQuickReply:"Agent/app/VmQuickReply",VmSmartReply:"Agent/app/VmSmartReply",IMG:"Agent/component/IMG",Drag:"Agent/component/ks-drag",RegisterEvent:"Agent/app/RegisterEvent",ButelEvent:"Agent/app/ButelEvent",weixinEmojiC:"Agent/css/weixinEmoji",weixinEmojiJ:"Agent/lib/weixinEmoji",weixinEmojiExtend:"Agent/lib/weixinEmojiExtend",util:"Agent/lib/util"}}),require(["jquery","knockout","Vm","VmQuickReply","VmSmartReply","Login","FileUpload","Drag","RegisterEvent","ButelEvent","text!dom","text!quickReplyDom","text!smartReplyDom","css!bsf"],function(n,e,i,o,a,r,s,c,u,d,p,l,g){"use strict";window.vm=i;var h=t.callback,m=t.selectorName;t.isCheckWord;"isCheckWord"in t&&(i.isCheckWord=t.isCheckWord),require(["css!font","css!agent"],function(){n(m||document.body).append(p);var f=n("#emojiPane").html();f=f.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),n("#emojiPane").html(WeixinEmojiExtend.replace(f)),n("#emojiPane img").click(function(){var e=n(this).attr("src"),t=e.split("/")[e.split("/").length-1].split(".")[0],o=WeixinEmojiExtend.getInverseStr(t);i.inputText()?i.inputText(i.inputText()+o):i.inputText(o),i.emojiPaneDis(!1),n("textarea.message-input").focus()}),n(document).click(function(n){"expressBtn"!=n.target.id&&i.emojiPaneDis(!1),"chat-common-word"!=n.target.id&&i.isShowCommonWordDialog(!1)}),n(document).delegate("span.icon","click",function(){
return n(this).hasClass("chat-users-arrow-up")?(n(this).removeClass("chat-users-arrow-up").addClass("chat-users-arrow-down"),void n(this).parent().next().slideDown()):n(this).hasClass("chat-users-arrow-down")?(n(this).removeClass("chat-users-arrow-down").addClass("chat-users-arrow-up"),void n(this).parent().next().slideUp()):n(this).hasClass("fa-plus")?(n(this).removeClass("fa-plus").addClass("fa-minus"),void n(this).parent().next().slideDown()):void(n(this).hasClass("fa-minus")&&(n(this).removeClass("fa-minus").addClass("fa-plus"),n(this).parent().next().slideUp()))});var b=null;n(document).on("paste","#textArea",function(n){b=null,b=i.pastePicFun(n)}),n(document).on("click","#sendPic",function(){b()}),n("#openAutoMatchTipIcon").hover(function(){n(".openAutoMatchTip").css("display","block")},function(){n(".openAutoMatchTip").css("display","none")}),n("#openIntellTipIcons").hover(function(){n(".openIntellTip").css("display","block")},function(){n(".openIntellTip").css("display","none")}),WebAgent.ChatLogin=r.login,WebAgent.ChatLogout=r.logout,WebAgent.ChatSetBusy=i.setBusy,WebAgent.ChatSetReady=i.setReady,WebAgent.readyEnabled=!1,WebAgent.agentOnline=i.agentOnline(),WebAgent.setNickName=i.setNickName,WebAgent.butelEvent=d,WebAgent.getAgentList=i.getAgentList,WebAgent.transferAgent=i.transferAgent,WebAgent.getChatMsgs=i.getChatMsgs,WebAgent.setChatSoundTip=i.setChatSoundTip,WebAgent.loadQuickReplyDom=function(t){n(t).append(l),e.applyBindings(o,n("#chat_quick_reply")[0])},t.quickReplySelector&&(n(t.quickReplySelector).append(l),e.applyBindings(o,n("#chat_quick_reply")[0])),WebAgent.loadQuickReplyData=o.loadQuickReplyModel,t.smartReply&&(n(t.smartReply).append(g),e.applyBindings(a,n("#chat_smart_reply")[0])),WebAgent.loadSmartReplyDom=function(t){n(t).append(g),e.applyBindings(a,n("#chat_smart_reply")[0])},n(document).delegate("#commLangUploadBtn","click",function(){console.log("you have clicked commLangUploadBtn"),s.commLangSelected()}),n(document).delegate("#commLangToUpload","change",function(){s.uploadCommLang()}),WebAgent.ChatRegisterEvent=u.registerEvent,WebAgent.ChatRemoveEvent=u.removeEvent,WebAgent.ChatBusyCallback=u.busyCallback,WebAgent.ChatReadyCallback=u.readyCallback,WebAgent.ChatWorkOrderCallback=function(n){i.currentUser().workOrder.push({workId:n.workId,title:n.title,onclick:n.onclick})},WebAgent.ChatUpdateOrAddUser=u.updateOrAddUser,WebAgent.ChatKchartCreate=u.kchartCreate,WebAgent.ChatToggle=function(){n("#chat_pane").toggle()},"function"==typeof h&&(h(),WebAgent.chatInitFinished=!0),n("#uploadBtn").click(function(){s.fileSelected()}),n("#fileToUpload").change(function(){var n=this;s.uploadFile(n)}),n("#hideChat").click(function(){n("#chat_pane").hide()}),c.dragElement(n(".ibox-title").get(0),n("#chat_pane").get(0)),e.applyBindings(i,n("#chat_pane")[0])})})}(WebAgent.urlArgs,WebAgent.baseUrl,WebAgent.ChatParams),define("main",function(){}),function(n){var e=document,t="appendChild",i="styleSheet",o=e.createElement("style");o.type="text/css",e.getElementsByTagName("head")[0][t](o),o[i]?o[i].cssText=n:o[t](e.createTextNode(n))
}('.weixinEmoji {\n    background: transparent url(css/weixinEmoji.png) no-repeat 0 0;\n    width: 20px;\n    height: 20px;\n    display: -moz-inline-stack;\n    display: inline-block;\n    vertical-align: middle;\n    margin-top: -0.2em;\n    zoom:1;\n    *display: inline\n}\n\n\n.weixinEmoji-2600 {\n    background-position: 0 -260px\n}\n\n.weixinEmoji-2601 {\n    background-position: 0 -20px\n}\n\n.weixinEmoji-2614 {\n    background-position: 0 -40px\n}\n\n.weixinEmoji-26c4 {\n    background-position: 0 -60px\n}\n\n.weixinEmoji-26a1 {\n    background-position: 0 -80px\n}\n\n.weixinEmoji-1f300 {\n    background-position: 0 -100px\n}\n\n.weixinEmoji-1f301 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f302 {\n    background-position: 0 -120px\n}\n\n.weixinEmoji-1f303 {\n    background-position: 0 -920px\n}\n\n.weixinEmoji-1f304 {\n    background-position: 0 -160px\n}\n\n.weixinEmoji-1f305 {\n    background-position: 0 -180px\n}\n\n.weixinEmoji-1f306 {\n    background-position: 0 -200px\n}\n\n.weixinEmoji-1f307 {\n    background-position: 0 -220px\n}\n\n.weixinEmoji-1f308 {\n    background-position: 0 -240px\n}\n\n.weixinEmoji-2744 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-26c5 {\n    background-position: 0 -260px\n}\n\n.weixinEmoji-1f309 {\n    background-position: 0 -920px\n}\n\n.weixinEmoji-1f30a {\n    background-position: 0 -900px\n}\n\n.weixinEmoji-1f30b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f30c {\n    background-position: 0 -920px\n}\n\n.weixinEmoji-1f30f {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f311 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f314 {\n    background-position: 0 -360px\n}\n\n.weixinEmoji-1f313 {\n    background-position: 0 -360px\n}\n\n.weixinEmoji-1f319 {\n    background-position: 0 -360px\n}\n\n.weixinEmoji-1f315 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f31b {\n    background-position: 0 -360px\n}\n\n.weixinEmoji-1f31f {\n    background-position: 0 -10740px\n}\n\n.weixinEmoji-1f320 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f550 {\n    background-position: 0 -380px\n}\n\n.weixinEmoji-1f551 {\n    background-position: 0 -400px\n}\n\n.weixinEmoji-1f552 {\n    background-position: 0 -420px\n}\n\n.weixinEmoji-1f553 {\n    background-position: 0 -440px\n}\n\n.weixinEmoji-1f554 {\n    background-position: 0 -460px\n}\n\n.weixinEmoji-1f555 {\n    background-position: 0 -480px\n}\n\n.weixinEmoji-1f556 {\n    background-position: 0 -500px\n}\n\n.weixinEmoji-1f557 {\n    background-position: 0 -520px\n}\n\n.weixinEmoji-1f558 {\n    background-position: 0 -540px\n}\n\n.weixinEmoji-1f559 {\n    background-position: 0 -620px\n}\n\n.weixinEmoji-1f55a {\n    background-position: 0 -580px\n}\n\n.weixinEmoji-1f55b {\n    background-position: 0 -600px\n}\n\n.weixinEmoji-231a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-231b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-23f0 {\n    background-position: 0 -620px\n}\n\n.weixinEmoji-23f3 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2648 {\n    background-position: 0 -640px\n}\n\n.weixinEmoji-2649 {\n    background-position: 0 -660px\n}\n\n.weixinEmoji-264a {\n    background-position: 0 -680px\n}\n\n.weixinEmoji-264b {\n    background-position: 0 -700px\n}\n\n.weixinEmoji-264c {\n    background-position: 0 -720px\n}\n\n.weixinEmoji-264d {\n    background-position: 0 -740px\n}\n\n.weixinEmoji-264e {\n    background-position: 0 -760px\n}\n\n.weixinEmoji-264f {\n    background-position: 0 -780px\n}\n\n.weixinEmoji-2650 {\n    background-position: 0 -800px\n}\n\n.weixinEmoji-2651 {\n    background-position: 0 -820px\n}\n\n.weixinEmoji-2652 {\n    background-position: 0 -840px\n}\n\n.weixinEmoji-2653 {\n    background-position: 0 -860px\n}\n\n.weixinEmoji-26ce {\n    background-position: 0 -880px\n}\n\n.weixinEmoji-1f340 {\n    background-position: 0 -1220px\n}\n\n.weixinEmoji-1f337 {\n    background-position: 0 -960px\n}\n\n.weixinEmoji-1f331 {\n    background-position: 0 -1220px\n}\n\n.weixinEmoji-1f341 {\n    background-position: 0 -1000px\n}\n\n.weixinEmoji-1f338 {\n    background-position: 0 -1020px\n}\n\n.weixinEmoji-1f339 {\n    background-position: 0 -1040px\n}\n\n.weixinEmoji-1f342 {\n    background-position: 0 -1060px\n}\n\n.weixinEmoji-1f343 {\n    background-position: 0 -1080px\n}\n\n.weixinEmoji-1f33a {\n    background-position: 0 -1100px\n}\n\n.weixinEmoji-1f33b {\n    background-position: 0 -1200px\n}\n\n.weixinEmoji-1f334 {\n    background-position: 0 -1140px\n}\n\n.weixinEmoji-1f335 {\n    background-position: 0 -1160px\n}\n\n.weixinEmoji-1f33e {\n    background-position: 0 -1180px\n}\n\n.weixinEmoji-1f33d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f344 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f330 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f33c {\n    background-position: 0 -1200px\n}\n\n.weixinEmoji-1f33f {\n    background-position: 0 -1220px\n}\n\n.weixinEmoji-1f352 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f34c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f34e {\n    background-position: 0 -1360px\n}\n\n.weixinEmoji-1f34a {\n    background-position: 0 -1260px\n}\n\n.weixinEmoji-1f353 {\n    background-position: 0 -1280px\n}\n\n.weixinEmoji-1f349 {\n    background-position: 0 -1300px\n}\n\n.weixinEmoji-1f345 {\n    background-position: 0 -1320px\n}\n\n.weixinEmoji-1f346 {\n    background-position: 0 -1340px\n}\n\n.weixinEmoji-1f348 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f34d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f347 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f351 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f34f {\n    background-position: 0 -1360px\n}\n\n.weixinEmoji-1f440 {\n    background-position: 0 -1380px\n}\n\n.weixinEmoji-1f442 {\n    background-position: 0 -1400px\n}\n\n.weixinEmoji-1f443 {\n    background-position: 0 -1420px\n}\n\n.weixinEmoji-1f444 {\n    background-position: 0 -1440px\n}\n\n.weixinEmoji-1f445 {\n    background-position: 0 -3000px\n}\n\n.weixinEmoji-1f484 {\n    background-position: 0 -1480px\n}\n\n.weixinEmoji-1f485 {\n    background-position: 0 -1500px\n}\n\n.weixinEmoji-1f486 {\n    background-position: 0 -1520px\n}\n\n.weixinEmoji-1f487 {\n    background-position: 0 -1540px\n}\n\n.weixinEmoji-1f488 {\n    background-position: 0 -1560px\n}\n\n.weixinEmoji-1f464 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f466 {\n    background-position: 0 -1580px\n}\n\n.weixinEmoji-1f467 {\n    background-position: 0 -1600px\n}\n\n.weixinEmoji-1f468 {\n    background-position: 0 -1620px\n}\n\n.weixinEmoji-1f469 {\n    background-position: 0 -1640px\n}\n\n.weixinEmoji-1f46a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f46b {\n    background-position: 0 -1660px\n}\n\n.weixinEmoji-1f46e {\n    background-position: 0 -1680px\n}\n\n.weixinEmoji-1f46f {\n    background-position: 0 -1700px\n}\n\n.weixinEmoji-1f470 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f471 {\n    background-position: 0 -1720px\n}\n\n.weixinEmoji-1f472 {\n    background-position: 0 -1740px\n}\n\n.weixinEmoji-1f473 {\n    background-position: 0 -1760px\n}\n\n.weixinEmoji-1f474 {\n    background-position: 0 -1780px\n}\n\n.weixinEmoji-1f475 {\n    background-position: 0 -1800px\n}\n\n.weixinEmoji-1f476 {\n    background-position: 0 -1820px\n}\n\n.weixinEmoji-1f477 {\n    background-position: 0 -1840px\n}\n\n.weixinEmoji-1f478 {\n    background-position: 0 -1860px\n}\n\n.weixinEmoji-1f479 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f47a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f47b {\n    background-position: 0 -1880px\n}\n\n.weixinEmoji-1f47c {\n    background-position: 0 -1900px\n}\n\n.weixinEmoji-1f47d {\n    background-position: 0 -1920px\n}\n\n.weixinEmoji-1f47e {\n    background-position: 0 -1940px\n}\n\n.weixinEmoji-1f47f {\n    background-position: 0 -1960px\n}\n\n.weixinEmoji-1f480 {\n    background-position: 0 -1980px\n}\n\n.weixinEmoji-1f481 {\n    background-position: 0 -2000px\n}\n\n.weixinEmoji-1f482 {\n    background-position: 0 -2020px\n}\n\n.weixinEmoji-1f483 {\n    background-position: 0 -2040px\n}\n\n.weixinEmoji-1f40c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f40d {\n    background-position: 0 -2620px\n}\n\n.weixinEmoji-1f40e {\n    background-position: 0 -6680px\n}\n\n.weixinEmoji-1f414 {\n    background-position: 0 -2640px\n}\n\n.weixinEmoji-1f417 {\n    background-position: 0 -2660px\n}\n\n.weixinEmoji-1f42b {\n    background-position: 0 -2680px\n}\n\n.weixinEmoji-1f418 {\n    background-position: 0 -2480px\n}\n\n.weixinEmoji-1f428 {\n    background-position: 0 -2500px\n}\n\n.weixinEmoji-1f412 {\n    background-position: 0 -2520px\n}\n\n.weixinEmoji-1f411 {\n    background-position: 0 -2540px\n}\n\n.weixinEmoji-1f419 {\n    background-position: 0 -2340px\n}\n\n.weixinEmoji-1f41a {\n    background-position: 0 -2360px\n}\n\n.weixinEmoji-1f41b {\n    background-position: 0 -2460px\n}\n\n.weixinEmoji-1f41c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f41d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f41e {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f420 {\n    background-position: 0 -2420px\n}\n\n.weixinEmoji-1f421 {\n    background-position: 0 -7360px\n}\n\n.weixinEmoji-1f422 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f424 {\n    background-position: 0 -2140px\n}\n\n.weixinEmoji-1f425 {\n    background-position: 0 -2140px\n}\n\n.weixinEmoji-1f426 {\n    background-position: 0 -2400px\n}\n\n.weixinEmoji-1f423 {\n    background-position: 0 -2140px\n}\n\n.weixinEmoji-1f427 {\n    background-position: 0 -2160px\n}\n\n.weixinEmoji-1f429 {\n    background-position: 0 -2720px\n}\n\n.weixinEmoji-1f41f {\n    background-position: 0 -7360px\n}\n\n.weixinEmoji-1f42c {\n    background-position: 0 -2380px\n}\n\n.weixinEmoji-1f42d {\n    background-position: 0 -2280px\n}\n\n.weixinEmoji-1f42f {\n    background-position: 0 -2240px\n}\n\n.weixinEmoji-1f431 {\n    background-position: 0 -2080px\n}\n\n.weixinEmoji-1f433 {\n    background-position: 0 -2300px\n}\n\n.weixinEmoji-1f434 {\n    background-position: 0 -2200px\n}\n\n.weixinEmoji-1f435 {\n    background-position: 0 -2320px\n}\n\n.weixinEmoji-1f436 {\n    background-position: 0 -2720px\n}\n\n.weixinEmoji-1f437 {\n    background-position: 0 -2780px\n}\n\n.weixinEmoji-1f43b {\n    background-position: 0 -2260px\n}\n\n.weixinEmoji-1f439 {\n    background-position: 0 -2440px\n}\n\n.weixinEmoji-1f43a {\n    background-position: 0 -2560px\n}\n\n.weixinEmoji-1f42e {\n    background-position: 0 -2580px\n}\n\n.weixinEmoji-1f430 {\n    background-position: 0 -2600px\n}\n\n.weixinEmoji-1f438 {\n    background-position: 0 -2700px\n}\n\n.weixinEmoji-1f43e {\n    background-position: 0 -6460px\n}\n\n.weixinEmoji-1f432 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f43c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f43d {\n    background-position: 0 -2780px\n}\n\n.weixinEmoji-1f620 {\n    background-position: 0 -2800px\n}\n\n.weixinEmoji-1f629 {\n    background-position: 0 -3860px\n}\n\n.weixinEmoji-1f632 {\n    background-position: 0 -2840px\n}\n\n.weixinEmoji-1f61e {\n    background-position: 0 -2860px\n}\n\n.weixinEmoji-1f635 {\n    background-position: 0 -3540px\n}\n\n.weixinEmoji-1f630 {\n    background-position: 0 -2900px\n}\n\n.weixinEmoji-1f612 {\n    background-position: 0 -2920px\n}\n\n.weixinEmoji-1f60d {\n    background-position: 0 -3660px\n}\n\n.weixinEmoji-1f624 {\n    background-position: 0 -3720px\n}\n\n.weixinEmoji-1f61c {\n    background-position: 0 -2980px\n}\n\n.weixinEmoji-1f61d {\n    background-position: 0 -3000px\n}\n\n.weixinEmoji-1f60b {\n    background-position: 0 -3220px\n}\n\n.weixinEmoji-1f618 {\n    background-position: 0 -3640px\n}\n\n.weixinEmoji-1f61a {\n    background-position: 0 -3060px\n}\n\n.weixinEmoji-1f637 {\n    background-position: 0 -3080px\n}\n\n.weixinEmoji-1f633 {\n    background-position: 0 -3100px\n}\n\n.weixinEmoji-1f603 {\n    background-position: 0 -3580px\n}\n\n.weixinEmoji-1f605 {\n    background-position: 0 -3260px\n}\n\n.weixinEmoji-1f606 {\n    background-position: 0 -3380px\n}\n\n.weixinEmoji-1f601 {\n    background-position: 0 -3720px\n}\n\n.weixinEmoji-1f602 {\n    background-position: 0 -3620px\n}\n\n.weixinEmoji-1f60a {\n    background-position: 0 -3220px\n}\n\n.weixinEmoji-263a {\n    background-position: 0 -3240px\n}\n\n.weixinEmoji-1f604 {\n    background-position: 0 -3260px\n}\n\n.weixinEmoji-1f622 {\n    background-position: 0 -3680px\n}\n\n.weixinEmoji-1f62d {\n    background-position: 0 -3300px\n}\n\n.weixinEmoji-1f628 {\n    background-position: 0 -3320px\n}\n\n.weixinEmoji-1f623 {\n    background-position: 0 -3540px\n}\n\n.weixinEmoji-1f621 {\n    background-position: 0 -3880px\n}\n\n.weixinEmoji-1f60c {\n    background-position: 0 -3380px\n}\n\n.weixinEmoji-1f616 {\n    background-position: 0 -10520px\n}\n\n.weixinEmoji-1f614 {\n    background-position: 0 -3860px\n}\n\n.weixinEmoji-1f631 {\n    background-position: 0 -3440px\n}\n\n.weixinEmoji-1f62a {\n    background-position: 0 -3460px\n}\n\n.weixinEmoji-1f60f {\n    background-position: 0 -3480px\n}\n\n.weixinEmoji-1f613 {\n    background-position: 0 -3500px\n}\n\n.weixinEmoji-1f625 {\n    background-position: 0 -3520px\n}\n\n.weixinEmoji-1f62b {\n    background-position: 0 -3540px\n}\n\n.weixinEmoji-1f609 {\n    background-position: 0 -3560px\n}\n\n.weixinEmoji-1f63a {\n    background-position: 0 -3580px\n}\n\n.weixinEmoji-1f638 {\n    background-position: 0 -3720px\n}\n\n.weixinEmoji-1f639 {\n    background-position: 0 -3620px\n}\n\n.weixinEmoji-1f63d {\n    background-position: 0 -3640px\n}\n\n.weixinEmoji-1f63b {\n    background-position: 0 -3660px\n}\n\n.weixinEmoji-1f63f {\n    background-position: 0 -3680px\n}\n\n.weixinEmoji-1f63e {\n    background-position: 0 -3880px\n}\n\n.weixinEmoji-1f63c {\n    background-position: 0 -3720px\n}\n\n.weixinEmoji-1f640 {\n    background-position: 0 -3860px\n}\n\n.weixinEmoji-1f645 {\n    background-position: 0 -3760px\n}\n\n.weixinEmoji-1f646 {\n    background-position: 0 -3780px\n}\n\n.weixinEmoji-1f647 {\n    background-position: 0 -3800px\n}\n\n.weixinEmoji-1f648 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f64a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f649 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f64b {\n    background-position: 0 -11240px\n}\n\n.weixinEmoji-1f64c {\n    background-position: 0 -3840px\n}\n\n.weixinEmoji-1f64d {\n    background-position: 0 -3860px\n}\n\n.weixinEmoji-1f64e {\n    background-position: 0 -3880px\n}\n\n.weixinEmoji-1f64f {\n    background-position: 0 -3900px\n}\n\n.weixinEmoji-1f3e0 {\n    background-position: 0 -3940px\n}\n\n.weixinEmoji-1f3e1 {\n    background-position: 0 -3940px\n}\n\n.weixinEmoji-1f3e2 {\n    background-position: 0 -3960px\n}\n\n.weixinEmoji-1f3e3 {\n    background-position: 0 -3980px\n}\n\n.weixinEmoji-1f3e5 {\n    background-position: 0 -4000px\n}\n\n.weixinEmoji-1f3e6 {\n    background-position: 0 -4020px\n}\n\n.weixinEmoji-1f3e7 {\n    background-position: 0 -4040px\n}\n\n.weixinEmoji-1f3e8 {\n    background-position: 0 -4060px\n}\n\n.weixinEmoji-1f3e9 {\n    background-position: 0 -4080px\n}\n\n.weixinEmoji-1f3ea {\n    background-position: 0 -4100px\n}\n\n.weixinEmoji-1f3eb {\n    background-position: 0 -4120px\n}\n\n.weixinEmoji-26ea {\n    background-position: 0 -4140px\n}\n\n.weixinEmoji-26f2 {\n    background-position: 0 -4160px\n}\n\n.weixinEmoji-1f3ec {\n    background-position: 0 -4180px\n}\n\n.weixinEmoji-1f3ef {\n    background-position: 0 -4200px\n}\n\n.weixinEmoji-1f3f0 {\n    background-position: 0 -4220px\n}\n\n.weixinEmoji-1f3ed {\n    background-position: 0 -4240px\n}\n\n.weixinEmoji-2693 {\n    background-position: 0 -6920px\n}\n\n.weixinEmoji-1f3ee {\n    background-position: 0 -8800px\n}\n\n.weixinEmoji-1f5fb {\n    background-position: 0 -4300px\n}\n\n.weixinEmoji-1f5fc {\n    background-position: 0 -4320px\n}\n\n.weixinEmoji-1f5fd {\n    background-position: 0 -4340px\n}\n\n.weixinEmoji-1f5fe {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f5ff {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f45e {\n    background-position: 0 -4400px\n}\n\n.weixinEmoji-1f45f {\n    background-position: 0 -4400px\n}\n\n.weixinEmoji-1f460 {\n    background-position: 0 -4420px\n}\n\n.weixinEmoji-1f461 {\n    background-position: 0 -4440px\n}\n\n.weixinEmoji-1f462 {\n    background-position: 0 -4460px\n}\n\n.weixinEmoji-1f463 {\n    background-position: 0 -6460px\n}\n\n.weixinEmoji-1f453 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f455 {\n    background-position: 0 -4620px\n}\n\n.weixinEmoji-1f456 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f451 {\n    background-position: 0 -4500px\n}\n\n.weixinEmoji-1f454 {\n    background-position: 0 -4520px\n}\n\n.weixinEmoji-1f452 {\n    background-position: 0 -4540px\n}\n\n.weixinEmoji-1f457 {\n    background-position: 0 -4560px\n}\n\n.weixinEmoji-1f458 {\n    background-position: 0 -4580px\n}\n\n.weixinEmoji-1f459 {\n    background-position: 0 -4600px\n}\n\n.weixinEmoji-1f45a {\n    background-position: 0 -4620px\n}\n\n.weixinEmoji-1f45b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f45c {\n    background-position: 0 -4960px\n}\n\n.weixinEmoji-1f45d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4b0 {\n    background-position: 0 -4720px\n}\n\n.weixinEmoji-1f4b1 {\n    background-position: 0 -4660px\n}\n\n.weixinEmoji-1f4b9 {\n    background-position: 0 -6380px\n}\n\n.weixinEmoji-1f4b2 {\n    background-position: 0 -4720px\n}\n\n.weixinEmoji-1f4b3 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4b4 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4b5 {\n    background-position: 0 -4720px\n}\n\n.weixinEmoji-1f4b8 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f1e81f1f3 {\n    background-position: 0 -4740px\n}\n\n.weixinEmoji-1f1e91f1ea {\n    background-position: 0 -4760px\n}\n\n.weixinEmoji-1f1ea1f1f8 {\n    background-position: 0 -4780px\n}\n\n.weixinEmoji-1f1eb1f1f7 {\n    background-position: 0 -4800px\n}\n\n.weixinEmoji-1f1ec1f1e7 {\n    background-position: 0 -4820px\n}\n\n.weixinEmoji-1f1ee1f1f9 {\n    background-position: 0 -4840px\n}\n\n.weixinEmoji-1f1ef1f1f5 {\n    background-position: 0 -4860px\n}\n\n.weixinEmoji-1f1f01f1f7 {\n    background-position: 0 -4880px\n}\n\n.weixinEmoji-1f1f71f1fa {\n    background-position: 0 -4900px\n}\n\n.weixinEmoji-1f1fa1f1f8 {\n    background-position: 0 -4920px\n}\n\n.weixinEmoji-1f525 {\n    background-position: 0 -5040px\n}\n\n.weixinEmoji-1f526 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f527 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f528 {\n    background-position: 0 -4360px\n}\n\n.weixinEmoji-1f529 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f52a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f52b {\n    background-position: 0 -5020px\n}\n\n.weixinEmoji-1f52e {\n    background-position: 0 -5080px\n}\n\n.weixinEmoji-1f52f {\n    background-position: 0 -5080px\n}\n\n.weixinEmoji-1f530 {\n    background-position: 0 -9660px\n}\n\n.weixinEmoji-1f531 {\n    background-position: 0 -9680px\n}\n\n.weixinEmoji-1f489 {\n    background-position: 0 -5300px\n}\n\n.weixinEmoji-1f48a {\n    background-position: 0 -5320px\n}\n\n.weixinEmoji-1f170 {\n    background-position: 0 -5340px\n}\n\n.weixinEmoji-1f171 {\n    background-position: 0 -5360px\n}\n\n.weixinEmoji-1f18e {\n    background-position: 0 -5380px\n}\n\n.weixinEmoji-1f17e {\n    background-position: 0 -5400px\n}\n\n.weixinEmoji-1f380 {\n    background-position: 0 -5420px\n}\n\n.weixinEmoji-1f381 {\n    background-position: 0 -6080px\n}\n\n.weixinEmoji-1f382 {\n    background-position: 0 -5460px\n}\n\n.weixinEmoji-1f384 {\n    background-position: 0 -5480px\n}\n\n.weixinEmoji-1f385 {\n    background-position: 0 -5500px\n}\n\n.weixinEmoji-1f38c {\n    background-position: 0 -5520px\n}\n\n.weixinEmoji-1f386 {\n    background-position: 0 -5540px\n}\n\n.weixinEmoji-1f388 {\n    background-position: 0 -5560px\n}\n\n.weixinEmoji-1f389 {\n    background-position: 0 -5580px\n}\n\n.weixinEmoji-1f38d {\n    background-position: 0 -5600px\n}\n\n.weixinEmoji-1f38e {\n    background-position: 0 -5620px\n}\n\n.weixinEmoji-1f393 {\n    background-position: 0 -5640px\n}\n\n.weixinEmoji-1f392 {\n    background-position: 0 -5660px\n}\n\n.weixinEmoji-1f38f {\n    background-position: 0 -5680px\n}\n\n.weixinEmoji-1f387 {\n    background-position: 0 -5700px\n}\n\n.weixinEmoji-1f390 {\n    background-position: 0 -5720px\n}\n\n.weixinEmoji-1f383 {\n    background-position: 0 -5740px\n}\n\n.weixinEmoji-1f38a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f38b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f391 {\n    background-position: 0 -5760px\n}\n\n.weixinEmoji-1f4df {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-260e {\n    background-position: 0 -5800px\n}\n\n.weixinEmoji-1f4de {\n    background-position: 0 -5800px\n}\n\n.weixinEmoji-1f4f1 {\n    background-position: 0 -5820px\n}\n\n.weixinEmoji-1f4f2 {\n    background-position: 0 -5840px\n}\n\n.weixinEmoji-1f4dd {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f4e0 {\n    background-position: 0 -5880px\n}\n\n.weixinEmoji-2709 {\n    background-position: 0 -11200px\n}\n\n.weixinEmoji-1f4e8 {\n    background-position: 0 -11200px\n}\n\n.weixinEmoji-1f4e9 {\n    background-position: 0 -11200px\n}\n\n.weixinEmoji-1f4ea {\n    background-position: 0 -5980px\n}\n\n.weixinEmoji-1f4eb {\n    background-position: 0 -5980px\n}\n\n.weixinEmoji-1f4ee {\n    background-position: 0 -6000px\n}\n\n.weixinEmoji-1f4f0 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4e2 {\n    background-position: 0 -6020px\n}\n\n.weixinEmoji-1f4e3 {\n    background-position: 0 -6040px\n}\n\n.weixinEmoji-1f4e1 {\n    background-position: 0 -6060px\n}\n\n.weixinEmoji-1f4e4 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4e5 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4e6 {\n    background-position: 0 -6080px\n}\n\n.weixinEmoji-1f4e7 {\n    background-position: 0 -11200px\n}\n\n.weixinEmoji-1f520 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f521 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f522 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f523 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f524 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2712 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4ba {\n    background-position: 0 -6100px\n}\n\n.weixinEmoji-1f4bb {\n    background-position: 0 -6120px\n}\n\n.weixinEmoji-270f {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f4ce {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4bc {\n    background-position: 0 -6160px\n}\n\n.weixinEmoji-1f4bd {\n    background-position: 0 -6200px\n}\n\n.weixinEmoji-1f4be {\n    background-position: 0 -6200px\n}\n\n.weixinEmoji-1f4bf {\n    background-position: 0 -7800px\n}\n\n.weixinEmoji-1f4c0 {\n    background-position: 0 -7820px\n}\n\n.weixinEmoji-2702 {\n    background-position: 0 -6220px\n}\n\n.weixinEmoji-1f4cd {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4c3 {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f4c4 {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f4c5 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4c1 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4c2 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4d3 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d6 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d4 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d5 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d7 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d8 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4d9 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4da {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4db {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4dc {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4cb {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f4c6 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4ca {\n    background-position: 0 -6380px\n}\n\n.weixinEmoji-1f4c8 {\n    background-position: 0 -6380px\n}\n\n.weixinEmoji-1f4c9 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4c7 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4cc {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4d2 {\n    background-position: 0 -6420px\n}\n\n.weixinEmoji-1f4cf {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4d0 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4d1 {\n    background-position: 0 -6440px\n}\n\n.weixinEmoji-1f3bd {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-26be {\n    background-position: 0 -6480px\n}\n\n.weixinEmoji-26f3 {\n    background-position: 0 -6500px\n}\n\n.weixinEmoji-1f3be {\n    background-position: 0 -6520px\n}\n\n.weixinEmoji-26bd {\n    background-position: 0 -6540px\n}\n\n.weixinEmoji-1f3bf {\n    background-position: 0 -6560px\n}\n\n.weixinEmoji-1f3c0 {\n    background-position: 0 -6580px\n}\n\n.weixinEmoji-1f3c1 {\n    background-position: 0 -6600px\n}\n\n.weixinEmoji-1f3c2 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3c3 {\n    background-position: 0 -6620px\n}\n\n.weixinEmoji-1f3c4 {\n    background-position: 0 -6640px\n}\n\n.weixinEmoji-1f3c6 {\n    background-position: 0 -6660px\n}\n\n.weixinEmoji-1f3c8 {\n    background-position: 0 -6700px\n}\n\n.weixinEmoji-1f3ca {\n    background-position: 0 -6720px\n}\n\n.weixinEmoji-1f683 {\n    background-position: 0 -6740px\n}\n\n.weixinEmoji-1f687 {\n    background-position: 0 -6780px\n}\n\n.weixinEmoji-24c2 {\n    background-position: 0 -6780px\n}\n\n.weixinEmoji-1f684 {\n    background-position: 0 -6800px\n}\n\n.weixinEmoji-1f685 {\n    background-position: 0 -6820px\n}\n\n.weixinEmoji-1f697 {\n    background-position: 0 -6840px\n}\n\n.weixinEmoji-1f699 {\n    background-position: 0 -6860px\n}\n\n.weixinEmoji-1f68c {\n    background-position: 0 -6880px\n}\n\n.weixinEmoji-1f68f {\n    background-position: 0 -6900px\n}\n\n.weixinEmoji-1f6a2 {\n    background-position: 0 -6920px\n}\n\n.weixinEmoji-2708 {\n    background-position: 0 -6940px\n}\n\n.weixinEmoji-26f5 {\n    background-position: 0 -6960px\n}\n\n.weixinEmoji-1f689 {\n    background-position: 0 -7000px\n}\n\n.weixinEmoji-1f680 {\n    background-position: 0 -7020px\n}\n\n.weixinEmoji-1f6a4 {\n    background-position: 0 -7040px\n}\n\n.weixinEmoji-1f695 {\n    background-position: 0 -7060px\n}\n\n.weixinEmoji-1f69a {\n    background-position: 0 -7100px\n}\n\n.weixinEmoji-1f692 {\n    background-position: 0 -7120px\n}\n\n.weixinEmoji-1f691 {\n    background-position: 0 -7140px\n}\n\n.weixinEmoji-1f693 {\n    background-position: 0 -7260px\n}\n\n.weixinEmoji-26fd {\n    background-position: 0 -7180px\n}\n\n.weixinEmoji-1f17f {\n    background-position: 0 -7200px\n}\n\n.weixinEmoji-1f6a5 {\n    background-position: 0 -7220px\n}\n\n.weixinEmoji-1f6a7 {\n    background-position: 0 -9720px\n}\n\n.weixinEmoji-1f6a8 {\n    background-position: 0 -7260px\n}\n\n.weixinEmoji-2668 {\n    background-position: 0 -7280px\n}\n\n.weixinEmoji-26fa {\n    background-position: 0 -7300px\n}\n\n.weixinEmoji-1f3a0 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3a1 {\n    background-position: 0 -7320px\n}\n\n.weixinEmoji-1f3a2 {\n    background-position: 0 -7340px\n}\n\n.weixinEmoji-1f3a3 {\n    background-position: 0 -7360px\n}\n\n.weixinEmoji-1f3a4 {\n    background-position: 0 -7380px\n}\n\n.weixinEmoji-1f3a5 {\n    background-position: 0 -7400px\n}\n\n.weixinEmoji-1f3a6 {\n    background-position: 0 -7420px\n}\n\n.weixinEmoji-1f3a7 {\n    background-position: 0 -7440px\n}\n\n.weixinEmoji-1f3a8 {\n    background-position: 0 -7460px\n}\n\n.weixinEmoji-1f3a9 {\n    background-position: 0 -7540px\n}\n\n.weixinEmoji-1f3aa {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3ab {\n    background-position: 0 -7500px\n}\n\n.weixinEmoji-1f3ac {\n    background-position: 0 -7520px\n}\n\n.weixinEmoji-1f3ad {\n    background-position: 0 -7540px\n}\n\n.weixinEmoji-1f3ae {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f004 {\n    background-position: 0 -7560px\n}\n\n.weixinEmoji-1f3af {\n    background-position: 0 -7580px\n}\n\n.weixinEmoji-1f3b0 {\n    background-position: 0 -7600px\n}\n\n.weixinEmoji-1f3b1 {\n    background-position: 0 -7620px\n}\n\n.weixinEmoji-1f3b2 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3b3 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3b4 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f0cf {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3b5 {\n    background-position: 0 -7640px\n}\n\n.weixinEmoji-1f3b6 {\n    background-position: 0 -7740px\n}\n\n.weixinEmoji-1f3b7 {\n    background-position: 0 -7680px\n}\n\n.weixinEmoji-1f3b8 {\n    background-position: 0 -7700px\n}\n\n.weixinEmoji-1f3b9 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3ba {\n    background-position: 0 -7720px\n}\n\n.weixinEmoji-1f3bb {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f3bc {\n    background-position: 0 -7740px\n}\n\n.weixinEmoji-303d {\n    background-position: 0 -7760px\n}\n\n.weixinEmoji-1f4f7 {\n    background-position: 0 -4940px\n}\n\n.weixinEmoji-1f4f9 {\n    background-position: 0 -7400px\n}\n\n.weixinEmoji-1f4fa {\n    background-position: 0 -7780px\n}\n\n.weixinEmoji-1f4fb {\n    background-position: 0 -7840px\n}\n\n.weixinEmoji-1f4fc {\n    background-position: 0 -7860px\n}\n\n.weixinEmoji-1f48b {\n    background-position: 0 -7900px\n}\n\n.weixinEmoji-1f48c {\n    background-position: 0 -11200px\n}\n\n.weixinEmoji-1f48d {\n    background-position: 0 -7940px\n}\n\n.weixinEmoji-1f48e {\n    background-position: 0 -7960px\n}\n\n.weixinEmoji-1f48f {\n    background-position: 0 -7980px\n}\n\n.weixinEmoji-1f490 {\n    background-position: 0 -8000px\n}\n\n.weixinEmoji-1f491 {\n    background-position: 0 -8020px\n}\n\n.weixinEmoji-1f492 {\n    background-position: 0 -8040px\n}\n\n.weixinEmoji-1f51e {\n    background-position: 0 -9860px\n}\n\n.weixinEmoji-a9 {\n    background-position: 0 -9900px\n}\n\n.weixinEmoji-ae {\n    background-position: 0 -9920px\n}\n\n.weixinEmoji-2122 {\n    background-position: 0 -9940px\n}\n\n.weixinEmoji-2139 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2320e3 {\n    background-position: 0 -8060px\n}\n\n.weixinEmoji-3120e3 {\n    background-position: 0 -8080px\n}\n\n.weixinEmoji-3220e3 {\n    background-position: 0 -8100px\n}\n\n.weixinEmoji-3320e3 {\n    background-position: 0 -8120px\n}\n\n.weixinEmoji-3420e3 {\n    background-position: 0 -8140px\n}\n\n.weixinEmoji-3520e3 {\n    background-position: 0 -8160px\n}\n\n.weixinEmoji-3620e3 {\n    background-position: 0 -8180px\n}\n\n.weixinEmoji-3720e3 {\n    background-position: 0 -8200px\n}\n\n.weixinEmoji-3820e3 {\n    background-position: 0 -8220px\n}\n\n.weixinEmoji-3920e3 {\n    background-position: 0 -8240px\n}\n\n.weixinEmoji-3020e3 {\n    background-position: 0 -8260px\n}\n\n.weixinEmoji-1f51f {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4f6 {\n    background-position: 0 -8280px\n}\n\n.weixinEmoji-1f4f3 {\n    background-position: 0 -8300px\n}\n\n.weixinEmoji-1f4f4 {\n    background-position: 0 -8320px\n}\n\n.weixinEmoji-1f354 {\n    background-position: 0 -8340px\n}\n\n.weixinEmoji-1f359 {\n    background-position: 0 -8360px\n}\n\n.weixinEmoji-1f370 {\n    background-position: 0 -8380px\n}\n\n.weixinEmoji-1f35c {\n    background-position: 0 -8400px\n}\n\n.weixinEmoji-1f35e {\n    background-position: 0 -8420px\n}\n\n.weixinEmoji-1f373 {\n    background-position: 0 -8440px\n}\n\n.weixinEmoji-1f366 {\n    background-position: 0 -8460px\n}\n\n.weixinEmoji-1f35f {\n    background-position: 0 -8480px\n}\n\n.weixinEmoji-1f361 {\n    background-position: 0 -8500px\n}\n\n.weixinEmoji-1f358 {\n    background-position: 0 -8520px\n}\n\n.weixinEmoji-1f35a {\n    background-position: 0 -8540px\n}\n\n.weixinEmoji-1f35d {\n    background-position: 0 -8560px\n}\n\n.weixinEmoji-1f35b {\n    background-position: 0 -8580px\n}\n\n.weixinEmoji-1f362 {\n    background-position: 0 -8600px\n}\n\n.weixinEmoji-1f363 {\n    background-position: 0 -8620px\n}\n\n.weixinEmoji-1f371 {\n    background-position: 0 -8640px\n}\n\n.weixinEmoji-1f372 {\n    background-position: 0 -8660px\n}\n\n.weixinEmoji-1f367 {\n    background-position: 0 -8680px\n}\n\n.weixinEmoji-1f356 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f365 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f360 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f355 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f357 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f368 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f369 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36e {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f36f {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f364 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f374 {\n    background-position: 0 -8700px\n}\n\n.weixinEmoji-2615 {\n    background-position: 0 -8720px\n}\n\n.weixinEmoji-1f378 {\n    background-position: 0 -8860px\n}\n\n.weixinEmoji-1f37a {\n    background-position: 0 -8760px\n}\n\n.weixinEmoji-1f375 {\n    background-position: 0 -8780px\n}\n\n.weixinEmoji-1f376 {\n    background-position: 0 -8800px\n}\n\n.weixinEmoji-1f377 {\n    background-position: 0 -8860px\n}\n\n.weixinEmoji-1f37b {\n    background-position: 0 -8840px\n}\n\n.weixinEmoji-1f379 {\n    background-position: 0 -8860px\n}\n\n.weixinEmoji-2197 {\n    background-position: 0 -8960px\n}\n\n.weixinEmoji-2198 {\n    background-position: 0 -8980px\n}\n\n.weixinEmoji-2196 {\n    background-position: 0 -8920px\n}\n\n.weixinEmoji-2199 {\n    background-position: 0 -8940px\n}\n\n.weixinEmoji-2934 {\n    background-position: 0 -8960px\n}\n\n.weixinEmoji-2935 {\n    background-position: 0 -8980px\n}\n\n.weixinEmoji-2194 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2195 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2b06 {\n    background-position: 0 -9000px\n}\n\n.weixinEmoji-2b07 {\n    background-position: 0 -9020px\n}\n\n.weixinEmoji-27a1 {\n    background-position: 0 -9040px\n}\n\n.weixinEmoji-2b05 {\n    background-position: 0 -11180px\n}\n\n.weixinEmoji-25b6 {\n    background-position: 0 -9080px\n}\n\n.weixinEmoji-25c0 {\n    background-position: 0 -9100px\n}\n\n.weixinEmoji-23e9 {\n    background-position: 0 -9120px\n}\n\n.weixinEmoji-23ea {\n    background-position: 0 -9140px\n}\n\n.weixinEmoji-23eb {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-23ec {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f53a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f53b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f53c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f53d {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2b55 {\n    background-position: 0 -9800px\n}\n\n.weixinEmoji-274c {\n    background-position: 0 -10340px\n}\n\n.weixinEmoji-274e {\n    background-position: 0 -10340px\n}\n\n.weixinEmoji-2757 {\n    background-position: 0 -9160px\n}\n\n.weixinEmoji-2049 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-203c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2753 {\n    background-position: 0 -9180px\n}\n\n.weixinEmoji-2754 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2755 {\n    background-position: 0 -9220px\n}\n\n.weixinEmoji-3030 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-27b0 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-27bf {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2764 {\n    background-position: 0 -9240px\n}\n\n.weixinEmoji-1f493 {\n    background-position: 0 -9480px\n}\n\n.weixinEmoji-1f494 {\n    background-position: 0 -9280px\n}\n\n.weixinEmoji-1f495 {\n    background-position: 0 -9480px\n}\n\n.weixinEmoji-1f496 {\n    background-position: 0 -9480px\n}\n\n.weixinEmoji-1f497 {\n    background-position: 0 -9340px\n}\n\n.weixinEmoji-1f498 {\n    background-position: 0 -9360px\n}\n\n.weixinEmoji-1f499 {\n    background-position: 0 -9380px\n}\n\n.weixinEmoji-1f49a {\n    background-position: 0 -9400px\n}\n\n.weixinEmoji-1f49b {\n    background-position: 0 -9420px\n}\n\n.weixinEmoji-1f49c {\n    background-position: 0 -9440px\n}\n\n.weixinEmoji-1f49d {\n    background-position: 0 -9460px\n}\n\n.weixinEmoji-1f49e {\n    background-position: 0 -9480px\n}\n\n.weixinEmoji-1f49f {\n    background-position: 0 -9500px\n}\n\n.weixinEmoji-2665 {\n    background-position: 0 -9520px\n}\n\n.weixinEmoji-2660 {\n    background-position: 0 -9540px\n}\n\n.weixinEmoji-2666 {\n    background-position: 0 -9560px\n}\n\n.weixinEmoji-2663 {\n    background-position: 0 -9580px\n}\n\n.weixinEmoji-1f6ac {\n    background-position: 0 -9600px\n}\n\n.weixinEmoji-1f6ad {\n    background-position: 0 -9620px\n}\n\n.weixinEmoji-267f {\n    background-position: 0 -9640px\n}\n\n.weixinEmoji-1f6a9 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-26a0 {\n    background-position: 0 -9700px\n}\n\n.weixinEmoji-26d4 {\n    background-position: 0 -9720px\n}\n\n.weixinEmoji-267b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f6b2 {\n    background-position: 0 -6980px\n}\n\n.weixinEmoji-1f6b6 {\n    background-position: 0 -7080px\n}\n\n.weixinEmoji-1f6b9 {\n    background-position: 0 -9740px\n}\n\n.weixinEmoji-1f6ba {\n    background-position: 0 -9760px\n}\n\n.weixinEmoji-1f6c0 {\n    background-position: 0 -5220px\n}\n\n.weixinEmoji-1f6bb {\n    background-position: 0 -5240px\n}\n\n.weixinEmoji-1f6bd {\n    background-position: 0 -5260px\n}\n\n.weixinEmoji-1f6be {\n    background-position: 0 -5280px\n}\n\n.weixinEmoji-1f6bc {\n    background-position: 0 -9780px\n}\n\n.weixinEmoji-1f6aa {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f6ab {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2714 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f191 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f192 {\n    background-position: 0 -10020px\n}\n\n.weixinEmoji-1f193 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f194 {\n    background-position: 0 -11020px\n}\n\n.weixinEmoji-1f195 {\n    background-position: 0 -9980px\n}\n\n.weixinEmoji-1f196 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f197 {\n    background-position: 0 -9880px\n}\n\n.weixinEmoji-1f198 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f199 {\n    background-position: 0 -10000px\n}\n\n.weixinEmoji-1f19a {\n    background-position: 0 -9960px\n}\n\n.weixinEmoji-1f201 {\n    background-position: 0 -10060px\n}\n\n.weixinEmoji-1f202 {\n    background-position: 0 -10080px\n}\n\n.weixinEmoji-1f232 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f233 {\n    background-position: 0 -10100px\n}\n\n.weixinEmoji-1f234 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f235 {\n    background-position: 0 -10120px\n}\n\n.weixinEmoji-1f236 {\n    background-position: 0 -10140px\n}\n\n.weixinEmoji-1f21a {\n    background-position: 0 -10160px\n}\n\n.weixinEmoji-1f237 {\n    background-position: 0 -10180px\n}\n\n.weixinEmoji-1f238 {\n    background-position: 0 -10200px\n}\n\n.weixinEmoji-1f239 {\n    background-position: 0 -10220px\n}\n\n.weixinEmoji-1f22f {\n    background-position: 0 -10240px\n}\n\n.weixinEmoji-1f23a {\n    background-position: 0 -10260px\n}\n\n.weixinEmoji-3299 {\n    background-position: 0 -10280px\n}\n\n.weixinEmoji-3297 {\n    background-position: 0 -10300px\n}\n\n.weixinEmoji-1f250 {\n    background-position: 0 -10320px\n}\n\n.weixinEmoji-1f251 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2795 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2796 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2716 {\n    background-position: 0 -10340px\n}\n\n.weixinEmoji-2797 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4a0 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4a1 {\n    background-position: 0 -10360px\n}\n\n.weixinEmoji-1f4a2 {\n    background-position: 0 -10380px\n}\n\n.weixinEmoji-1f4a3 {\n    background-position: 0 -10400px\n}\n\n.weixinEmoji-1f4a4 {\n    background-position: 0 -10420px\n}\n\n.weixinEmoji-1f4a5 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4a6 {\n    background-position: 0 -10460px\n}\n\n.weixinEmoji-1f4a7 {\n    background-position: 0 -10460px\n}\n\n.weixinEmoji-1f4a8 {\n    background-position: 0 -10480px\n}\n\n.weixinEmoji-1f4a9 {\n    background-position: 0 -5000px\n}\n\n.weixinEmoji-1f4aa {\n    background-position: 0 -10500px\n}\n\n.weixinEmoji-1f4ab {\n    background-position: 0 -10520px\n}\n\n.weixinEmoji-1f4ac {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2728 {\n    background-position: 0 -11000px\n}\n\n.weixinEmoji-2734 {\n    background-position: 0 -10560px\n}\n\n.weixinEmoji-2733 {\n    background-position: 0 -10580px\n}\n\n.weixinEmoji-26aa {\n    background-position: 0 -10640px\n}\n\n.weixinEmoji-26ab {\n    background-position: 0 -10640px\n}\n\n.weixinEmoji-1f534 {\n    background-position: 0 -10640px\n}\n\n.weixinEmoji-1f535 {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-1f532 {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-1f533 {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-2b50 {\n    background-position: 0 -10720px\n}\n\n.weixinEmoji-2b1c {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-2b1b {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-25ab {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-25aa {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-25fd {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-25fe {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-25fb {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-25fc {\n    background-position: 0 -10900px\n}\n\n.weixinEmoji-1f536 {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-1f537 {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-1f538 {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-1f539 {\n    background-position: 0 -10980px\n}\n\n.weixinEmoji-2747 {\n    background-position: 0 -11000px\n}\n\n.weixinEmoji-1f4ae {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f4af {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-21a9 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-21aa {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f503 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f50a {\n    background-position: 0 -7880px\n}\n\n.weixinEmoji-1f50b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f50c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f50d {\n    background-position: 0 -11060px\n}\n\n.weixinEmoji-1f50e {\n    background-position: 0 -11060px\n}\n\n.weixinEmoji-1f512 {\n    background-position: 0 -11140px\n}\n\n.weixinEmoji-1f513 {\n    background-position: 0 -11100px\n}\n\n.weixinEmoji-1f50f {\n    background-position: 0 -11140px\n}\n\n.weixinEmoji-1f510 {\n    background-position: 0 -11140px\n}\n\n.weixinEmoji-1f511 {\n    background-position: 0 -11160px\n}\n\n.weixinEmoji-1f514 {\n    background-position: 0 -4980px\n}\n\n.weixinEmoji-2611 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f518 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f516 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f517 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f519 {\n    background-position: 0 -11180px\n}\n\n.weixinEmoji-1f51a {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f51b {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f51c {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-1f51d {\n    background-position: 0 -10040px\n}\n\n.weixinEmoji-2003 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2002 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2005 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-2705 {\n    background-position: 0 -9200px\n}\n\n.weixinEmoji-270a {\n    background-position: 0 -11220px\n}\n\n.weixinEmoji-270b {\n    background-position: 0 -11240px\n}\n\n.weixinEmoji-270c {\n    background-position: 0 -11260px\n}\n\n.weixinEmoji-1f44a {\n    background-position: 0 -11280px\n}\n\n.weixinEmoji-1f44d {\n    background-position: 0 -11300px\n}\n\n.weixinEmoji-261d {\n    background-position: 0 -11320px\n}\n\n.weixinEmoji-1f446 {\n    background-position: 0 -11340px\n}\n\n.weixinEmoji-1f447 {\n    background-position: 0 -11360px\n}\n\n.weixinEmoji-1f448 {\n    background-position: 0 -11380px\n}\n\n.weixinEmoji-1f449 {\n    background-position: 0 -11400px\n}\n\n.weixinEmoji-1f44b {\n    background-position: 0 -11420px\n}\n\n.weixinEmoji-1f44f {\n    background-position: 0 -11440px\n}\n\n.weixinEmoji-1f44c {\n    background-position: 0 -11460px\n}\n\n.weixinEmoji-1f44e {\n    background-position: 0 -11480px\n}\n\n.weixinEmoji-1f450 {\n    background-position: 0 -11500px\n}\n@CHARSET "UTF-8";\n.modal-background{\n\twidth: 700px;\n\theight: 580px;\n\tposition: absolute;\n\tmargin: 0 auto;\n\tmargin-top: 70px;\n\tbackground: #2c2c2c;\n\topacity: 0.8;\n\tz-index: 0;\n}\n\n.preview-container {\n\tdisplay: inline-block;\n\tposition: relative;\n\tmargin: 0px auto;\n\tmargin-top: 70px;\n}\n\n.preview-close {\n\tposition: absolute;\n\ttop: 2px;\n\tright: 2px;\n\twidth: 30px;\n\theight: 30px;\n\t/*background: url(\'images/zoomImg/close1.png\');*/\n\tbackground: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAAeCAYAAABwmH1PAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAklSURBVHja5Jl9bFVnHcc/z3POuYd7by9t6RujFKit4qBsnaVsBJPF9yxZ1GyJxqnJFsqGiyHqNuMsRtQsIRkmmiVAl+AyNcRE6nSs8s8mQ1YJtLTYMZiO9Y4OFLbSst7b3nvueXn8Y8/Vs8u5ban4l7+k6b33nPN8n+/v/fkdoZTi/0nM67y/EWgFVgJV+rcMcAE4B7wFzKlB5bpcPXAAVSiAEPPBrQRWAE36swzhjgHjN5KwBdwOfBK4GViiAaW+Hui/DPB34M/AK0D2BhhkHfAJ/X8pEAPCGnI12bPAy8AA4M+2oJjDpduA+4FbAQNw9IKlDwmtgOKG3gB+rYkvxMIrgK8DG4GkJuZqXBXCLBotpq//FfglcPp6CQvgi8ADQAUwMx9XDUlcK+Z3wC/0ZuZL+FPAg0CDxvXniSmABDCtlf1b7XlzurQANgP3AQXtmuI6XXFGr/0VoAb4qfaOueRLQFcoN1yPKL1XC9gK1AO7SxUmIx68B/gqkNOWEQuIPaGBssDntMXmWufTwBb9nLPAmBeApxV+D/C10htKCa/VMZuPcocFSFHrXwA+M8t9rcDDGtO9AbiBNth9wMfLEY7pmE1qLZVu3C+TsIri6+dUBHigk1BtmUpxP1CtQ+jfniCEULZp+otM05dCROLGDMNfZJqeIURpNvI1vwdCJfQDhG/X2XimlKzneezbt2/tzp07O7LZrFkSFwpw+/r6mp944onOiYmJRRHe4QDLgc9G7Hk90KmTDSGyGEIEz50507pvaGidGwTCkjIIKyNhmu4rY2PLnh4cvHXadc3wdS15oFmHyweSltTZ0YiwkL9///6b9+/f3wqQy+Wsxx57bLCiosLTz3kHDx5s7enpactms2Jqasrevn37QCqV8iJq5p3A70NKFRrX0tb9j+Wk9J87e/bDvzp1ao2vFBnHsbZ2dp6ypAy8IJBxy/IOj46ueHpwsP29fN6YmJmJf/OOO4Zsw/B9pcK4nq7lfUCuaOEmHb/5KLeRUmIYBqlUimPHjjU8+eSTHZlMxgSc559/vmXv3r1thmEI27bJZrMx3/dFhOIKur62hH6r0bX+miQlhFBXcznbV4pULMaRdLpp7+BguxcEImXbzuHR0aaegYF2PwgM2zB4e2oqlXNdQ1zr+gVt5VUAxo4dOwDu0FqIShiira1t3HEcc2RkZEkikSCdTleMj49XXL58Ofnss8+2CSFEoVCgubk5093dPVhfXz+jvaVUFgFvEwSn82fOgO+vQYi7o3ADpcTa+vrxq/l8/I0rVyoTlsWbExOV2ULBfs9xYvtOnmz3gsD0g4DaZDK3bePGwabKymk3CGQZ3AvAWNGlV5UpUQBCSsnmzZtPA/T29rYkk0n6+/uXHT16dJllWbiuy8qVKzPbt28/sXz58intolEZW+pYLsrKcriBUiJmGMFD69efUkrx8ltvNSVMk8Ojo6sOp9OrpBAEQUBNIpH79qZNJ9bW1k5Mu+5suC3A0iLh6lkIF0nLrq6u07Zt+wcOHPiIYRiYponneaxevXry8ccfP9nQ0JAtQzYMboe+LynjCe8HfRBIS8pga2fnqUWm6R9Op1dJwwClCJSicfHizMMbNgx/tDzZcKWoBJbIkmw9a/sohPC1uyohBEIIlFJUVla6VVVVuXk2KUZEp6dmI73Ytgura2vHgUAohRQCPwhYlkplW2pqJgq+b8wDVwKySDSrQcUslvFeeOGFlt27d98ipRSe55HP57EsixMnTtTv3Lmzc3p62pyj9xUl2Xh6NlwBJGIx98U331z5zPBwuxRCBkqR9zxs02Tg4sWbdh8/3uGXlKwySznAdJHwP+borPy+vr6WPXv23AJIx3FobW29etddd50vFArYtk1/f//SXbt2dWQyGavMWsXMHT67Xp4NN2FZ7pF0umnPwEB73vNM1/dpqKjIdjY2XnI8D8sweGl0tOnpgYF2LwiEIaUqg1vEGi+61Ou6JMmIDfiHDh1a1dPT02aapnAchxUrVmQfffTRwcbGxinbtoPe3t7mRCJBf3//Uinlxx555JGhRCLhR1jO02fXooxqi1+DGzMM/+V0ennP4OBtgVJGEARUx+P5b2zYMNS6ZMnkU8ePdxxJp5cnLYs/pdNNQspgc0fHq4YQKvhgHS7G8Gng3aKFz2nwWJSmT5482TA1NSUdxylm4+ONjY0ZwOrq6hq59957R/P5PL7vMzY2lnIcJ6qBMYEJ4G+h3y7oKYl1zeFaCHX0/PkVV/N5w1eK6ng8951Nm07cXFd3BSHE1s7O4Tubmy/kXBeEYOTSpfqM48QiWlATmNSKds1QC9avJwvXuMSWLVtem5yctGdmZozu7u6hcOmRUoqurq7TQgg1NDRUs23btlerq6vzEdnXBgZLXDoHHAPWhJsPBfhBIL+8bt3Zf2azybznyW9t3Di4pq7uyozOxpaUwUOdncMC1KvvvFPz4Pr1I7WJRC4igdnAUeCd0gFALfAzoK60zQP8TCYT831fVlVVRZFRuu004vG4F1HiDJ3MvgucLRkALAV+rsuGW+rWl7PZhK+UWJZKTZeSMaUMHM+TmULBrk8mZyLIGtphvg8Mlx4exoHfaBcojQEjlUq5VVVVTpm6KQARj8f9MvU8AfyxJH6LcgnoLanP7584fN+or6jILUulosjgBYG0DEPVJZO5MqUpAbwEnCp3Hj4EvKjHOpF1bB4H8FJJAiN61lRO/gD8BUiFY18Aru/Lgu+XxQ2UEu6115Umew7YF15TRpxpd2vzL17gtKOU7AVgV+nxL+L4+JQe/qVuwAAgAVzRo6XJuUY87wE/Bo7oDVsLADT0xs8AP9Sz47nkErBDu19qtpZzjm6qQiv5R1EhVM5VJoGfAM/oTBomrkpKTvi7oe8FeA7oBtLXseGLwA/0tFPotYxZ2s/wyDauT0VHgO8Bry1kLl2cN92tj5C1oY4pCIEZ+vsUMKQP28P/5ZuHDuDzwG0hJXohBctQL+5oax7UhNVCB/FhqdN1ul2/cqnQRKd1a/qaJnnxBr9q+RCwQQ8obtK5pTgKvqy7xOM6/uccAF7Pu6V39euMUT0hqdJufhU4r4nm/wfvv0Y19uv6TFutvWpKd2nndIKal/xrAL3Sz3TZH9G9AAAAAElFTkSuQmCC\');\n\tbackground-position: 0 0;\n}\n\n.preview-close:hover {\n\tbackground-position: 30px 0;\n\tcursor: pointer;\n}\n\n.preview-img-container {\n    margin: 0 auto;\n\twidth: 700px;\n\theight: 580px;\n    border: 0px;\n\tborder-style: ridge;\n    overflow: hidden;\n    position: relative;\n\tcursor: pointer;\n\tbackground-color: rgba(0,0,0,0.5);\n}\n\n.preview-img-container::selection {\n\toutline: none;\n}\n\n.preview-image {\n    position: absolute;\n    cursor: pointer;\n}\n\n.preview-buttons {\n\tposition: absolute;\n\tbottom: 0px;\n\twidth: 100%;\n\tz-index: 1060;\n}\n\n.preview-btn-group {\n\twidth: 180px;\n\tmargin: 0 auto;\n\tpadding: 8px 6px 2px 6px;\n\tbackground-color: #090909;\n\tborder: 0px;\n\tborder-style: ridge;\n\tborder-bottom: none;\n\tborder-radius: 10px 10px 0px 0px;\n\topacity: 0.6;\n\tdisplay: none;\n}\n\n.preview-buttons::selection, .preview-btn-group::selection {\n\toutline: none;\n}\n\n.preview-btn {\n\tmargin-left: 15px;\n\tfont-size: 22px;\n\tcolor: #ffffff;\n}\n\n/*.preview-btn:hover {*/\n\t/*color: darkorange;*/\n/*}*/\n\n\n.preview-percent {\n\twidth: 80px;\n\theight: 35px;\n\ttext-align: center;\n\tline-height: 35px;\n\tfont-size: 16px;\n\tcolor: #ffffff;\n\tborder-radius: 5px;\n\tposition: relative;\n\tmargin: 0 auto;\n\tmargin-top: 272px;\n\tbackground: #2c2c2c;\n\topacity: 0.6;\n\tfilter: alpha(opacity=60);\n\tdisplay: none;\n\tbox-shadow: 0px 0px 5px;\n\tz-index: 1050;\n}\n\n#zoomIn, #zoomOut, #rotate-btn {\n    display: inline-block;\n    height:22px;\n    margin-right:15px;\n}\n        \n#zoomIn {\n    width: 23px;\n    /*background:url("images/zoomImg/zoomIn.png");*/\n\tbackground:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABcAAAAWCAYAAAArdgcFAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0OUY2QkZBODY5QUMxMUU1QjVCQThDMDc2RkQzMDQwOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0OUY3ODhENDY5QUMxMUU1QjVCQThDMDc2RkQzMDQwOSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQ5RjZCRkE2NjlBQzExRTVCNUJBOEMwNzZGRDMwNDA5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ5RjZCRkE3NjlBQzExRTVCNUJBOEMwNzZGRDMwNDA5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+JpiXLgAAAdNJREFUeNqs1E8oBFEcB/DBJiRLwkp2lZuNnJSUA4sTdzfZ2hw2pSQXJRftkbI3Llrk5urgT1uUP4WLHLAbLQ6iaLXYHd/HV73Gm90d7a8+zcz783tv3rw3mq7rmoIbAnAKb/ABEVgEj0mfP4wFRbAAST19bEGdleQlEGbnFKzDALigFtr5Ni9sE4PmbJOH2OkRuqVyO9RLz+L+kG2voCxT8i42fucM5UYHkACHVFYJl+wTyJR8gw3nFY2irDMuQT/Ln/mtlMltEGfDFgvJ87nuIjpVyfM1TauBYkjAGdTBJhyRQ/uJNT7vQy+k4Jh1jZoibFDB+1de3dCjaNsk3fdyAnE+l5olj/G+ko1EpzawszwE1eCDa0jCHuucvD6okv+uzwXXbtDCmovd88kz4TJbcxGrvE5BoXF8XpOG8hkogDBE0828HO44wxXuoN86H8wZyoY5YxHT2ZxQDw+LiB1oVXSogqCUWOd/yJvNj6sPnqSOJ7AMS7DNE6yKFN8wbXLByWRmiXa5TKoBRuRced8jqEPs/w5o4CG75QGKsH4SZhUf3w9B+YP+14TJG/jNlsWqcZMBvLlILowZdpCI+1wlF0YNA0RymVwYghs4F7/hLwEGAJTkKcoXsEO9AAAAAElFTkSuQmCC");\n}\n        \n#zoomOut {\n    width:22px;\n    /*background:url("images/zoomImg/zoomOut.png");*/\n\tbackground:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2hpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo4NUFENkE3MkNGMjQ2ODExODIyQUYyRUU3MDBGMTA5QiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4NzFCNDZFNTc5NDAxMUU1QTc4MkFGQzlFMDIxREI0QiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4NzFCNDZFNDc5NDAxMUU1QTc4MkFGQzlFMDIxREI0QiIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M2IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDQ4MDExNzQwNzIwNjgxMTgyMkFGNzE2NkRGNDMxQjQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6ODVBRDZBNzJDRjI0NjgxMTgyMkFGMkVFNzAwRjEwOUIiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7ACFUPAAABnElEQVR42qzUPywDURwH8NfGotRCqMTgX0JiIBYLg8XUQRoJkxhsahcDkSYmIZGIVTqYOpsaiYk2BAlhsoiIVBgUkVTP98e3yeX63t1V+0s+6V3u9769e/feKcuylEM7rEIW3uAb7mEfJiGoGVPGfhKAZchb7nUK/X6DJXTPNvgQpqAXIjACCXjldfkd8hO8xAFfMOsyoBWO2CvT0+IWLHP6zuZpH/MXgiv2b7kFr7Ap7eel0BjHfECTKTjDppkKgsUtx0V11+uUUt3qr44hBEnoVPoqwAakIAt90KVrlOAwj/MQgRgElLmiDP7keYMp+JF3KM5gENoMoZg8leFxB39z+k7LSnGu1iqY3zBfnNSA6eXF2PDCdeonOMExF27LLchtWtpxjR6h8r0osH/Ta+fJ1n1m8yWMGh5/3RYqVYQFr4/QMLdpqW4gCbtwYNudztKGO/+pmdvUFHLOxy96hQd+08urHsahh+tUltQJXPN6HLYd612CFmGntNz+K+5259UEu4XPVRtsCs/VIlgXflerYDEPT/AAEz8CDAC5mCgsfjPeiQAAAABJRU5ErkJggg==");\n}\n        \n#rotate-btn {\n    width: 20px;\n    /*background:url("images/zoomImg/rotate.png");*/\n\tbackground:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0OUY1NjhDRjY5QUMxMUU1QjVCQThDMDc2RkQzMDQwOSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0OUY1NjhEMDY5QUMxMUU1QjVCQThDMDc2RkQzMDQwOSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjA0MTRBNEJBNjkwMTExRTVCNUJBOEMwNzZGRDMwNDA5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQ5RjU2OENFNjlBQzExRTVCNUJBOEMwNzZGRDMwNDA5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Fi2Q/wAAAa5JREFUeNqs1c0rRFEYx/FrRmRChigkb2ElK2VBFMlCGWRhFpSNlPwHlNWsrYmFFVEWssQOC2woC42F15K3puR1ru9Tz+S67jDuOPXpzpw59zfn3DnnGcM0TcOFetyh3/6Zx/i9ZaAClcjSvihyEEL6l9FxZlCAcezjzfxsURwhhD3tG7Xeaw9KwRgilpBTbGIDYfN7u0CGU2AaFnTQM6ZQ4zD7cv0C66xrnALndcAxauM8imysW8K20Oy05AFLWPEPv241XnGIbn1E0l+GqligrP8c72hIYMvkw2vrO8AtMmXb9KAIS9hOYBtd493Wtws/ghIY0M4Zw32b1WunPIMwL0p00z65DMxEBGcS+MiLBxQaybUb+GTJKXJgjP9pLxJ4iQI9s25bHnJxKoF78KIpicBWve5I4Iq+GU4icESvy7EzfK5nssVFbezVUyab2xPrDGqnBJf+IawO9zqZdntxmNbQMzQmEBbQMGkTTtVGzuecDpBzvYg2a62DH11Ys5SuyZ8KrBjElaVEvWoRvbcVVqlMHfb74y3HhyGs4lJnLH8FJ1qE+5DqdO+HAAMAJ+95rTZroJgAAAAASUVORK5CYII=");\n    margin-right: 0px;\n}');